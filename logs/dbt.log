[0m17:13:58.242518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2d9058e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ea002ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ea047610>]}


============================== 17:13:58.248656 | 88ab6c89-8f29-40ea-a663-732f0cbb654f ==============================
[0m17:13:58.248656 [info ] [MainThread]: Running with dbt=1.7.0
[0m17:13:58.249443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tim/tipico/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m17:13:58.250292 [info ] [MainThread]: dbt version: 1.7.0
[0m17:13:58.250717 [info ] [MainThread]: python version: 3.9.1
[0m17:13:58.251099 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.9/bin/python3.9
[0m17:13:58.251647 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m17:13:58.484355 [info ] [MainThread]: Using profiles dir at /Users/tim/.dbt
[0m17:13:58.485240 [info ] [MainThread]: Using profiles.yml file at /Users/tim/.dbt/profiles.yml
[0m17:13:58.485667 [info ] [MainThread]: Using dbt_project.yml file at /Users/tim/tipico/dbt_project.yml
[0m17:13:58.486720 [info ] [MainThread]: adapter type: redshift
[0m17:13:58.487217 [info ] [MainThread]: adapter version: 1.7.7
[0m17:13:58.587131 [info ] [MainThread]: Configuration:
[0m17:13:58.587713 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:13:58.588127 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:13:58.588518 [info ] [MainThread]: Required dependencies:
[0m17:13:58.589019 [debug] [MainThread]: Executing "git --help"
[0m17:13:58.615632 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:13:58.616795 [debug] [MainThread]: STDERR: "b''"
[0m17:13:58.617295 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:13:58.617741 [info ] [MainThread]: Connection:
[0m17:13:58.618250 [info ] [MainThread]:   host: manual-dwh-candidatetests.258845600139.us-east-1.redshift-serverless.amazonaws.com
[0m17:13:58.618642 [info ] [MainThread]:   user: timothy_chan
[0m17:13:58.619009 [info ] [MainThread]:   port: 5439
[0m17:13:58.619370 [info ] [MainThread]:   database: dev
[0m17:13:58.619741 [info ] [MainThread]:   method: database
[0m17:13:58.620104 [info ] [MainThread]:   cluster_id: None
[0m17:13:58.620460 [info ] [MainThread]:   iam_profile: None
[0m17:13:58.620822 [info ] [MainThread]:   schema: timothy_chan
[0m17:13:58.621173 [info ] [MainThread]:   sslmode: prefer
[0m17:13:58.621528 [info ] [MainThread]:   region: None
[0m17:13:58.621879 [info ] [MainThread]:   sslmode: prefer
[0m17:13:58.622234 [info ] [MainThread]:   region: None
[0m17:13:58.622585 [info ] [MainThread]:   iam_profile: None
[0m17:13:58.622939 [info ] [MainThread]:   autocreate: False
[0m17:13:58.623297 [info ] [MainThread]:   db_groups: []
[0m17:13:58.623646 [info ] [MainThread]:   ra3_node: False
[0m17:13:58.624004 [info ] [MainThread]:   connect_timeout: None
[0m17:13:58.624357 [info ] [MainThread]:   role: None
[0m17:13:58.624713 [info ] [MainThread]:   retries: 1
[0m17:13:58.625066 [info ] [MainThread]:   autocommit: True
[0m17:13:58.626024 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m17:13:58.627005 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m17:13:58.635754 [debug] [MainThread]: Using redshift connection "debug"
[0m17:13:58.636206 [debug] [MainThread]: On debug: select 1 as id
[0m17:13:58.636623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:13:58.642390 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:13:58.642872 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:13:59.134126 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:13:59.139842 [debug] [MainThread]: On debug: Close
[0m17:13:59.141216 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:13:59.142049 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:13:59.150231 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0435826, "process_user_time": 3.42037, "process_kernel_time": 0.335572, "process_mem_max_rss": "114847744", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:13:59.152543 [debug] [MainThread]: Command `dbt debug` succeeded at 17:13:59.151509 after 1.05 seconds
[0m17:13:59.153374 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:13:59.154124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2d9058e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2e962ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ea291cd0>]}
[0m17:13:59.155021 [debug] [MainThread]: Flushing usage events
[0m17:14:43.198825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b8164e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b827d0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b827efdc0>]}


============================== 17:14:43.205088 | 8aab55e0-10aa-4101-89db-6df7b430d621 ==============================
[0m17:14:43.205088 [info ] [MainThread]: Running with dbt=1.7.0
[0m17:14:43.205844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tim/tipico/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:14:43.724726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8aab55e0-10aa-4101-89db-6df7b430d621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b827d0430>]}
[0m17:14:43.844866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8aab55e0-10aa-4101-89db-6df7b430d621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b8279ac40>]}
[0m17:14:43.846882 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m17:14:43.861368 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m17:14:43.928299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:14:43.928834 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:14:43.937948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8aab55e0-10aa-4101-89db-6df7b430d621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b717c40d0>]}
[0m17:14:43.955953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8aab55e0-10aa-4101-89db-6df7b430d621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b716df670>]}
[0m17:14:43.956591 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m17:14:43.957064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8aab55e0-10aa-4101-89db-6df7b430d621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b716df670>]}
[0m17:14:43.959104 [info ] [MainThread]: 
[0m17:14:43.960095 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:14:43.963387 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:14:43.987633 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:14:43.988131 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:14:43.988563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:43.992962 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:14:43.993463 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:14:44.473023 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:44.480343 [debug] [ThreadPool]: On list_dev: Close
[0m17:14:44.485643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m17:14:44.504232 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:14:44.504959 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m17:14:44.505567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:44.506412 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:14:44.506969 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:15:02.542602 [debug] [ThreadPool]: SQL status: SUCCESS in 18.0 seconds
[0m17:15:02.544028 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:15:02.544881 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m17:15:02.613190 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:02.619786 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m17:15:02.667795 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m17:15:02.694088 [debug] [MainThread]: Using redshift connection "master"
[0m17:15:02.694922 [debug] [MainThread]: On master: BEGIN
[0m17:15:02.695523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:02.696406 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:15:02.697069 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:15:03.039746 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:03.042114 [debug] [MainThread]: Using redshift connection "master"
[0m17:15:03.044076 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:15:03.149756 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:03.156563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8aab55e0-10aa-4101-89db-6df7b430d621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7144f910>]}
[0m17:15:03.158522 [debug] [MainThread]: On master: ROLLBACK
[0m17:15:03.220097 [debug] [MainThread]: Using redshift connection "master"
[0m17:15:03.222040 [debug] [MainThread]: On master: BEGIN
[0m17:15:03.243614 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:03.245345 [debug] [MainThread]: On master: COMMIT
[0m17:15:03.247179 [debug] [MainThread]: Using redshift connection "master"
[0m17:15:03.248720 [debug] [MainThread]: On master: COMMIT
[0m17:15:03.297984 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:03.299736 [debug] [MainThread]: On master: Close
[0m17:15:03.304969 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:15:03.306588 [info ] [MainThread]: 
[0m17:15:03.313700 [debug] [Thread-1  ]: Began running node model.tipico.my_first_dbt_model
[0m17:15:03.315029 [info ] [Thread-1  ]: 1 of 2 START sql table model timothy_chan.my_first_dbt_model ................... [RUN]
[0m17:15:03.321581 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.my_first_dbt_model)
[0m17:15:03.322541 [debug] [Thread-1  ]: Began compiling node model.tipico.my_first_dbt_model
[0m17:15:03.329287 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_first_dbt_model"
[0m17:15:03.331301 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (compile): 17:15:03.323114 => 17:15:03.330784
[0m17:15:03.332059 [debug] [Thread-1  ]: Began executing node model.tipico.my_first_dbt_model
[0m17:15:03.404882 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_first_dbt_model"
[0m17:15:03.407523 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:15:03.408032 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m17:15:03.408495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:15:03.409147 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:15:03.409642 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:15:03.707979 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:03.709577 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:15:03.710809 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */

  
    

  create  table
    "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:15:04.378118 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m17:15:04.403393 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:15:04.404210 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
alter table "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:15:04.520187 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:04.563892 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:15:04.564676 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:15:04.565225 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:15:05.609685 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m17:15:05.613439 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:15:05.615351 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m17:15:05.659484 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:05.684786 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_first_dbt_model__dbt_backup"
[0m17:15:05.695258 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:15:05.696052 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
drop table if exists "dev"."timothy_chan"."my_first_dbt_model__dbt_backup" cascade
[0m17:15:05.735858 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:05.738160 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:15:05.739188 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:15:05.740037 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:15:05.770558 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:05.772301 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:15:05.773421 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m17:15:05.794131 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:05.798506 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (execute): 17:15:03.332515 => 17:15:05.797713
[0m17:15:05.799670 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: ROLLBACK
[0m17:15:05.840338 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: Close
[0m17:15:05.844930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8aab55e0-10aa-4101-89db-6df7b430d621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b715c8790>]}
[0m17:15:05.848203 [info ] [Thread-1  ]: 1 of 2 OK created sql table model timothy_chan.my_first_dbt_model .............. [[32mSUCCESS[0m in 2.52s]
[0m17:15:05.850098 [debug] [Thread-1  ]: Finished running node model.tipico.my_first_dbt_model
[0m17:15:05.852013 [debug] [Thread-1  ]: Began running node model.tipico.my_second_dbt_model
[0m17:15:05.853286 [info ] [Thread-1  ]: 2 of 2 START sql view model timothy_chan.my_second_dbt_model ................... [RUN]
[0m17:15:05.854959 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.my_first_dbt_model, now model.tipico.my_second_dbt_model)
[0m17:15:05.855842 [debug] [Thread-1  ]: Began compiling node model.tipico.my_second_dbt_model
[0m17:15:05.866170 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_second_dbt_model"
[0m17:15:05.867601 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (compile): 17:15:05.856374 => 17:15:05.867138
[0m17:15:05.868325 [debug] [Thread-1  ]: Began executing node model.tipico.my_second_dbt_model
[0m17:15:05.901548 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_second_dbt_model"
[0m17:15:05.903267 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:15:05.903763 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m17:15:05.904213 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:15:05.904843 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:15:05.905326 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:15:06.222580 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:06.225109 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:15:06.227104 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */


  create view "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."timothy_chan"."my_first_dbt_model"
where id = 1
  ) ;
[0m17:15:06.325599 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:06.340715 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:15:06.341749 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
alter table "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:15:06.405805 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:06.415356 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:15:06.416555 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:15:06.417427 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:15:07.330881 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m17:15:07.334554 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:15:07.336062 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m17:15:07.375585 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:07.388330 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_second_dbt_model__dbt_backup"
[0m17:15:07.395628 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:15:07.396423 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
drop view if exists "dev"."timothy_chan"."my_second_dbt_model__dbt_backup" cascade
[0m17:15:07.434602 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:07.436845 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:15:07.437861 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:15:07.438711 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:15:07.467569 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:07.469011 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:15:07.469897 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m17:15:07.491203 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:07.496421 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (execute): 17:15:05.868760 => 17:15:07.495212
[0m17:15:07.497420 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: ROLLBACK
[0m17:15:07.535073 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: Close
[0m17:15:07.538090 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8aab55e0-10aa-4101-89db-6df7b430d621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b715c8790>]}
[0m17:15:07.539714 [info ] [Thread-1  ]: 2 of 2 OK created sql view model timothy_chan.my_second_dbt_model .............. [[32mSUCCESS[0m in 1.68s]
[0m17:15:07.541145 [debug] [Thread-1  ]: Finished running node model.tipico.my_second_dbt_model
[0m17:15:07.544264 [debug] [MainThread]: Using redshift connection "master"
[0m17:15:07.545013 [debug] [MainThread]: On master: BEGIN
[0m17:15:07.545730 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:15:07.546799 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:15:07.547591 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:15:07.842024 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:07.843982 [debug] [MainThread]: On master: COMMIT
[0m17:15:07.845378 [debug] [MainThread]: Using redshift connection "master"
[0m17:15:07.846171 [debug] [MainThread]: On master: COMMIT
[0m17:15:07.889649 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:07.891517 [debug] [MainThread]: On master: Close
[0m17:15:07.893188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:07.893732 [debug] [MainThread]: Connection 'model.tipico.my_second_dbt_model' was properly closed.
[0m17:15:07.894318 [info ] [MainThread]: 
[0m17:15:07.894884 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 23.93 seconds (23.93s).
[0m17:15:07.896091 [debug] [MainThread]: Command end result
[0m17:15:07.912016 [info ] [MainThread]: 
[0m17:15:07.912715 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:15:07.913230 [info ] [MainThread]: 
[0m17:15:07.913774 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:15:07.917868 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 24.858488, "process_user_time": 4.376534, "process_kernel_time": 0.398919, "process_mem_max_rss": "122380288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:15:07.918824 [debug] [MainThread]: Command `dbt run` succeeded at 17:15:07.918611 after 24.86 seconds
[0m17:15:07.919424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b8164e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b719ecaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b719eca90>]}
[0m17:15:07.920031 [debug] [MainThread]: Flushing usage events
[0m17:17:36.105599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8060e7e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8061dcea00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8071dd38e0>]}


============================== 17:17:36.112290 | 6a24bce6-3d3f-48e9-b338-52c63e26ccd8 ==============================
[0m17:17:36.112290 [info ] [MainThread]: Running with dbt=1.7.0
[0m17:17:36.113136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/tim/tipico/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:17:36.652634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a24bce6-3d3f-48e9-b338-52c63e26ccd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8061f34880>]}
[0m17:17:36.772695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a24bce6-3d3f-48e9-b338-52c63e26ccd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8071f8ba60>]}
[0m17:17:36.774655 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m17:17:36.789386 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m17:17:36.855409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:17:36.855968 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:17:36.865342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a24bce6-3d3f-48e9-b338-52c63e26ccd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806223c0d0>]}
[0m17:17:36.882995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a24bce6-3d3f-48e9-b338-52c63e26ccd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8062159640>]}
[0m17:17:36.883635 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m17:17:36.884111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a24bce6-3d3f-48e9-b338-52c63e26ccd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8062159640>]}
[0m17:17:36.886185 [info ] [MainThread]: 
[0m17:17:36.887220 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:17:36.888700 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:17:36.912545 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:17:36.913027 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:17:36.913444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:36.917778 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:36.918251 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:37.424602 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:17:37.432913 [debug] [ThreadPool]: On list_dev: Close
[0m17:17:37.438302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m17:17:37.457210 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:17:37.457879 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m17:17:37.458394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:37.459202 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:37.459784 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:37.769579 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:37.771888 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:17:37.773737 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m17:17:37.830844 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:37.838344 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m17:17:37.884995 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m17:17:37.911499 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:37.912303 [debug] [MainThread]: On master: BEGIN
[0m17:17:37.912907 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:37.913796 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:37.914463 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:38.211385 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:38.213788 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:38.215775 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:17:38.309120 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:38.316637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a24bce6-3d3f-48e9-b338-52c63e26ccd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80720496d0>]}
[0m17:17:38.318186 [debug] [MainThread]: On master: ROLLBACK
[0m17:17:38.377211 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:38.379717 [debug] [MainThread]: On master: BEGIN
[0m17:17:38.399083 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:38.400777 [debug] [MainThread]: On master: COMMIT
[0m17:17:38.402640 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:38.404172 [debug] [MainThread]: On master: COMMIT
[0m17:17:38.443220 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:38.445011 [debug] [MainThread]: On master: Close
[0m17:17:38.448985 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:38.450399 [info ] [MainThread]: 
[0m17:17:38.460824 [debug] [Thread-1  ]: Began running node model.tipico.my_first_dbt_model
[0m17:17:38.462256 [info ] [Thread-1  ]: 1 of 2 START sql table model timothy_chan.my_first_dbt_model ................... [RUN]
[0m17:17:38.464047 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.my_first_dbt_model)
[0m17:17:38.465021 [debug] [Thread-1  ]: Began compiling node model.tipico.my_first_dbt_model
[0m17:17:38.471581 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_first_dbt_model"
[0m17:17:38.473319 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (compile): 17:17:38.465506 => 17:17:38.472795
[0m17:17:38.474072 [debug] [Thread-1  ]: Began executing node model.tipico.my_first_dbt_model
[0m17:17:38.547003 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_first_dbt_model"
[0m17:17:38.550096 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:17:38.550598 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m17:17:38.551082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:17:38.551731 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:38.552225 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:38.833006 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:38.835623 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:17:38.837771 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */

  
    

  create  table
    "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:17:38.925179 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:38.947739 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:17:38.948603 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
alter table "dev"."timothy_chan"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:17:39.071848 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:39.086383 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:17:39.087358 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
alter table "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:17:39.144422 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:39.193338 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:17:39.194062 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:17:39.194601 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:17:39.643406 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:39.647205 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:17:39.649079 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m17:17:39.689700 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:39.713745 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_first_dbt_model__dbt_backup"
[0m17:17:39.723281 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:17:39.723987 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
drop table if exists "dev"."timothy_chan"."my_first_dbt_model__dbt_backup" cascade
[0m17:17:39.766806 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:39.769055 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:17:39.769918 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:17:39.770631 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:17:40.151439 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:40.154314 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:17:40.155981 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m17:17:40.175426 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:40.179175 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (execute): 17:17:38.474537 => 17:17:40.178395
[0m17:17:40.180410 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: ROLLBACK
[0m17:17:40.223798 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: Close
[0m17:17:40.228798 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a24bce6-3d3f-48e9-b338-52c63e26ccd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80623c2fd0>]}
[0m17:17:40.232458 [info ] [Thread-1  ]: 1 of 2 OK created sql table model timothy_chan.my_first_dbt_model .............. [[32mSUCCESS[0m in 1.76s]
[0m17:17:40.234628 [debug] [Thread-1  ]: Finished running node model.tipico.my_first_dbt_model
[0m17:17:40.236662 [debug] [Thread-1  ]: Began running node model.tipico.my_second_dbt_model
[0m17:17:40.237966 [info ] [Thread-1  ]: 2 of 2 START sql view model timothy_chan.my_second_dbt_model ................... [RUN]
[0m17:17:40.239692 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.my_first_dbt_model, now model.tipico.my_second_dbt_model)
[0m17:17:40.240593 [debug] [Thread-1  ]: Began compiling node model.tipico.my_second_dbt_model
[0m17:17:40.247836 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_second_dbt_model"
[0m17:17:40.249297 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (compile): 17:17:40.241133 => 17:17:40.248817
[0m17:17:40.250045 [debug] [Thread-1  ]: Began executing node model.tipico.my_second_dbt_model
[0m17:17:40.284471 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_second_dbt_model"
[0m17:17:40.286218 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:17:40.286725 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m17:17:40.287191 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:17:40.287842 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:40.288337 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:40.602324 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:40.604910 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:17:40.606920 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */


  create view "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."timothy_chan"."my_first_dbt_model"
where id = 1
  ) ;
[0m17:17:40.704307 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:40.720542 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:17:40.721642 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
alter table "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:17:40.782130 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:40.793215 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:17:40.795452 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:17:40.796363 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:17:41.194654 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:41.198951 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:17:41.200527 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m17:17:41.243285 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:41.259280 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_second_dbt_model__dbt_backup"
[0m17:17:41.268640 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:17:41.269633 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
drop view if exists "dev"."timothy_chan"."my_second_dbt_model__dbt_backup" cascade
[0m17:17:41.312497 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:41.316039 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:17:41.317429 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:17:41.318508 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:17:41.345180 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:41.347648 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:17:41.349576 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m17:17:41.370537 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:41.374918 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (execute): 17:17:40.250486 => 17:17:41.373951
[0m17:17:41.376324 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: ROLLBACK
[0m17:17:41.419206 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: Close
[0m17:17:41.424194 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a24bce6-3d3f-48e9-b338-52c63e26ccd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80623eaee0>]}
[0m17:17:41.427110 [info ] [Thread-1  ]: 2 of 2 OK created sql view model timothy_chan.my_second_dbt_model .............. [[32mSUCCESS[0m in 1.18s]
[0m17:17:41.428755 [debug] [Thread-1  ]: Finished running node model.tipico.my_second_dbt_model
[0m17:17:41.432186 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:41.433025 [debug] [MainThread]: On master: BEGIN
[0m17:17:41.433752 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:41.434839 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:41.435660 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:41.723447 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:41.725978 [debug] [MainThread]: On master: COMMIT
[0m17:17:41.727865 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:41.729035 [debug] [MainThread]: On master: COMMIT
[0m17:17:41.773353 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:17:41.775140 [debug] [MainThread]: On master: Close
[0m17:17:41.778692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:41.779875 [debug] [MainThread]: Connection 'model.tipico.my_second_dbt_model' was properly closed.
[0m17:17:41.780993 [info ] [MainThread]: 
[0m17:17:41.781865 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.89 seconds (4.89s).
[0m17:17:41.783817 [debug] [MainThread]: Command end result
[0m17:17:41.807433 [info ] [MainThread]: 
[0m17:17:41.808158 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:17:41.808709 [info ] [MainThread]: 
[0m17:17:41.809314 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:17:41.813938 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8429074, "process_user_time": 4.444672, "process_kernel_time": 0.685478, "process_mem_max_rss": "129101824", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:17:41.814909 [debug] [MainThread]: Command `dbt run` succeeded at 17:17:41.814701 after 5.84 seconds
[0m17:17:41.815549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8060e7e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8062264d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8062264ee0>]}
[0m17:17:41.816161 [debug] [MainThread]: Flushing usage events
[0m17:20:37.592526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa8f4f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa9bf7a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa9bea8e0>]}


============================== 17:20:37.599002 | 25dd8f04-6025-4271-95f0-30beac516d05 ==============================
[0m17:20:37.599002 [info ] [MainThread]: Running with dbt=1.7.0
[0m17:20:37.599858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tim/tipico/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:20:38.115118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25dd8f04-6025-4271-95f0-30beac516d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba99f54880>]}
[0m17:20:38.235924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25dd8f04-6025-4271-95f0-30beac516d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa9d63a60>]}
[0m17:20:38.237977 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m17:20:38.252791 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m17:20:38.317257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:20:38.317792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:20:38.326957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25dd8f04-6025-4271-95f0-30beac516d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9a19c0d0>]}
[0m17:20:38.342049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25dd8f04-6025-4271-95f0-30beac516d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9a0b6640>]}
[0m17:20:38.342712 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m17:20:38.343189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25dd8f04-6025-4271-95f0-30beac516d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9a0b6640>]}
[0m17:20:38.345242 [info ] [MainThread]: 
[0m17:20:38.346272 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:20:38.347758 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:20:38.371556 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:20:38.372057 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:20:38.372486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:38.376883 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:20:38.377359 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:20:38.836145 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:38.843894 [debug] [ThreadPool]: On list_dev: Close
[0m17:20:38.848531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m17:20:38.866667 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:20:38.867414 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m17:20:38.868024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:38.868893 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:20:38.869449 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:20:39.173718 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:39.174824 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:20:39.175679 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m17:20:39.239505 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:39.247397 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m17:20:39.294135 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m17:20:39.322830 [debug] [MainThread]: Using redshift connection "master"
[0m17:20:39.323648 [debug] [MainThread]: On master: BEGIN
[0m17:20:39.324282 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:20:39.325182 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:20:39.325822 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:20:39.613428 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:39.615890 [debug] [MainThread]: Using redshift connection "master"
[0m17:20:39.617890 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:20:39.706699 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:39.714023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25dd8f04-6025-4271-95f0-30beac516d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa9beaaf0>]}
[0m17:20:39.716371 [debug] [MainThread]: On master: ROLLBACK
[0m17:20:39.780808 [debug] [MainThread]: Using redshift connection "master"
[0m17:20:39.782840 [debug] [MainThread]: On master: BEGIN
[0m17:20:39.803769 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:39.805546 [debug] [MainThread]: On master: COMMIT
[0m17:20:39.807391 [debug] [MainThread]: Using redshift connection "master"
[0m17:20:39.808941 [debug] [MainThread]: On master: COMMIT
[0m17:20:39.855005 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:39.856889 [debug] [MainThread]: On master: Close
[0m17:20:39.861492 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:20:39.862558 [info ] [MainThread]: 
[0m17:20:39.869056 [debug] [Thread-1  ]: Began running node model.tipico.my_first_dbt_model
[0m17:20:39.870537 [info ] [Thread-1  ]: 1 of 2 START sql table model timothy_chan.my_first_dbt_model ................... [RUN]
[0m17:20:39.876501 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.my_first_dbt_model)
[0m17:20:39.877462 [debug] [Thread-1  ]: Began compiling node model.tipico.my_first_dbt_model
[0m17:20:39.884213 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_first_dbt_model"
[0m17:20:39.886086 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (compile): 17:20:39.878035 => 17:20:39.885567
[0m17:20:39.886861 [debug] [Thread-1  ]: Began executing node model.tipico.my_first_dbt_model
[0m17:20:39.958656 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_first_dbt_model"
[0m17:20:39.961171 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:20:39.961684 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m17:20:39.962148 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:20:39.962788 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:20:39.963279 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:20:40.238030 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:40.240957 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:20:40.243090 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */

  
    

  create  table
    "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:20:40.333113 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:40.352608 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:20:40.353385 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
alter table "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:20:40.465247 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:40.510245 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:20:40.510869 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:20:40.511346 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:20:41.086339 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m17:20:41.090108 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:20:41.092005 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m17:20:41.134715 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:41.150041 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_first_dbt_model__dbt_backup"
[0m17:20:41.159434 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:20:41.160112 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
drop table if exists "dev"."timothy_chan"."my_first_dbt_model__dbt_backup" cascade
[0m17:20:41.197263 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:41.199180 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:20:41.200015 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:20:41.200774 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:20:41.223765 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:41.224761 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:20:41.225594 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m17:20:41.245112 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:41.248811 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (execute): 17:20:39.887304 => 17:20:41.248015
[0m17:20:41.249989 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: ROLLBACK
[0m17:20:41.296037 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: Close
[0m17:20:41.299894 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25dd8f04-6025-4271-95f0-30beac516d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9a205250>]}
[0m17:20:41.302858 [info ] [Thread-1  ]: 1 of 2 OK created sql table model timothy_chan.my_first_dbt_model .............. [[32mSUCCESS[0m in 1.42s]
[0m17:20:41.305056 [debug] [Thread-1  ]: Finished running node model.tipico.my_first_dbt_model
[0m17:20:41.306911 [debug] [Thread-1  ]: Began running node model.tipico.my_second_dbt_model
[0m17:20:41.308243 [info ] [Thread-1  ]: 2 of 2 START sql view model timothy_chan.my_second_dbt_model ................... [RUN]
[0m17:20:41.310014 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.my_first_dbt_model, now model.tipico.my_second_dbt_model)
[0m17:20:41.311049 [debug] [Thread-1  ]: Began compiling node model.tipico.my_second_dbt_model
[0m17:20:41.321334 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_second_dbt_model"
[0m17:20:41.322811 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (compile): 17:20:41.311619 => 17:20:41.322333
[0m17:20:41.323534 [debug] [Thread-1  ]: Began executing node model.tipico.my_second_dbt_model
[0m17:20:41.356462 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_second_dbt_model"
[0m17:20:41.358142 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:20:41.358643 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m17:20:41.359097 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:20:41.359751 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:20:41.360241 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:20:41.670644 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:41.672810 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:20:41.674295 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */


  create view "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."timothy_chan"."my_first_dbt_model"
where id = 1
  ) ;
[0m17:20:41.778340 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:41.792144 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:20:41.793148 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
alter table "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:20:41.858744 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:41.868125 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:20:41.869566 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:20:41.870712 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:20:42.367754 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:42.371851 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:20:42.374058 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m17:20:42.416687 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:42.428569 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_second_dbt_model__dbt_backup"
[0m17:20:42.435769 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:20:42.436506 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
drop view if exists "dev"."timothy_chan"."my_second_dbt_model__dbt_backup" cascade
[0m17:20:42.475659 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:42.477913 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:20:42.478938 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:20:42.479782 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:20:42.504530 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:42.506187 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:20:42.507261 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m17:20:42.529609 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:42.535114 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (execute): 17:20:41.323982 => 17:20:42.533819
[0m17:20:42.536807 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: ROLLBACK
[0m17:20:42.584220 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: Close
[0m17:20:42.589090 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25dd8f04-6025-4271-95f0-30beac516d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9a1d5c40>]}
[0m17:20:42.591510 [info ] [Thread-1  ]: 2 of 2 OK created sql view model timothy_chan.my_second_dbt_model .............. [[32mSUCCESS[0m in 1.28s]
[0m17:20:42.593179 [debug] [Thread-1  ]: Finished running node model.tipico.my_second_dbt_model
[0m17:20:42.596200 [debug] [MainThread]: Using redshift connection "master"
[0m17:20:42.596969 [debug] [MainThread]: On master: BEGIN
[0m17:20:42.597659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:20:42.598650 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:20:42.599402 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:20:42.905913 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:42.908643 [debug] [MainThread]: On master: COMMIT
[0m17:20:42.910924 [debug] [MainThread]: Using redshift connection "master"
[0m17:20:42.912538 [debug] [MainThread]: On master: COMMIT
[0m17:20:42.958367 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:42.960213 [debug] [MainThread]: On master: Close
[0m17:20:42.964589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:42.965771 [debug] [MainThread]: Connection 'model.tipico.my_second_dbt_model' was properly closed.
[0m17:20:42.967417 [info ] [MainThread]: 
[0m17:20:42.968983 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.62 seconds (4.62s).
[0m17:20:42.971307 [debug] [MainThread]: Command end result
[0m17:20:42.994049 [info ] [MainThread]: 
[0m17:20:42.994804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:20:42.995355 [info ] [MainThread]: 
[0m17:20:42.995984 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:20:43.001063 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5447946, "process_user_time": 4.365841, "process_kernel_time": 0.408894, "process_mem_max_rss": "127545344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:20:43.002048 [debug] [MainThread]: Command `dbt run` succeeded at 17:20:43.001838 after 5.55 seconds
[0m17:20:43.002691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa8f4f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa0148d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa0148b80>]}
[0m17:20:43.003282 [debug] [MainThread]: Flushing usage events
[0m17:26:54.615917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca0fce730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca1c99a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc91ef1a00>]}


============================== 17:26:54.622322 | e1ecfabf-0eee-43a4-9b9a-9698a3fb14c5 ==============================
[0m17:26:54.622322 [info ] [MainThread]: Running with dbt=1.7.0
[0m17:26:54.623148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/tim/tipico/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:26:55.131514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1ecfabf-0eee-43a4-9b9a-9698a3fb14c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc91ef1a00>]}
[0m17:26:55.250323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1ecfabf-0eee-43a4-9b9a-9698a3fb14c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca1cc8250>]}
[0m17:26:55.252364 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m17:26:55.267446 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m17:26:55.331614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:26:55.332139 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:26:55.341235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1ecfabf-0eee-43a4-9b9a-9698a3fb14c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca21cc0d0>]}
[0m17:26:55.357136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1ecfabf-0eee-43a4-9b9a-9698a3fb14c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca20e8550>]}
[0m17:26:55.357787 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m17:26:55.358267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1ecfabf-0eee-43a4-9b9a-9698a3fb14c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca20e8520>]}
[0m17:26:55.360498 [info ] [MainThread]: 
[0m17:26:55.361514 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:26:55.363207 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_timothy_chan'
[0m17:26:55.387766 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:26:55.388251 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m17:26:55.388674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:55.393209 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:26:55.393704 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:26:55.887354 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:55.889472 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:26:55.891233 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m17:26:55.952816 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:55.959672 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m17:26:56.010991 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m17:26:56.036318 [debug] [MainThread]: Using redshift connection "master"
[0m17:26:56.037109 [debug] [MainThread]: On master: BEGIN
[0m17:26:56.037705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:26:56.038743 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:26:56.039384 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:26:56.339209 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:56.340686 [debug] [MainThread]: Using redshift connection "master"
[0m17:26:56.342044 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:26:56.436149 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:56.443341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1ecfabf-0eee-43a4-9b9a-9698a3fb14c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca1fc65e0>]}
[0m17:26:56.444773 [debug] [MainThread]: On master: ROLLBACK
[0m17:26:56.506809 [debug] [MainThread]: Using redshift connection "master"
[0m17:26:56.508893 [debug] [MainThread]: On master: BEGIN
[0m17:26:56.529115 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:56.531006 [debug] [MainThread]: On master: COMMIT
[0m17:26:56.533159 [debug] [MainThread]: Using redshift connection "master"
[0m17:26:56.534403 [debug] [MainThread]: On master: COMMIT
[0m17:26:56.574715 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:56.576487 [debug] [MainThread]: On master: Close
[0m17:26:56.580652 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:26:56.581828 [info ] [MainThread]: 
[0m17:26:56.587709 [debug] [Thread-1  ]: Began running node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:26:56.588772 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m17:26:56.591089 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now test.tipico.not_null_my_first_dbt_model_id.5fb22c2710)
[0m17:26:56.592073 [debug] [Thread-1  ]: Began compiling node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:26:56.619071 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:26:56.620334 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 17:26:56.592648 => 17:26:56.619952
[0m17:26:56.620913 [debug] [Thread-1  ]: Began executing node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:26:56.642609 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:26:56.645127 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:26:56.645632 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m17:26:56.646088 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:26:56.646724 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:26:56.647208 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:26:56.942285 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:56.944951 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:26:56.946944 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."timothy_chan"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m17:26:57.298020 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:57.307345 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 17:26:56.621246 => 17:26:57.306348
[0m17:26:57.308516 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m17:26:57.352350 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m17:26:57.357772 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.77s]
[0m17:26:57.360086 [debug] [Thread-1  ]: Finished running node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:26:57.361244 [debug] [Thread-1  ]: Began running node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m17:26:57.362480 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m17:26:57.364495 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.tipico.not_null_my_first_dbt_model_id.5fb22c2710, now test.tipico.not_null_my_second_dbt_model_id.151b76d778)
[0m17:26:57.365469 [debug] [Thread-1  ]: Began compiling node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m17:26:57.376770 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m17:26:57.378342 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_second_dbt_model_id.151b76d778 (compile): 17:26:57.366037 => 17:26:57.377858
[0m17:26:57.379085 [debug] [Thread-1  ]: Began executing node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m17:26:57.384395 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m17:26:57.387447 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m17:26:57.388092 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m17:26:57.388697 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:26:57.389513 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:26:57.390157 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:26:57.687959 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:57.690766 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m17:26:57.692931 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."timothy_chan"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m17:26:57.739526 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:57.747265 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_second_dbt_model_id.151b76d778 (execute): 17:26:57.379553 => 17:26:57.746338
[0m17:26:57.748429 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m17:26:57.790399 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: Close
[0m17:26:57.794496 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.43s]
[0m17:26:57.796573 [debug] [Thread-1  ]: Finished running node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m17:26:57.797909 [debug] [Thread-1  ]: Began running node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m17:26:57.798880 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m17:26:57.800866 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.tipico.not_null_my_second_dbt_model_id.151b76d778, now test.tipico.unique_my_first_dbt_model_id.16e066b321)
[0m17:26:57.801840 [debug] [Thread-1  ]: Began compiling node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m17:26:57.817954 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m17:26:57.819445 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_first_dbt_model_id.16e066b321 (compile): 17:26:57.802415 => 17:26:57.819030
[0m17:26:57.820100 [debug] [Thread-1  ]: Began executing node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m17:26:57.824904 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m17:26:57.828706 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m17:26:57.829314 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m17:26:57.829822 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:26:57.830518 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:26:57.831062 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:26:58.124145 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:58.127039 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m17:26:58.129161 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."timothy_chan"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:26:58.285189 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:58.293528 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_first_dbt_model_id.16e066b321 (execute): 17:26:57.820526 => 17:26:58.292674
[0m17:26:58.294779 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m17:26:58.333888 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: Close
[0m17:26:58.338105 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.54s]
[0m17:26:58.340137 [debug] [Thread-1  ]: Finished running node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m17:26:58.341741 [debug] [Thread-1  ]: Began running node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m17:26:58.342873 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m17:26:58.344773 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.tipico.unique_my_first_dbt_model_id.16e066b321, now test.tipico.unique_my_second_dbt_model_id.57a0f8c493)
[0m17:26:58.345694 [debug] [Thread-1  ]: Began compiling node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m17:26:58.361296 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:26:58.363674 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_second_dbt_model_id.57a0f8c493 (compile): 17:26:58.346244 => 17:26:58.363262
[0m17:26:58.364310 [debug] [Thread-1  ]: Began executing node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m17:26:58.369278 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:26:58.372994 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:26:58.373629 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m17:26:58.374210 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:26:58.375019 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:26:58.375571 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:26:58.682110 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:58.684911 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:26:58.686570 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."timothy_chan"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:26:58.805043 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:58.811515 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_second_dbt_model_id.57a0f8c493 (execute): 17:26:58.364690 => 17:26:58.810722
[0m17:26:58.812523 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m17:26:58.851668 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m17:26:58.856141 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.51s]
[0m17:26:58.858298 [debug] [Thread-1  ]: Finished running node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m17:26:58.861899 [debug] [MainThread]: Using redshift connection "master"
[0m17:26:58.862683 [debug] [MainThread]: On master: BEGIN
[0m17:26:58.863377 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:26:58.864367 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:26:58.865125 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:26:59.155301 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:59.157818 [debug] [MainThread]: On master: COMMIT
[0m17:26:59.160091 [debug] [MainThread]: Using redshift connection "master"
[0m17:26:59.161681 [debug] [MainThread]: On master: COMMIT
[0m17:26:59.205041 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:59.207268 [debug] [MainThread]: On master: Close
[0m17:26:59.211365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:59.212634 [debug] [MainThread]: Connection 'test.tipico.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m17:26:59.214349 [info ] [MainThread]: 
[0m17:26:59.215629 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.85 seconds (3.85s).
[0m17:26:59.218363 [debug] [MainThread]: Command end result
[0m17:26:59.236826 [info ] [MainThread]: 
[0m17:26:59.237627 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:26:59.238175 [info ] [MainThread]: 
[0m17:26:59.238723 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m17:26:59.239234 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:26:59.239727 [info ] [MainThread]: 
[0m17:26:59.240216 [info ] [MainThread]:   compiled Code at target/compiled/tipico/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m17:26:59.240729 [info ] [MainThread]: 
[0m17:26:59.241329 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:26:59.245936 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.7651625, "process_user_time": 4.230258, "process_kernel_time": 0.389595, "process_mem_max_rss": "127365120", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:26:59.246972 [debug] [MainThread]: Command `dbt test` failed at 17:26:59.246748 after 4.77 seconds
[0m17:26:59.247656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca0fce730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc78021eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc78021cd0>]}
[0m17:26:59.248231 [debug] [MainThread]: Flushing usage events
[0m17:30:15.701771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee92066a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eea661ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eea682850>]}


============================== 17:30:15.707999 | 6bf940cf-2785-4736-a50f-461ec84fe212 ==============================
[0m17:30:15.707999 [info ] [MainThread]: Running with dbt=1.7.0
[0m17:30:15.708757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tim/tipico/logs', 'version_check': 'True', 'profiles_dir': '/Users/tim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:30:16.219405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bf940cf-2785-4736-a50f-461ec84fe212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eea661ca0>]}
[0m17:30:16.338725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bf940cf-2785-4736-a50f-461ec84fe212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed9755730>]}
[0m17:30:16.340676 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m17:30:16.355045 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m17:30:16.417336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:30:16.417872 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:30:16.426846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bf940cf-2785-4736-a50f-461ec84fe212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eeaa7c0d0>]}
[0m17:30:16.441516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bf940cf-2785-4736-a50f-461ec84fe212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eea999520>]}
[0m17:30:16.442142 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m17:30:16.442614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bf940cf-2785-4736-a50f-461ec84fe212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eea9995b0>]}
[0m17:30:16.444788 [info ] [MainThread]: 
[0m17:30:16.445806 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:30:16.447487 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_timothy_chan'
[0m17:30:16.471871 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:30:16.472335 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m17:30:16.472741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:16.477278 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:30:16.477752 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:30:16.961363 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:16.963831 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:30:16.965714 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m17:30:17.021829 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:17.030322 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m17:30:17.076490 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m17:30:17.105259 [debug] [MainThread]: Using redshift connection "master"
[0m17:30:17.106086 [debug] [MainThread]: On master: BEGIN
[0m17:30:17.106696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:17.107811 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:30:17.108466 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:30:17.401055 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:17.403204 [debug] [MainThread]: Using redshift connection "master"
[0m17:30:17.405100 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:30:17.498717 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:17.507020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bf940cf-2785-4736-a50f-461ec84fe212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eea999370>]}
[0m17:30:17.508804 [debug] [MainThread]: On master: ROLLBACK
[0m17:30:17.571030 [debug] [MainThread]: Using redshift connection "master"
[0m17:30:17.573080 [debug] [MainThread]: On master: BEGIN
[0m17:30:17.598552 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:17.600519 [debug] [MainThread]: On master: COMMIT
[0m17:30:17.602522 [debug] [MainThread]: Using redshift connection "master"
[0m17:30:17.603836 [debug] [MainThread]: On master: COMMIT
[0m17:30:17.648599 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:17.650353 [debug] [MainThread]: On master: Close
[0m17:30:17.654750 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:30:17.656248 [info ] [MainThread]: 
[0m17:30:17.662473 [debug] [Thread-1  ]: Began running node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:30:17.663560 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m17:30:17.666023 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now test.tipico.not_null_my_first_dbt_model_id.5fb22c2710)
[0m17:30:17.666985 [debug] [Thread-1  ]: Began compiling node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:30:17.693729 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:30:17.695344 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 17:30:17.667586 => 17:30:17.694947
[0m17:30:17.695921 [debug] [Thread-1  ]: Began executing node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:30:17.717361 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:30:17.719577 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:30:17.720072 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m17:30:17.720525 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:30:17.721161 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:30:17.721649 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:30:18.007411 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:18.010328 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:30:18.012064 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."timothy_chan"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m17:30:18.057985 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:18.067289 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 17:30:17.696261 => 17:30:18.066345
[0m17:30:18.068843 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m17:30:18.111057 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m17:30:18.118831 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.45s]
[0m17:30:18.120879 [debug] [Thread-1  ]: Finished running node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:30:18.121731 [debug] [Thread-1  ]: Began running node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m17:30:18.122687 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m17:30:18.124281 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.tipico.not_null_my_first_dbt_model_id.5fb22c2710, now test.tipico.not_null_my_second_dbt_model_id.151b76d778)
[0m17:30:18.125080 [debug] [Thread-1  ]: Began compiling node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m17:30:18.134333 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m17:30:18.136473 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_second_dbt_model_id.151b76d778 (compile): 17:30:18.125559 => 17:30:18.136079
[0m17:30:18.137096 [debug] [Thread-1  ]: Began executing node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m17:30:18.141415 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m17:30:18.143945 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m17:30:18.144524 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m17:30:18.145087 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:30:18.145837 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:30:18.146380 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:30:18.437430 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:18.440383 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m17:30:18.442473 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."timothy_chan"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m17:30:18.490264 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:18.499592 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_second_dbt_model_id.151b76d778 (execute): 17:30:18.137488 => 17:30:18.498190
[0m17:30:18.501677 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m17:30:18.545732 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: Close
[0m17:30:18.551216 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.43s]
[0m17:30:18.553391 [debug] [Thread-1  ]: Finished running node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m17:30:18.554955 [debug] [Thread-1  ]: Began running node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m17:30:18.556408 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m17:30:18.558449 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.tipico.not_null_my_second_dbt_model_id.151b76d778, now test.tipico.unique_my_first_dbt_model_id.16e066b321)
[0m17:30:18.559368 [debug] [Thread-1  ]: Began compiling node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m17:30:18.575276 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m17:30:18.576714 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_first_dbt_model_id.16e066b321 (compile): 17:30:18.559935 => 17:30:18.576239
[0m17:30:18.577448 [debug] [Thread-1  ]: Began executing node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m17:30:18.582241 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m17:30:18.585899 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m17:30:18.586538 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m17:30:18.587124 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:30:18.587889 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:30:18.588433 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:30:18.889597 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:18.892308 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m17:30:18.894411 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."timothy_chan"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:30:18.941485 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:18.948838 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_first_dbt_model_id.16e066b321 (execute): 17:30:18.577853 => 17:30:18.947847
[0m17:30:18.950100 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m17:30:18.988955 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: Close
[0m17:30:18.994407 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.44s]
[0m17:30:18.996107 [debug] [Thread-1  ]: Finished running node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m17:30:18.997475 [debug] [Thread-1  ]: Began running node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m17:30:18.998655 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m17:30:19.000360 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.tipico.unique_my_first_dbt_model_id.16e066b321, now test.tipico.unique_my_second_dbt_model_id.57a0f8c493)
[0m17:30:19.001262 [debug] [Thread-1  ]: Began compiling node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m17:30:19.016026 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:30:19.017437 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_second_dbt_model_id.57a0f8c493 (compile): 17:30:19.001801 => 17:30:19.016963
[0m17:30:19.018171 [debug] [Thread-1  ]: Began executing node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m17:30:19.023195 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:30:19.027000 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:30:19.027635 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m17:30:19.028217 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:30:19.029046 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:30:19.029670 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:30:19.313500 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:19.316395 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:30:19.318469 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."timothy_chan"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:30:19.365252 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:19.374302 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_second_dbt_model_id.57a0f8c493 (execute): 17:30:19.018626 => 17:30:19.372978
[0m17:30:19.376442 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m17:30:19.423506 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m17:30:19.429860 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.43s]
[0m17:30:19.432250 [debug] [Thread-1  ]: Finished running node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m17:30:19.435628 [debug] [MainThread]: Using redshift connection "master"
[0m17:30:19.436449 [debug] [MainThread]: On master: BEGIN
[0m17:30:19.437167 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:30:19.438222 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:30:19.439042 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:30:19.732621 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:19.735137 [debug] [MainThread]: On master: COMMIT
[0m17:30:19.737328 [debug] [MainThread]: Using redshift connection "master"
[0m17:30:19.738914 [debug] [MainThread]: On master: COMMIT
[0m17:30:19.782817 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:19.784023 [debug] [MainThread]: On master: Close
[0m17:30:19.787084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:19.787975 [debug] [MainThread]: Connection 'test.tipico.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m17:30:19.789368 [info ] [MainThread]: 
[0m17:30:19.790715 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m17:30:19.793619 [debug] [MainThread]: Command end result
[0m17:30:19.813790 [info ] [MainThread]: 
[0m17:30:19.814556 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:30:19.815105 [info ] [MainThread]: 
[0m17:30:19.815654 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m17:30:19.816189 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:30:19.816687 [info ] [MainThread]: 
[0m17:30:19.817178 [info ] [MainThread]:   compiled Code at target/compiled/tipico/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m17:30:19.817713 [info ] [MainThread]: 
[0m17:30:19.818295 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:30:19.822817 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.255808, "process_user_time": 4.244217, "process_kernel_time": 0.402494, "process_mem_max_rss": "125747200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:30:19.823734 [debug] [MainThread]: Command `dbt test` failed at 17:30:19.823522 after 4.26 seconds
[0m17:30:19.824344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee92066a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eea999610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed99d1160>]}
[0m17:30:19.824929 [debug] [MainThread]: Flushing usage events
[0m17:30:30.054246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c1160e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b15fa6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b1611850>]}


============================== 17:30:30.060344 | b5af5e0a-c6cf-4b3c-87f5-7e46b4b09421 ==============================
[0m17:30:30.060344 [info ] [MainThread]: Running with dbt=1.7.0
[0m17:30:30.061126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tim/tipico/logs', 'debug': 'False', 'profiles_dir': '/Users/tim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:30:30.459958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5af5e0a-c6cf-4b3c-87f5-7e46b4b09421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b15fa6d0>]}
[0m17:30:30.579629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5af5e0a-c6cf-4b3c-87f5-7e46b4b09421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b1793be0>]}
[0m17:30:30.581637 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m17:30:30.596132 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m17:30:30.659226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:30:30.659808 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:30:30.668978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5af5e0a-c6cf-4b3c-87f5-7e46b4b09421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c29cc0d0>]}
[0m17:30:30.683929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5af5e0a-c6cf-4b3c-87f5-7e46b4b09421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c28e6550>]}
[0m17:30:30.684567 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m17:30:30.685045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5af5e0a-c6cf-4b3c-87f5-7e46b4b09421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c28e6640>]}
[0m17:30:30.687106 [info ] [MainThread]: 
[0m17:30:30.688135 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:30:30.689647 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:30:30.713390 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:30:30.713868 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:30:30.714287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:30.718698 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:30:30.719179 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:30:31.168612 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:31.176118 [debug] [ThreadPool]: On list_dev: Close
[0m17:30:31.179924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m17:30:31.195238 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:30:31.195798 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m17:30:31.196260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:31.196960 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:30:31.197450 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:30:31.513723 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:31.516098 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:30:31.517896 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m17:30:31.580315 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:31.588127 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m17:30:31.637381 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m17:30:31.665730 [debug] [MainThread]: Using redshift connection "master"
[0m17:30:31.666513 [debug] [MainThread]: On master: BEGIN
[0m17:30:31.667118 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:31.667964 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:30:31.668613 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:30:31.961319 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:31.963723 [debug] [MainThread]: Using redshift connection "master"
[0m17:30:31.965710 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:30:32.060134 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:32.067124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5af5e0a-c6cf-4b3c-87f5-7e46b4b09421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c28e60d0>]}
[0m17:30:32.068413 [debug] [MainThread]: On master: ROLLBACK
[0m17:30:32.130898 [debug] [MainThread]: Using redshift connection "master"
[0m17:30:32.133002 [debug] [MainThread]: On master: BEGIN
[0m17:30:32.154765 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:32.156566 [debug] [MainThread]: On master: COMMIT
[0m17:30:32.158508 [debug] [MainThread]: Using redshift connection "master"
[0m17:30:32.160062 [debug] [MainThread]: On master: COMMIT
[0m17:30:32.200750 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:32.202844 [debug] [MainThread]: On master: Close
[0m17:30:32.207452 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:30:32.208881 [info ] [MainThread]: 
[0m17:30:32.218616 [debug] [Thread-1  ]: Began running node model.tipico.my_first_dbt_model
[0m17:30:32.219912 [info ] [Thread-1  ]: 1 of 2 START sql table model timothy_chan.my_first_dbt_model ................... [RUN]
[0m17:30:32.221641 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.my_first_dbt_model)
[0m17:30:32.222564 [debug] [Thread-1  ]: Began compiling node model.tipico.my_first_dbt_model
[0m17:30:32.229250 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_first_dbt_model"
[0m17:30:32.231086 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (compile): 17:30:32.223126 => 17:30:32.230539
[0m17:30:32.231867 [debug] [Thread-1  ]: Began executing node model.tipico.my_first_dbt_model
[0m17:30:32.304303 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_first_dbt_model"
[0m17:30:32.306660 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:30:32.307166 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m17:30:32.307633 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:30:32.308272 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:30:32.308770 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:30:32.608045 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:32.611150 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:30:32.613328 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */

  
    

  create  table
    "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:30:32.701592 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:32.722577 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:30:32.723476 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
alter table "dev"."timothy_chan"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:30:32.849072 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:32.864286 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:30:32.865368 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
alter table "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:30:32.922832 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:32.977341 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:30:32.978071 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:30:32.978615 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:30:33.664394 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m17:30:33.668882 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:30:33.670455 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m17:30:33.712449 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:33.732749 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_first_dbt_model__dbt_backup"
[0m17:30:33.742559 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:30:33.743323 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
drop table if exists "dev"."timothy_chan"."my_first_dbt_model__dbt_backup" cascade
[0m17:30:33.787092 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:33.789780 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:30:33.790931 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:30:33.791827 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:30:34.215010 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:34.218652 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:30:34.220236 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m17:30:34.242869 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:34.246926 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (execute): 17:30:32.232329 => 17:30:34.246341
[0m17:30:34.247955 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: ROLLBACK
[0m17:30:34.291713 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: Close
[0m17:30:34.296792 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5af5e0a-c6cf-4b3c-87f5-7e46b4b09421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4980090d0>]}
[0m17:30:34.301436 [info ] [Thread-1  ]: 1 of 2 OK created sql table model timothy_chan.my_first_dbt_model .............. [[32mSUCCESS[0m in 2.08s]
[0m17:30:34.303195 [debug] [Thread-1  ]: Finished running node model.tipico.my_first_dbt_model
[0m17:30:34.304863 [debug] [Thread-1  ]: Began running node model.tipico.my_second_dbt_model
[0m17:30:34.305889 [info ] [Thread-1  ]: 2 of 2 START sql view model timothy_chan.my_second_dbt_model ................... [RUN]
[0m17:30:34.307391 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.my_first_dbt_model, now model.tipico.my_second_dbt_model)
[0m17:30:34.308225 [debug] [Thread-1  ]: Began compiling node model.tipico.my_second_dbt_model
[0m17:30:34.314667 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_second_dbt_model"
[0m17:30:34.316012 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (compile): 17:30:34.308671 => 17:30:34.315592
[0m17:30:34.316645 [debug] [Thread-1  ]: Began executing node model.tipico.my_second_dbt_model
[0m17:30:34.347668 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_second_dbt_model"
[0m17:30:34.349441 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:30:34.349933 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m17:30:34.350387 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:30:34.351039 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:30:34.351526 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:30:34.645674 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:34.648313 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:30:34.650303 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */


  create view "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."timothy_chan"."my_first_dbt_model"
where id = 1
  ) ;
[0m17:30:34.749953 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:34.765128 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:30:34.766254 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
alter table "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:30:34.831243 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:34.840862 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:30:34.842037 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:30:34.842897 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:30:35.355060 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m17:30:35.358837 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:30:35.360714 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m17:30:35.403650 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:35.415994 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_second_dbt_model__dbt_backup"
[0m17:30:35.422343 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:30:35.423039 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
drop view if exists "dev"."timothy_chan"."my_second_dbt_model__dbt_backup" cascade
[0m17:30:35.464812 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:35.467097 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:30:35.468123 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:30:35.468968 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:30:35.495190 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:35.496477 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:30:35.497541 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m17:30:35.516426 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:35.519885 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (execute): 17:30:34.317022 => 17:30:35.519119
[0m17:30:35.521058 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: ROLLBACK
[0m17:30:35.559859 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: Close
[0m17:30:35.565142 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5af5e0a-c6cf-4b3c-87f5-7e46b4b09421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b1a72fd0>]}
[0m17:30:35.567196 [info ] [Thread-1  ]: 2 of 2 OK created sql view model timothy_chan.my_second_dbt_model .............. [[32mSUCCESS[0m in 1.26s]
[0m17:30:35.569051 [debug] [Thread-1  ]: Finished running node model.tipico.my_second_dbt_model
[0m17:30:35.572352 [debug] [MainThread]: Using redshift connection "master"
[0m17:30:35.573152 [debug] [MainThread]: On master: BEGIN
[0m17:30:35.573865 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:30:35.574942 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:30:35.575733 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:30:35.871783 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:35.874204 [debug] [MainThread]: On master: COMMIT
[0m17:30:35.876278 [debug] [MainThread]: Using redshift connection "master"
[0m17:30:35.877502 [debug] [MainThread]: On master: COMMIT
[0m17:30:35.919376 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:30:35.921280 [debug] [MainThread]: On master: Close
[0m17:30:35.924955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:35.925955 [debug] [MainThread]: Connection 'model.tipico.my_second_dbt_model' was properly closed.
[0m17:30:35.927352 [info ] [MainThread]: 
[0m17:30:35.928618 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m17:30:35.931077 [debug] [MainThread]: Command end result
[0m17:30:35.955281 [info ] [MainThread]: 
[0m17:30:35.955983 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:35.956531 [info ] [MainThread]: 
[0m17:30:35.957133 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:30:35.961690 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.039243, "process_user_time": 4.393567, "process_kernel_time": 0.372021, "process_mem_max_rss": "130801664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:30:35.962734 [debug] [MainThread]: Command `dbt run` succeeded at 17:30:35.962519 after 6.04 seconds
[0m17:30:35.963319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c1160e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c2af2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c2af2490>]}
[0m17:30:35.963895 [debug] [MainThread]: Flushing usage events
[0m17:33:44.051481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f1798b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e0be23a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e0c07fa0>]}


============================== 17:33:44.058075 | dd97a814-2e5e-4613-9377-8ddfb89a50ea ==============================
[0m17:33:44.058075 [info ] [MainThread]: Running with dbt=1.7.0
[0m17:33:44.058934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tim/tipico/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:33:44.567455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd97a814-2e5e-4613-9377-8ddfb89a50ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e0be23a0>]}
[0m17:33:44.688837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd97a814-2e5e-4613-9377-8ddfb89a50ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f30ef8b0>]}
[0m17:33:44.690837 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m17:33:44.705515 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m17:33:44.761035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:33:44.761573 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:33:44.770727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd97a814-2e5e-4613-9377-8ddfb89a50ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f336c0d0>]}
[0m17:33:44.785342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd97a814-2e5e-4613-9377-8ddfb89a50ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f3286520>]}
[0m17:33:44.785989 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m17:33:44.786480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd97a814-2e5e-4613-9377-8ddfb89a50ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f3286520>]}
[0m17:33:44.788712 [info ] [MainThread]: 
[0m17:33:44.789725 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:33:44.791463 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_timothy_chan'
[0m17:33:44.817748 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:33:44.818524 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m17:33:44.818959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:44.824414 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:33:44.824945 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:33:45.374529 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:33:45.377177 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:33:45.379022 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m17:33:45.437588 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:45.446519 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m17:33:45.495170 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m17:33:45.523632 [debug] [MainThread]: Using redshift connection "master"
[0m17:33:45.524363 [debug] [MainThread]: On master: BEGIN
[0m17:33:45.524893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:45.525861 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:33:45.526431 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:33:45.828083 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:45.831802 [debug] [MainThread]: Using redshift connection "master"
[0m17:33:45.833734 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:33:45.928363 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:45.935421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd97a814-2e5e-4613-9377-8ddfb89a50ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f32860a0>]}
[0m17:33:45.936864 [debug] [MainThread]: On master: ROLLBACK
[0m17:33:46.000158 [debug] [MainThread]: Using redshift connection "master"
[0m17:33:46.002229 [debug] [MainThread]: On master: BEGIN
[0m17:33:46.023898 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:46.025762 [debug] [MainThread]: On master: COMMIT
[0m17:33:46.027749 [debug] [MainThread]: Using redshift connection "master"
[0m17:33:46.029334 [debug] [MainThread]: On master: COMMIT
[0m17:33:46.069649 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:46.071699 [debug] [MainThread]: On master: Close
[0m17:33:46.075802 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:33:46.076923 [info ] [MainThread]: 
[0m17:33:46.083084 [debug] [Thread-1  ]: Began running node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:33:46.084139 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m17:33:46.086477 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now test.tipico.not_null_my_first_dbt_model_id.5fb22c2710)
[0m17:33:46.087449 [debug] [Thread-1  ]: Began compiling node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:33:46.115070 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:33:46.116685 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 17:33:46.088030 => 17:33:46.116285
[0m17:33:46.117267 [debug] [Thread-1  ]: Began executing node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:33:46.139139 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:33:46.141402 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:33:46.141900 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m17:33:46.142356 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:33:46.142984 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:33:46.143472 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:33:46.455209 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:46.457904 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:33:46.459862 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."timothy_chan"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m17:33:46.522052 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:46.530880 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 17:33:46.117603 => 17:33:46.530110
[0m17:33:46.531882 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m17:33:46.575707 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m17:33:46.581762 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.50s]
[0m17:33:46.583815 [debug] [Thread-1  ]: Finished running node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:33:46.584986 [debug] [Thread-1  ]: Began running node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m17:33:46.586153 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m17:33:46.587827 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.tipico.not_null_my_first_dbt_model_id.5fb22c2710, now test.tipico.not_null_my_second_dbt_model_id.151b76d778)
[0m17:33:46.588732 [debug] [Thread-1  ]: Began compiling node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m17:33:46.599946 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m17:33:46.601319 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_second_dbt_model_id.151b76d778 (compile): 17:33:46.589274 => 17:33:46.600851
[0m17:33:46.602059 [debug] [Thread-1  ]: Began executing node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m17:33:46.607344 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m17:33:46.610294 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m17:33:46.610939 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m17:33:46.611537 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:33:46.612336 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:33:46.612968 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:33:46.917272 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:46.920038 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m17:33:46.922159 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."timothy_chan"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m17:33:46.974070 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:46.983181 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_second_dbt_model_id.151b76d778 (execute): 17:33:46.602505 => 17:33:46.982058
[0m17:33:46.984549 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m17:33:47.028688 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: Close
[0m17:33:47.034795 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.45s]
[0m17:33:47.037047 [debug] [Thread-1  ]: Finished running node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m17:33:47.038854 [debug] [Thread-1  ]: Began running node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m17:33:47.040179 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m17:33:47.042011 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.tipico.not_null_my_second_dbt_model_id.151b76d778, now test.tipico.unique_my_first_dbt_model_id.16e066b321)
[0m17:33:47.042999 [debug] [Thread-1  ]: Began compiling node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m17:33:47.059195 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m17:33:47.061198 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_first_dbt_model_id.16e066b321 (compile): 17:33:47.043561 => 17:33:47.060729
[0m17:33:47.061861 [debug] [Thread-1  ]: Began executing node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m17:33:47.066750 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m17:33:47.070605 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m17:33:47.071234 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m17:33:47.071744 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:33:47.072485 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:33:47.073039 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:33:47.393671 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:47.396374 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m17:33:47.398501 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."timothy_chan"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:33:47.464957 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:47.474325 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_first_dbt_model_id.16e066b321 (execute): 17:33:47.062249 => 17:33:47.472986
[0m17:33:47.476492 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m17:33:47.521070 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: Close
[0m17:33:47.525865 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.48s]
[0m17:33:47.527518 [debug] [Thread-1  ]: Finished running node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m17:33:47.529373 [debug] [Thread-1  ]: Began running node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m17:33:47.530622 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m17:33:47.532522 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.tipico.unique_my_first_dbt_model_id.16e066b321, now test.tipico.unique_my_second_dbt_model_id.57a0f8c493)
[0m17:33:47.533479 [debug] [Thread-1  ]: Began compiling node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m17:33:47.548622 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:33:47.550078 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_second_dbt_model_id.57a0f8c493 (compile): 17:33:47.534043 => 17:33:47.549596
[0m17:33:47.550828 [debug] [Thread-1  ]: Began executing node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m17:33:47.555769 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:33:47.559329 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:33:47.559972 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m17:33:47.560604 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:33:47.561352 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:33:47.561901 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:33:47.845221 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:47.848067 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:33:47.849940 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."timothy_chan"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:33:47.911999 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:47.918546 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_second_dbt_model_id.57a0f8c493 (execute): 17:33:47.551263 => 17:33:47.917604
[0m17:33:47.919728 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m17:33:47.964665 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m17:33:47.970896 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.44s]
[0m17:33:47.973173 [debug] [Thread-1  ]: Finished running node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m17:33:47.976617 [debug] [MainThread]: Using redshift connection "master"
[0m17:33:47.977440 [debug] [MainThread]: On master: BEGIN
[0m17:33:47.978174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:33:47.979215 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:33:47.980015 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:33:48.268467 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:48.271242 [debug] [MainThread]: On master: COMMIT
[0m17:33:48.273552 [debug] [MainThread]: Using redshift connection "master"
[0m17:33:48.274765 [debug] [MainThread]: On master: COMMIT
[0m17:33:48.319757 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:48.321698 [debug] [MainThread]: On master: Close
[0m17:33:48.325820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:48.326948 [debug] [MainThread]: Connection 'test.tipico.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m17:33:48.328213 [info ] [MainThread]: 
[0m17:33:48.329729 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.54 seconds (3.54s).
[0m17:33:48.332829 [debug] [MainThread]: Command end result
[0m17:33:48.354244 [info ] [MainThread]: 
[0m17:33:48.354957 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:33:48.355499 [info ] [MainThread]: 
[0m17:33:48.356084 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m17:33:48.356606 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:33:48.357110 [info ] [MainThread]: 
[0m17:33:48.357603 [info ] [MainThread]:   compiled Code at target/compiled/tipico/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m17:33:48.358115 [info ] [MainThread]: 
[0m17:33:48.358696 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:33:48.363481 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.447686, "process_user_time": 4.271929, "process_kernel_time": 0.369626, "process_mem_max_rss": "127905792", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:33:48.364438 [debug] [MainThread]: Command `dbt test` failed at 17:33:48.364233 after 4.45 seconds
[0m17:33:48.365055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f1798b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f3286160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e0e38940>]}
[0m17:33:48.365653 [debug] [MainThread]: Flushing usage events
[0m17:34:08.915649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6617076a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6710d0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6710efdc0>]}


============================== 17:34:08.922030 | 9c336de7-d0b8-4888-b86c-7f4049d714c3 ==============================
[0m17:34:08.922030 [info ] [MainThread]: Running with dbt=1.7.0
[0m17:34:08.922830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tim/tipico/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:34:09.332601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c336de7-d0b8-4888-b86c-7f4049d714c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6710d0430>]}
[0m17:34:09.452135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c336de7-d0b8-4888-b86c-7f4049d714c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6628d1c40>]}
[0m17:34:09.454110 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m17:34:09.468889 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m17:34:09.532793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:34:09.533334 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:34:09.542430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c336de7-d0b8-4888-b86c-7f4049d714c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa662cc2d60>]}
[0m17:34:09.556898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c336de7-d0b8-4888-b86c-7f4049d714c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa67131f580>]}
[0m17:34:09.557588 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m17:34:09.558073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c336de7-d0b8-4888-b86c-7f4049d714c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa67131f610>]}
[0m17:34:09.560171 [info ] [MainThread]: 
[0m17:34:09.561187 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:34:09.562687 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:34:09.587241 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:34:09.587730 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:34:09.588155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:09.592705 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:34:09.593199 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:34:10.052398 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:10.059880 [debug] [ThreadPool]: On list_dev: Close
[0m17:34:10.067221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m17:34:10.091769 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:34:10.092636 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m17:34:10.093258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:10.094183 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:34:10.094827 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:34:10.392692 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:10.395059 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:34:10.396920 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m17:34:10.458197 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:10.465597 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m17:34:10.512689 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m17:34:10.550623 [debug] [MainThread]: Using redshift connection "master"
[0m17:34:10.551554 [debug] [MainThread]: On master: BEGIN
[0m17:34:10.552273 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:34:10.553272 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:34:10.554086 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:34:10.864823 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:10.867404 [debug] [MainThread]: Using redshift connection "master"
[0m17:34:10.869423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:34:10.959917 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:10.969543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c336de7-d0b8-4888-b86c-7f4049d714c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa67131f220>]}
[0m17:34:10.971974 [debug] [MainThread]: On master: ROLLBACK
[0m17:34:11.033728 [debug] [MainThread]: Using redshift connection "master"
[0m17:34:11.035477 [debug] [MainThread]: On master: BEGIN
[0m17:34:11.056646 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:11.058130 [debug] [MainThread]: On master: COMMIT
[0m17:34:11.059477 [debug] [MainThread]: Using redshift connection "master"
[0m17:34:11.060651 [debug] [MainThread]: On master: COMMIT
[0m17:34:11.104335 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:11.106345 [debug] [MainThread]: On master: Close
[0m17:34:11.111338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:34:11.113131 [info ] [MainThread]: 
[0m17:34:11.129337 [debug] [Thread-1  ]: Began running node model.tipico.my_first_dbt_model
[0m17:34:11.131401 [info ] [Thread-1  ]: 1 of 2 START sql table model timothy_chan.my_first_dbt_model ................... [RUN]
[0m17:34:11.133552 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.my_first_dbt_model)
[0m17:34:11.134547 [debug] [Thread-1  ]: Began compiling node model.tipico.my_first_dbt_model
[0m17:34:11.144512 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_first_dbt_model"
[0m17:34:11.146388 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (compile): 17:34:11.135150 => 17:34:11.145735
[0m17:34:11.147335 [debug] [Thread-1  ]: Began executing node model.tipico.my_first_dbt_model
[0m17:34:11.221971 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_first_dbt_model"
[0m17:34:11.224807 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:34:11.225319 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m17:34:11.225799 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:34:11.226449 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:34:11.226966 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:34:11.528159 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:11.530829 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:34:11.532980 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */

  
    

  create  table
    "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id
    union all 
    select 'Dougherty K'

)

select id, name
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:34:11.558811 [debug] [Thread-1  ]: Redshift adapter: Redshift error: column "name" does not exist in source_data
[0m17:34:11.560264 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: ROLLBACK
[0m17:34:11.604756 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (execute): 17:34:11.147899 => 17:34:11.603272
[0m17:34:11.606943 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: Close
[0m17:34:11.620938 [debug] [Thread-1  ]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  column "name" does not exist in source_data
  compiled Code at target/run/tipico/models/example/my_first_dbt_model.sql
[0m17:34:11.623505 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c336de7-d0b8-4888-b86c-7f4049d714c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa662b07910>]}
[0m17:34:11.627141 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model timothy_chan.my_first_dbt_model .......... [[31mERROR[0m in 0.49s]
[0m17:34:11.629377 [debug] [Thread-1  ]: Finished running node model.tipico.my_first_dbt_model
[0m17:34:11.631868 [debug] [Thread-1  ]: Began running node model.tipico.my_second_dbt_model
[0m17:34:11.633455 [info ] [Thread-1  ]: 2 of 2 SKIP relation timothy_chan.my_second_dbt_model .......................... [[33mSKIP[0m]
[0m17:34:11.634796 [debug] [Thread-1  ]: Finished running node model.tipico.my_second_dbt_model
[0m17:34:11.638710 [debug] [MainThread]: Using redshift connection "master"
[0m17:34:11.639791 [debug] [MainThread]: On master: BEGIN
[0m17:34:11.640518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:34:11.641553 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:34:11.642341 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:34:11.955104 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:11.957608 [debug] [MainThread]: On master: COMMIT
[0m17:34:11.959834 [debug] [MainThread]: Using redshift connection "master"
[0m17:34:11.961472 [debug] [MainThread]: On master: COMMIT
[0m17:34:12.004653 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:12.006681 [debug] [MainThread]: On master: Close
[0m17:34:12.011163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:12.012829 [debug] [MainThread]: Connection 'model.tipico.my_first_dbt_model' was properly closed.
[0m17:34:12.015050 [info ] [MainThread]: 
[0m17:34:12.017300 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m17:34:12.021256 [debug] [MainThread]: Command end result
[0m17:34:12.051694 [info ] [MainThread]: 
[0m17:34:12.052737 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:34:12.053512 [info ] [MainThread]: 
[0m17:34:12.054301 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  column "name" does not exist in source_data
  compiled Code at target/run/tipico/models/example/my_first_dbt_model.sql
[0m17:34:12.055064 [info ] [MainThread]: 
[0m17:34:12.055812 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m17:34:12.060440 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2779977, "process_user_time": 4.183704, "process_kernel_time": 0.371924, "process_mem_max_rss": "130195456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:34:12.061632 [debug] [MainThread]: Command `dbt run` failed at 17:34:12.061363 after 3.28 seconds
[0m17:34:12.062454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6617076a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa630049e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa630049e20>]}
[0m17:34:12.063213 [debug] [MainThread]: Flushing usage events
[0m17:34:54.712568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe830dd3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8219f1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe821a01af0>]}


============================== 17:34:54.719400 | 0da357f7-0f2c-4bc4-94c4-d449b34d1ffa ==============================
[0m17:34:54.719400 [info ] [MainThread]: Running with dbt=1.7.0
[0m17:34:54.720304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tim/tipico/logs', 'debug': 'False', 'profiles_dir': '/Users/tim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:34:55.237242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0da357f7-0f2c-4bc4-94c4-d449b34d1ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8219f1190>]}
[0m17:34:55.358638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0da357f7-0f2c-4bc4-94c4-d449b34d1ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe821c126a0>]}
[0m17:34:55.360283 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m17:34:55.375226 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m17:34:55.441101 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:34:55.441721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:34:55.450949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0da357f7-0f2c-4bc4-94c4-d449b34d1ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe821e660d0>]}
[0m17:34:55.466445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0da357f7-0f2c-4bc4-94c4-d449b34d1ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe821d81850>]}
[0m17:34:55.467204 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m17:34:55.467763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0da357f7-0f2c-4bc4-94c4-d449b34d1ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe821d819a0>]}
[0m17:34:55.469729 [info ] [MainThread]: 
[0m17:34:55.470852 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:34:55.472367 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_timothy_chan'
[0m17:34:55.498096 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:34:55.498751 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m17:34:55.499223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:55.504022 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:34:55.504585 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:34:55.964921 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:55.967286 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:34:55.968928 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m17:34:56.027105 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:56.034767 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m17:34:56.087406 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m17:34:56.113677 [debug] [MainThread]: Using redshift connection "master"
[0m17:34:56.114606 [debug] [MainThread]: On master: BEGIN
[0m17:34:56.115320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:34:56.116272 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:34:56.117000 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:34:56.425803 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:56.428581 [debug] [MainThread]: Using redshift connection "master"
[0m17:34:56.430682 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:34:56.523575 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:56.530616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0da357f7-0f2c-4bc4-94c4-d449b34d1ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe821d81370>]}
[0m17:34:56.532183 [debug] [MainThread]: On master: ROLLBACK
[0m17:34:56.594193 [debug] [MainThread]: On master: Close
[0m17:34:56.599163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:34:56.600596 [info ] [MainThread]: 
[0m17:34:56.606694 [debug] [Thread-1  ]: Began running node model.tipico.my_first_dbt_model
[0m17:34:56.608663 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.my_first_dbt_model)
[0m17:34:56.609781 [debug] [Thread-1  ]: Began compiling node model.tipico.my_first_dbt_model
[0m17:34:56.621372 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_first_dbt_model"
[0m17:34:56.622965 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (compile): 17:34:56.610564 => 17:34:56.622413
[0m17:34:56.623832 [debug] [Thread-1  ]: Began executing node model.tipico.my_first_dbt_model
[0m17:34:56.624836 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (execute): 17:34:56.624352 => 17:34:56.624383
[0m17:34:56.626716 [debug] [Thread-1  ]: Finished running node model.tipico.my_first_dbt_model
[0m17:34:56.627981 [debug] [Thread-1  ]: Began running node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:34:56.629379 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.my_first_dbt_model, now test.tipico.not_null_my_first_dbt_model_id.5fb22c2710)
[0m17:34:56.630208 [debug] [Thread-1  ]: Began compiling node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:34:56.649773 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:34:56.651043 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 17:34:56.630667 => 17:34:56.650699
[0m17:34:56.651592 [debug] [Thread-1  ]: Began executing node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:34:56.652229 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 17:34:56.651929 => 17:34:56.651940
[0m17:34:56.653480 [debug] [Thread-1  ]: Finished running node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:34:56.654078 [debug] [Thread-1  ]: Began running node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m17:34:56.655046 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.tipico.not_null_my_first_dbt_model_id.5fb22c2710, now test.tipico.unique_my_first_dbt_model_id.16e066b321)
[0m17:34:56.655597 [debug] [Thread-1  ]: Began compiling node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m17:34:56.665091 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m17:34:56.666266 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_first_dbt_model_id.16e066b321 (compile): 17:34:56.655926 => 17:34:56.665932
[0m17:34:56.666818 [debug] [Thread-1  ]: Began executing node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m17:34:56.667459 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_first_dbt_model_id.16e066b321 (execute): 17:34:56.667156 => 17:34:56.667166
[0m17:34:56.668692 [debug] [Thread-1  ]: Finished running node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m17:34:56.669704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:56.670145 [debug] [MainThread]: Connection 'test.tipico.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m17:34:56.671326 [debug] [MainThread]: Command end result
[0m17:34:56.682331 [debug] [MainThread]: Excluded node 'not_null_my_first_dbt_model_id' from results
[0m17:34:56.682854 [debug] [MainThread]: Excluded node 'unique_my_first_dbt_model_id' from results
[0m17:34:56.683390 [info ] [MainThread]: Compiled node 'my_first_dbt_model' is:
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id
    union all 
    select 'Dougherty K'

)

select id, participants
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
[0m17:34:56.687138 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.110838, "process_user_time": 3.966808, "process_kernel_time": 0.364384, "process_mem_max_rss": "127528960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:34:56.688360 [debug] [MainThread]: Command `cli compile` succeeded at 17:34:56.687829 after 2.11 seconds
[0m17:34:56.688955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe830dd3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe821c126a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe821e29df0>]}
[0m17:34:56.689522 [debug] [MainThread]: Flushing usage events
[0m17:35:40.978533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c0798e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c1993d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c19922e0>]}


============================== 17:35:40.984844 | 3b86f32a-ec33-4963-b616-5a477ac582b9 ==============================
[0m17:35:40.984844 [info ] [MainThread]: Running with dbt=1.7.0
[0m17:35:40.985612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/tim/tipico/logs', 'version_check': 'True', 'profiles_dir': '/Users/tim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:35:41.402365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b86f32a-ec33-4963-b616-5a477ac582b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c197caf0>]}
[0m17:35:41.522116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b86f32a-ec33-4963-b616-5a477ac582b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c1962700>]}
[0m17:35:41.524097 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m17:35:41.538243 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m17:35:41.593435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:35:41.593970 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:35:41.603027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b86f32a-ec33-4963-b616-5a477ac582b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c1dec0d0>]}
[0m17:35:41.617970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b86f32a-ec33-4963-b616-5a477ac582b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c1d07460>]}
[0m17:35:41.618597 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m17:35:41.619063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b86f32a-ec33-4963-b616-5a477ac582b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c1d074f0>]}
[0m17:35:41.621145 [info ] [MainThread]: 
[0m17:35:41.622159 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:35:41.623686 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:35:41.647337 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:35:41.647827 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:35:41.648242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:41.652567 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:35:41.653035 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:35:42.144495 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:42.151384 [debug] [ThreadPool]: On list_dev: Close
[0m17:35:42.155754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m17:35:42.173391 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:35:42.174117 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m17:35:42.174668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:42.175445 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:35:42.175991 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:35:42.513962 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:42.516255 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m17:35:42.517918 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m17:35:42.574616 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:42.582065 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m17:35:42.631743 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m17:35:42.655755 [debug] [MainThread]: Using redshift connection "master"
[0m17:35:42.656503 [debug] [MainThread]: On master: BEGIN
[0m17:35:42.657127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:42.657953 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:35:42.658553 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:35:42.969661 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:42.972007 [debug] [MainThread]: Using redshift connection "master"
[0m17:35:42.974001 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:35:43.062625 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:43.071597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b86f32a-ec33-4963-b616-5a477ac582b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b22ddd90>]}
[0m17:35:43.072605 [debug] [MainThread]: On master: ROLLBACK
[0m17:35:43.131803 [debug] [MainThread]: Using redshift connection "master"
[0m17:35:43.132795 [debug] [MainThread]: On master: BEGIN
[0m17:35:43.154659 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:43.155935 [debug] [MainThread]: On master: COMMIT
[0m17:35:43.157121 [debug] [MainThread]: Using redshift connection "master"
[0m17:35:43.158032 [debug] [MainThread]: On master: COMMIT
[0m17:35:43.200793 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:43.202628 [debug] [MainThread]: On master: Close
[0m17:35:43.207627 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:35:43.209361 [info ] [MainThread]: 
[0m17:35:43.219529 [debug] [Thread-1  ]: Began running node model.tipico.my_first_dbt_model
[0m17:35:43.220835 [info ] [Thread-1  ]: 1 of 2 START sql table model timothy_chan.my_first_dbt_model ................... [RUN]
[0m17:35:43.222609 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.my_first_dbt_model)
[0m17:35:43.223391 [debug] [Thread-1  ]: Began compiling node model.tipico.my_first_dbt_model
[0m17:35:43.229991 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_first_dbt_model"
[0m17:35:43.231749 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (compile): 17:35:43.223858 => 17:35:43.231209
[0m17:35:43.232500 [debug] [Thread-1  ]: Began executing node model.tipico.my_first_dbt_model
[0m17:35:43.304168 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_first_dbt_model"
[0m17:35:43.306489 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:35:43.306999 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m17:35:43.307466 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:35:43.308112 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:35:43.308602 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:35:43.609221 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:43.611885 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:35:43.614026 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */

  
    

  create  table
    "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id, 'Dougherty K' as participants

)

select id, participants
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:35:44.055510 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:44.078622 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:35:44.079577 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
alter table "dev"."timothy_chan"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:35:44.204329 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:44.223250 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:35:44.224206 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
alter table "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:35:44.289539 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:44.340345 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:35:44.341082 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:35:44.341629 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:35:44.882285 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m17:35:44.886013 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:35:44.887918 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m17:35:44.936019 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:44.961805 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_first_dbt_model__dbt_backup"
[0m17:35:44.971913 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:35:44.972627 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
drop table if exists "dev"."timothy_chan"."my_first_dbt_model__dbt_backup" cascade
[0m17:35:45.017140 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:45.019468 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:35:45.020487 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:35:45.021339 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m17:35:45.429414 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:45.432237 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m17:35:45.434156 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m17:35:45.456387 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:45.461318 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (execute): 17:35:43.232904 => 17:35:45.460378
[0m17:35:45.462619 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: ROLLBACK
[0m17:35:45.506513 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: Close
[0m17:35:45.511184 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b86f32a-ec33-4963-b616-5a477ac582b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe280008160>]}
[0m17:35:45.514632 [info ] [Thread-1  ]: 1 of 2 OK created sql table model timothy_chan.my_first_dbt_model .............. [[32mSUCCESS[0m in 2.29s]
[0m17:35:45.516324 [debug] [Thread-1  ]: Finished running node model.tipico.my_first_dbt_model
[0m17:35:45.518316 [debug] [Thread-1  ]: Began running node model.tipico.my_second_dbt_model
[0m17:35:45.519519 [info ] [Thread-1  ]: 2 of 2 START sql view model timothy_chan.my_second_dbt_model ................... [RUN]
[0m17:35:45.521372 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.my_first_dbt_model, now model.tipico.my_second_dbt_model)
[0m17:35:45.522313 [debug] [Thread-1  ]: Began compiling node model.tipico.my_second_dbt_model
[0m17:35:45.529708 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_second_dbt_model"
[0m17:35:45.531153 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (compile): 17:35:45.522878 => 17:35:45.530669
[0m17:35:45.531907 [debug] [Thread-1  ]: Began executing node model.tipico.my_second_dbt_model
[0m17:35:45.565866 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_second_dbt_model"
[0m17:35:45.567643 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:35:45.568156 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m17:35:45.568614 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:35:45.569254 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:35:45.569737 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:35:45.862122 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:45.864753 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:35:45.866327 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */


  create view "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."timothy_chan"."my_first_dbt_model"
where id = 1
  ) ;
[0m17:35:45.971892 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:45.986954 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:35:45.987986 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
alter table "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:35:46.051654 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:46.060548 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:35:46.061993 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:35:46.063124 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:35:46.542139 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:46.546041 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:35:46.547854 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m17:35:46.589956 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:46.601746 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_second_dbt_model__dbt_backup"
[0m17:35:46.609851 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:35:46.610646 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
drop view if exists "dev"."timothy_chan"."my_second_dbt_model__dbt_backup" cascade
[0m17:35:46.648477 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:46.651360 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:35:46.652673 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:35:46.653590 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m17:35:46.677203 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:46.678931 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m17:35:46.680014 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m17:35:46.701739 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:46.706855 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (execute): 17:35:45.532352 => 17:35:46.705891
[0m17:35:46.708105 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: ROLLBACK
[0m17:35:46.751638 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: Close
[0m17:35:46.756229 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b86f32a-ec33-4963-b616-5a477ac582b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c1e15520>]}
[0m17:35:46.758208 [info ] [Thread-1  ]: 2 of 2 OK created sql view model timothy_chan.my_second_dbt_model .............. [[32mSUCCESS[0m in 1.24s]
[0m17:35:46.760029 [debug] [Thread-1  ]: Finished running node model.tipico.my_second_dbt_model
[0m17:35:46.762907 [debug] [MainThread]: Using redshift connection "master"
[0m17:35:46.763710 [debug] [MainThread]: On master: BEGIN
[0m17:35:46.764450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:46.765490 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:35:46.766270 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:35:47.067192 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:47.069708 [debug] [MainThread]: On master: COMMIT
[0m17:35:47.071911 [debug] [MainThread]: Using redshift connection "master"
[0m17:35:47.073382 [debug] [MainThread]: On master: COMMIT
[0m17:35:47.121508 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:35:47.123437 [debug] [MainThread]: On master: Close
[0m17:35:47.127951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:47.129116 [debug] [MainThread]: Connection 'model.tipico.my_second_dbt_model' was properly closed.
[0m17:35:47.130867 [info ] [MainThread]: 
[0m17:35:47.132482 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m17:35:47.135053 [debug] [MainThread]: Command end result
[0m17:35:47.157566 [info ] [MainThread]: 
[0m17:35:47.158317 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:35:47.158863 [info ] [MainThread]: 
[0m17:35:47.159487 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:35:47.164242 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.32044, "process_user_time": 4.408062, "process_kernel_time": 0.37744, "process_mem_max_rss": "129269760", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:35:47.165372 [debug] [MainThread]: Command `dbt run` succeeded at 17:35:47.165121 after 6.32 seconds
[0m17:35:47.166089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c0798e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe280028400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2800288b0>]}
[0m17:35:47.166698 [debug] [MainThread]: Flushing usage events
[0m18:17:40.588559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd89919e550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd889ae9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd889af9550>]}


============================== 18:17:40.595571 | 3f31e56e-45ad-4912-b01f-149654868856 ==============================
[0m18:17:40.595571 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:17:40.596467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tim/tipico/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:17:41.141005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f31e56e-45ad-4912-b01f-149654868856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd889c5b1f0>]}
[0m18:17:41.263220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f31e56e-45ad-4912-b01f-149654868856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd899d4d250>]}
[0m18:17:41.265440 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m18:17:41.280729 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m18:17:41.348187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:17:41.348808 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:17:41.358492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f31e56e-45ad-4912-b01f-149654868856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd899fef0d0>]}
[0m18:17:41.376633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f31e56e-45ad-4912-b01f-149654868856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd899f08820>]}
[0m18:17:41.377401 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m18:17:41.377956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f31e56e-45ad-4912-b01f-149654868856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd899f08970>]}
[0m18:17:41.379931 [info ] [MainThread]: 
[0m18:17:41.381038 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:17:41.382611 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_timothy_chan'
[0m18:17:41.408352 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:17:41.408962 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m18:17:41.409437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:41.414279 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:17:41.415137 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:17:41.911976 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:17:41.913982 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:17:41.915244 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m18:17:41.978666 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:17:41.985578 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m18:17:42.033890 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m18:17:42.058872 [debug] [MainThread]: Using redshift connection "master"
[0m18:17:42.059813 [debug] [MainThread]: On master: BEGIN
[0m18:17:42.060514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:42.061480 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:17:42.062116 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:17:42.363556 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:17:42.365779 [debug] [MainThread]: Using redshift connection "master"
[0m18:17:42.367384 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:17:42.458853 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:17:42.465919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f31e56e-45ad-4912-b01f-149654868856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd889c60070>]}
[0m18:17:42.467366 [debug] [MainThread]: On master: ROLLBACK
[0m18:17:42.531998 [debug] [MainThread]: On master: Close
[0m18:17:42.536233 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:42.537667 [info ] [MainThread]: 
[0m18:17:42.543481 [debug] [Thread-1  ]: Began running node model.tipico.my_first_dbt_model
[0m18:17:42.545421 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.my_first_dbt_model)
[0m18:17:42.546515 [debug] [Thread-1  ]: Began compiling node model.tipico.my_first_dbt_model
[0m18:17:42.558257 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_first_dbt_model"
[0m18:17:42.559985 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (compile): 18:17:42.547162 => 18:17:42.559416
[0m18:17:42.560847 [debug] [Thread-1  ]: Began executing node model.tipico.my_first_dbt_model
[0m18:17:42.561846 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (execute): 18:17:42.561374 => 18:17:42.561406
[0m18:17:42.563545 [debug] [Thread-1  ]: Finished running node model.tipico.my_first_dbt_model
[0m18:17:42.565002 [debug] [Thread-1  ]: Began running node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:17:42.566348 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.my_first_dbt_model, now test.tipico.not_null_my_first_dbt_model_id.5fb22c2710)
[0m18:17:42.567076 [debug] [Thread-1  ]: Began compiling node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:17:42.586568 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:17:42.587950 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 18:17:42.567513 => 18:17:42.587604
[0m18:17:42.588504 [debug] [Thread-1  ]: Began executing node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:17:42.589152 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 18:17:42.588841 => 18:17:42.588851
[0m18:17:42.590407 [debug] [Thread-1  ]: Finished running node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:17:42.591011 [debug] [Thread-1  ]: Began running node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m18:17:42.591968 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.tipico.not_null_my_first_dbt_model_id.5fb22c2710, now test.tipico.unique_my_first_dbt_model_id.16e066b321)
[0m18:17:42.592511 [debug] [Thread-1  ]: Began compiling node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m18:17:42.602030 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m18:17:42.603026 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_first_dbt_model_id.16e066b321 (compile): 18:17:42.592840 => 18:17:42.602693
[0m18:17:42.603575 [debug] [Thread-1  ]: Began executing node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m18:17:42.604217 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_first_dbt_model_id.16e066b321 (execute): 18:17:42.603908 => 18:17:42.603918
[0m18:17:42.605465 [debug] [Thread-1  ]: Finished running node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m18:17:42.606537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:42.607033 [debug] [MainThread]: Connection 'test.tipico.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m18:17:42.608271 [debug] [MainThread]: Command end result
[0m18:17:42.618926 [debug] [MainThread]: Excluded node 'not_null_my_first_dbt_model_id' from results
[0m18:17:42.619518 [debug] [MainThread]: Excluded node 'unique_my_first_dbt_model_id' from results
[0m18:17:42.620068 [info ] [MainThread]: Compiled node 'my_first_dbt_model' is:
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 
    1 as id
    ,'Dougherty K' as participants 
), 
group_data as (
    select 
    3686 as id
    ,'Argentina - Primera Nacional' as name
    ,207 as parent_group_country_id
    ,'Argentina' as parent_group_country_name
    ,11 as parent_group_sports_id
    ,Soccer as parent_group_sports_name
)

select *
from group_data;

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
[0m18:17:42.623711 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.17794, "process_user_time": 3.953701, "process_kernel_time": 0.791631, "process_mem_max_rss": "125939712", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:17:42.624933 [debug] [MainThread]: Command `cli compile` succeeded at 18:17:42.624392 after 2.18 seconds
[0m18:17:42.625553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd89919e550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd89a13afa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd889de2d60>]}
[0m18:17:42.626128 [debug] [MainThread]: Flushing usage events
[0m18:19:53.503213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd200bdf730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21241fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e00538e0>]}


============================== 18:19:53.509699 | 61f0faed-767c-45a0-a9c7-3cc914a2ff56 ==============================
[0m18:19:53.509699 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:19:53.510498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tim/tipico/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:19:53.923283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61f0faed-767c-45a0-a9c7-3cc914a2ff56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd212684880>]}
[0m18:19:54.044790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61f0faed-767c-45a0-a9c7-3cc914a2ff56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20183ba60>]}
[0m18:19:54.046873 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m18:19:54.062166 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m18:19:54.126913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:19:54.127482 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:19:54.136636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61f0faed-767c-45a0-a9c7-3cc914a2ff56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21294e0d0>]}
[0m18:19:54.151362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61f0faed-767c-45a0-a9c7-3cc914a2ff56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd212866550>]}
[0m18:19:54.152099 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m18:19:54.152573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61f0faed-767c-45a0-a9c7-3cc914a2ff56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2128665e0>]}
[0m18:19:54.154679 [info ] [MainThread]: 
[0m18:19:54.155742 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:19:54.157275 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:19:54.181364 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:19:54.181916 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m18:19:54.182340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:54.186797 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:19:54.187292 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:19:54.668682 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:19:54.676891 [debug] [ThreadPool]: On list_dev: Close
[0m18:19:54.681392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m18:19:54.698563 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:19:54.699200 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m18:19:54.699734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:54.700568 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:19:54.701131 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:19:54.994401 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:19:54.996645 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:19:54.998482 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m18:19:55.055855 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:19:55.062806 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m18:19:55.114851 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m18:19:55.143060 [debug] [MainThread]: Using redshift connection "master"
[0m18:19:55.143823 [debug] [MainThread]: On master: BEGIN
[0m18:19:55.144429 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:55.145296 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:19:55.145971 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:19:55.466197 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:19:55.467676 [debug] [MainThread]: Using redshift connection "master"
[0m18:19:55.468740 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:19:55.558004 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:19:55.564173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61f0faed-767c-45a0-a9c7-3cc914a2ff56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2128660d0>]}
[0m18:19:55.565543 [debug] [MainThread]: On master: ROLLBACK
[0m18:19:55.628312 [debug] [MainThread]: Using redshift connection "master"
[0m18:19:55.630742 [debug] [MainThread]: On master: BEGIN
[0m18:19:55.652551 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:19:55.654542 [debug] [MainThread]: On master: COMMIT
[0m18:19:55.656723 [debug] [MainThread]: Using redshift connection "master"
[0m18:19:55.658273 [debug] [MainThread]: On master: COMMIT
[0m18:19:55.712719 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:19:55.714858 [debug] [MainThread]: On master: Close
[0m18:19:55.719676 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:19:55.721692 [info ] [MainThread]: 
[0m18:19:55.731403 [debug] [Thread-1  ]: Began running node model.tipico.my_first_dbt_model
[0m18:19:55.732702 [info ] [Thread-1  ]: 1 of 2 START sql table model timothy_chan.my_first_dbt_model ................... [RUN]
[0m18:19:55.734325 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.my_first_dbt_model)
[0m18:19:55.735104 [debug] [Thread-1  ]: Began compiling node model.tipico.my_first_dbt_model
[0m18:19:55.741440 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_first_dbt_model"
[0m18:19:55.742874 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (compile): 18:19:55.735558 => 18:19:55.742373
[0m18:19:55.743595 [debug] [Thread-1  ]: Began executing node model.tipico.my_first_dbt_model
[0m18:19:55.816753 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_first_dbt_model"
[0m18:19:55.820096 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:19:55.820616 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m18:19:55.821093 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:19:55.821759 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:19:55.822280 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:19:56.105849 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:19:56.108337 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:19:56.110083 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */

  
    

  create  table
    "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 
    1 as id
    ,'Dougherty K' as participants 
), 
group_data as (
    select 
    3686 as id
    ,'Argentina - Primera Nacional' as name
    ,207 as parent_group_country_id
    ,'Argentina' as parent_group_country_name
    ,11 as parent_group_sports_id
    ,'Soccer' as parent_group_sports_name
    from group 
)

select *
from group_data;

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:19:56.133156 [debug] [Thread-1  ]: Redshift adapter: Redshift error: syntax error at or near "group"
[0m18:19:56.135100 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: ROLLBACK
[0m18:19:56.178695 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (execute): 18:19:55.743991 => 18:19:56.177013
[0m18:19:56.180992 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: Close
[0m18:19:56.191476 [debug] [Thread-1  ]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  syntax error at or near "group"
  compiled Code at target/run/tipico/models/example/my_first_dbt_model.sql
[0m18:19:56.192685 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f0faed-767c-45a0-a9c7-3cc914a2ff56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2019ea970>]}
[0m18:19:56.194982 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model timothy_chan.my_first_dbt_model .......... [[31mERROR[0m in 0.46s]
[0m18:19:56.196580 [debug] [Thread-1  ]: Finished running node model.tipico.my_first_dbt_model
[0m18:19:56.198373 [debug] [Thread-1  ]: Began running node model.tipico.my_second_dbt_model
[0m18:19:56.199658 [info ] [Thread-1  ]: 2 of 2 SKIP relation timothy_chan.my_second_dbt_model .......................... [[33mSKIP[0m]
[0m18:19:56.200838 [debug] [Thread-1  ]: Finished running node model.tipico.my_second_dbt_model
[0m18:19:56.203253 [debug] [MainThread]: Using redshift connection "master"
[0m18:19:56.203932 [debug] [MainThread]: On master: BEGIN
[0m18:19:56.204535 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:19:56.205401 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:19:56.206059 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:19:56.506039 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:19:56.508668 [debug] [MainThread]: On master: COMMIT
[0m18:19:56.511001 [debug] [MainThread]: Using redshift connection "master"
[0m18:19:56.512630 [debug] [MainThread]: On master: COMMIT
[0m18:19:56.557027 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:19:56.559669 [debug] [MainThread]: On master: Close
[0m18:19:56.563526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:56.564580 [debug] [MainThread]: Connection 'model.tipico.my_first_dbt_model' was properly closed.
[0m18:19:56.565967 [info ] [MainThread]: 
[0m18:19:56.566908 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.41 seconds (2.41s).
[0m18:19:56.569278 [debug] [MainThread]: Command end result
[0m18:19:56.591264 [info ] [MainThread]: 
[0m18:19:56.592005 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:19:56.592556 [info ] [MainThread]: 
[0m18:19:56.593116 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  syntax error at or near "group"
  compiled Code at target/run/tipico/models/example/my_first_dbt_model.sql
[0m18:19:56.593658 [info ] [MainThread]: 
[0m18:19:56.594253 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m18:19:56.598759 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2311072, "process_user_time": 4.097304, "process_kernel_time": 0.372285, "process_mem_max_rss": "130682880", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:19:56.599791 [debug] [MainThread]: Command `dbt run` failed at 18:19:56.599569 after 3.23 seconds
[0m18:19:56.600500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd200bdf730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d0014700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d0014460>]}
[0m18:19:56.601137 [debug] [MainThread]: Flushing usage events
[0m18:27:26.040247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08921e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08a070a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd079b238e0>]}


============================== 18:27:26.046904 | cd555038-103d-4e26-9658-466605636c9c ==============================
[0m18:27:26.046904 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:27:26.047750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tim/tipico/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:27:26.552594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd555038-103d-4e26-9658-466605636c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08a114880>]}
[0m18:27:26.672467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd555038-103d-4e26-9658-466605636c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd079d9ba60>]}
[0m18:27:26.674520 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m18:27:26.689415 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m18:27:26.755659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:27:26.756197 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:27:26.765724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd555038-103d-4e26-9658-466605636c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd07a0260d0>]}
[0m18:27:26.782445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd555038-103d-4e26-9658-466605636c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd079f3a550>]}
[0m18:27:26.783081 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m18:27:26.783551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd555038-103d-4e26-9658-466605636c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd079f3a5e0>]}
[0m18:27:26.785599 [info ] [MainThread]: 
[0m18:27:26.786609 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:27:26.788079 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:27:26.811855 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:27:26.812348 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m18:27:26.812785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:26.817164 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:27:26.817874 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:27:27.317405 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:27:27.323624 [debug] [ThreadPool]: On list_dev: Close
[0m18:27:27.327768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m18:27:27.342440 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:27:27.343031 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m18:27:27.343481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:27.344164 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:27:27.344663 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:27:27.646300 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:27:27.648986 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:27:27.650909 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m18:27:27.710007 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:27:27.717651 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m18:27:27.763915 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m18:27:27.790188 [debug] [MainThread]: Using redshift connection "master"
[0m18:27:27.791004 [debug] [MainThread]: On master: BEGIN
[0m18:27:27.791616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:27.792520 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:27:27.793166 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:27:28.107169 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:27:28.108665 [debug] [MainThread]: Using redshift connection "master"
[0m18:27:28.109627 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:27:28.208616 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:27:28.217780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd555038-103d-4e26-9658-466605636c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd079f3a0d0>]}
[0m18:27:28.218771 [debug] [MainThread]: On master: ROLLBACK
[0m18:27:28.281472 [debug] [MainThread]: Using redshift connection "master"
[0m18:27:28.282457 [debug] [MainThread]: On master: BEGIN
[0m18:27:28.305664 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:27:28.307248 [debug] [MainThread]: On master: COMMIT
[0m18:27:28.308719 [debug] [MainThread]: Using redshift connection "master"
[0m18:27:28.309755 [debug] [MainThread]: On master: COMMIT
[0m18:27:28.349866 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:27:28.351771 [debug] [MainThread]: On master: Close
[0m18:27:28.356850 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:27:28.358473 [info ] [MainThread]: 
[0m18:27:28.368356 [debug] [Thread-1  ]: Began running node model.tipico.my_first_dbt_model
[0m18:27:28.369741 [info ] [Thread-1  ]: 1 of 2 START sql table model timothy_chan.my_first_dbt_model ................... [RUN]
[0m18:27:28.371557 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.my_first_dbt_model)
[0m18:27:28.372359 [debug] [Thread-1  ]: Began compiling node model.tipico.my_first_dbt_model
[0m18:27:28.378985 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_first_dbt_model"
[0m18:27:28.380497 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (compile): 18:27:28.372835 => 18:27:28.379987
[0m18:27:28.381270 [debug] [Thread-1  ]: Began executing node model.tipico.my_first_dbt_model
[0m18:27:28.454358 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_first_dbt_model"
[0m18:27:28.458511 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:27:28.459025 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m18:27:28.459494 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:28.460133 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:27:28.460625 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:27:28.775854 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:27:28.778068 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:27:28.779787 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */

  
    

  create  table
    "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 
    1 as id
    ,'Dougherty K' as participants 
), 
group_data as (
    select 
    3686 as id
    ,'Argentina - Primera Nacional' as name
    ,207 as parent_group_country_id
    ,'Argentina' as parent_group_country_name
    ,11 as parent_group_sports_id
    ,'Soccer' as parent_group_sports_name
)

select *
from group_data;

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:27:28.807127 [debug] [Thread-1  ]: Redshift adapter: Redshift error: syntax error at or near ";"
[0m18:27:28.809262 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: ROLLBACK
[0m18:27:28.853846 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (execute): 18:27:28.381681 => 18:27:28.851909
[0m18:27:28.856091 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: Close
[0m18:27:28.864534 [debug] [Thread-1  ]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  syntax error at or near ";"
  compiled Code at target/run/tipico/models/example/my_first_dbt_model.sql
[0m18:27:28.865725 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd555038-103d-4e26-9658-466605636c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd07a04a520>]}
[0m18:27:28.867979 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model timothy_chan.my_first_dbt_model .......... [[31mERROR[0m in 0.49s]
[0m18:27:28.869498 [debug] [Thread-1  ]: Finished running node model.tipico.my_first_dbt_model
[0m18:27:28.871135 [debug] [Thread-1  ]: Began running node model.tipico.my_second_dbt_model
[0m18:27:28.872318 [info ] [Thread-1  ]: 2 of 2 SKIP relation timothy_chan.my_second_dbt_model .......................... [[33mSKIP[0m]
[0m18:27:28.873443 [debug] [Thread-1  ]: Finished running node model.tipico.my_second_dbt_model
[0m18:27:28.875807 [debug] [MainThread]: Using redshift connection "master"
[0m18:27:28.876433 [debug] [MainThread]: On master: BEGIN
[0m18:27:28.877014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:28.877846 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:27:28.878487 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:27:29.177428 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:27:29.180283 [debug] [MainThread]: On master: COMMIT
[0m18:27:29.182531 [debug] [MainThread]: Using redshift connection "master"
[0m18:27:29.184178 [debug] [MainThread]: On master: COMMIT
[0m18:27:29.224911 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:27:29.226783 [debug] [MainThread]: On master: Close
[0m18:27:29.231482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:29.233013 [debug] [MainThread]: Connection 'model.tipico.my_first_dbt_model' was properly closed.
[0m18:27:29.234976 [info ] [MainThread]: 
[0m18:27:29.236205 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m18:27:29.237991 [debug] [MainThread]: Command end result
[0m18:27:29.256837 [info ] [MainThread]: 
[0m18:27:29.257556 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:27:29.258094 [info ] [MainThread]: 
[0m18:27:29.258637 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  syntax error at or near ";"
  compiled Code at target/run/tipico/models/example/my_first_dbt_model.sql
[0m18:27:29.259181 [info ] [MainThread]: 
[0m18:27:29.259776 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m18:27:29.264056 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.366814, "process_user_time": 4.080926, "process_kernel_time": 0.837284, "process_mem_max_rss": "127692800", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:27:29.265010 [debug] [MainThread]: Command `dbt run` failed at 18:27:29.264812 after 3.37 seconds
[0m18:27:29.265660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08921e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd048014700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd048014460>]}
[0m18:27:29.266248 [debug] [MainThread]: Flushing usage events
[0m18:43:11.018517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d1440e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c1599ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c15ba850>]}


============================== 18:43:11.025762 | d00f1b54-484e-43d8-b0c2-c3e6e2ad8683 ==============================
[0m18:43:11.025762 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:43:11.026637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tim/tipico/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:43:11.569457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd00f1b54-484e-43d8-b0c2-c3e6e2ad8683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c1599ca0>]}
[0m18:43:11.688891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd00f1b54-484e-43d8-b0c2-c3e6e2ad8683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d24b0730>]}
[0m18:43:11.690853 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m18:43:11.705460 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m18:43:11.770028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:43:11.770562 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:43:11.780038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd00f1b54-484e-43d8-b0c2-c3e6e2ad8683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c19ee0d0>]}
[0m18:43:11.796184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd00f1b54-484e-43d8-b0c2-c3e6e2ad8683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c1913bb0>]}
[0m18:43:11.796915 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m18:43:11.797393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd00f1b54-484e-43d8-b0c2-c3e6e2ad8683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c1913b20>]}
[0m18:43:11.799832 [info ] [MainThread]: 
[0m18:43:11.800954 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:43:11.802978 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_timothy_chan'
[0m18:43:11.828271 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:43:11.828814 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m18:43:11.829242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:11.833952 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:43:11.834790 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:43:12.324684 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:43:12.327383 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:43:12.329229 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m18:43:12.393343 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:43:12.402197 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m18:43:12.449703 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m18:43:12.487026 [debug] [MainThread]: Using redshift connection "master"
[0m18:43:12.488020 [debug] [MainThread]: On master: BEGIN
[0m18:43:12.488719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:12.489841 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:43:12.490531 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:43:12.800753 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:43:12.803405 [debug] [MainThread]: Using redshift connection "master"
[0m18:43:12.805353 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:43:12.893188 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:43:12.902583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd00f1b54-484e-43d8-b0c2-c3e6e2ad8683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2562190>]}
[0m18:43:12.904623 [debug] [MainThread]: On master: ROLLBACK
[0m18:43:12.965196 [debug] [MainThread]: Using redshift connection "master"
[0m18:43:12.967868 [debug] [MainThread]: On master: BEGIN
[0m18:43:12.988250 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:43:12.990136 [debug] [MainThread]: On master: COMMIT
[0m18:43:12.992065 [debug] [MainThread]: Using redshift connection "master"
[0m18:43:12.993629 [debug] [MainThread]: On master: COMMIT
[0m18:43:13.035320 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:43:13.036721 [debug] [MainThread]: On master: Close
[0m18:43:13.039229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:43:13.040175 [info ] [MainThread]: 
[0m18:43:13.049900 [debug] [Thread-1  ]: Began running node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:43:13.051637 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m18:43:13.054898 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now test.tipico.not_null_my_first_dbt_model_id.5fb22c2710)
[0m18:43:13.056239 [debug] [Thread-1  ]: Began compiling node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:43:13.089719 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:43:13.092118 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 18:43:13.057019 => 18:43:13.091703
[0m18:43:13.092740 [debug] [Thread-1  ]: Began executing node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:43:13.114709 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:43:13.117045 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:43:13.117551 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m18:43:13.118013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:43:13.118657 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:43:13.119149 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:43:13.422833 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:43:13.425403 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:43:13.427511 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."timothy_chan"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:43:13.488292 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:43:13.500748 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 18:43:13.093093 => 18:43:13.499353
[0m18:43:13.502885 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m18:43:13.546239 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m18:43:13.552054 [info ] [Thread-1  ]: 1 of 4 PASS not_null_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.50s]
[0m18:43:13.554368 [debug] [Thread-1  ]: Finished running node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:43:13.555824 [debug] [Thread-1  ]: Began running node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m18:43:13.557689 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m18:43:13.561533 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.tipico.not_null_my_first_dbt_model_id.5fb22c2710, now test.tipico.not_null_my_second_dbt_model_id.151b76d778)
[0m18:43:13.562745 [debug] [Thread-1  ]: Began compiling node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m18:43:13.578359 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m18:43:13.580339 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_second_dbt_model_id.151b76d778 (compile): 18:43:13.563441 => 18:43:13.579734
[0m18:43:13.581264 [debug] [Thread-1  ]: Began executing node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m18:43:13.587850 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m18:43:13.591309 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m18:43:13.592080 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m18:43:13.592779 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:43:13.593652 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:43:13.594286 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:43:13.892785 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:43:13.895585 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m18:43:13.897655 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."timothy_chan"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:43:13.947006 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:43:13.956761 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_second_dbt_model_id.151b76d778 (execute): 18:43:13.581812 => 18:43:13.955282
[0m18:43:13.958917 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m18:43:13.998876 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: Close
[0m18:43:14.004648 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.44s]
[0m18:43:14.007886 [debug] [Thread-1  ]: Finished running node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m18:43:14.010213 [debug] [Thread-1  ]: Began running node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m18:43:14.012261 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m18:43:14.015008 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.tipico.not_null_my_second_dbt_model_id.151b76d778, now test.tipico.unique_my_first_dbt_model_id.16e066b321)
[0m18:43:14.016360 [debug] [Thread-1  ]: Began compiling node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m18:43:14.037730 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m18:43:14.039746 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_first_dbt_model_id.16e066b321 (compile): 18:43:14.017066 => 18:43:14.039231
[0m18:43:14.040512 [debug] [Thread-1  ]: Began executing node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m18:43:14.046255 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m18:43:14.049957 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m18:43:14.050601 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m18:43:14.054026 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:43:14.054910 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:43:14.055475 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:43:14.348030 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:43:14.349674 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m18:43:14.350697 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."timothy_chan"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:43:14.418698 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:43:14.423746 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_first_dbt_model_id.16e066b321 (execute): 18:43:14.040975 => 18:43:14.422785
[0m18:43:14.425417 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m18:43:14.466880 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: Close
[0m18:43:14.471189 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.46s]
[0m18:43:14.472788 [debug] [Thread-1  ]: Finished running node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m18:43:14.474249 [debug] [Thread-1  ]: Began running node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m18:43:14.476555 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m18:43:14.479570 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.tipico.unique_my_first_dbt_model_id.16e066b321, now test.tipico.unique_my_second_dbt_model_id.57a0f8c493)
[0m18:43:14.480739 [debug] [Thread-1  ]: Began compiling node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m18:43:14.497227 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:43:14.500122 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_second_dbt_model_id.57a0f8c493 (compile): 18:43:14.481345 => 18:43:14.499416
[0m18:43:14.501151 [debug] [Thread-1  ]: Began executing node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m18:43:14.508246 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:43:14.513040 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:43:14.513988 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m18:43:14.514725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:43:14.515937 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:43:14.516808 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:43:14.810250 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:43:14.812611 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:43:14.814900 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."timothy_chan"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:43:14.882410 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:43:14.886889 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_second_dbt_model_id.57a0f8c493 (execute): 18:43:14.501758 => 18:43:14.886223
[0m18:43:14.887949 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m18:43:14.931980 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m18:43:14.935426 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.46s]
[0m18:43:14.937163 [debug] [Thread-1  ]: Finished running node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m18:43:14.941146 [debug] [MainThread]: Using redshift connection "master"
[0m18:43:14.942226 [debug] [MainThread]: On master: BEGIN
[0m18:43:14.943202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:14.944458 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:43:14.945279 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:43:15.242504 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:43:15.244131 [debug] [MainThread]: On master: COMMIT
[0m18:43:15.245775 [debug] [MainThread]: Using redshift connection "master"
[0m18:43:15.246694 [debug] [MainThread]: On master: COMMIT
[0m18:43:15.290261 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:43:15.291960 [debug] [MainThread]: On master: Close
[0m18:43:15.294964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:15.295961 [debug] [MainThread]: Connection 'test.tipico.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m18:43:15.297221 [info ] [MainThread]: 
[0m18:43:15.298206 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m18:43:15.302409 [debug] [MainThread]: Command end result
[0m18:43:15.330674 [info ] [MainThread]: 
[0m18:43:15.331595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:43:15.332257 [info ] [MainThread]: 
[0m18:43:15.332975 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:43:15.337896 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.460864, "process_user_time": 4.427736, "process_kernel_time": 0.829608, "process_mem_max_rss": "126783488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:43:15.339080 [debug] [MainThread]: Command `dbt test` succeeded at 18:43:15.338829 after 4.46 seconds
[0m18:43:15.339792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d1440e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77a001c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c19ff250>]}
[0m18:43:15.340473 [debug] [MainThread]: Flushing usage events
[0m18:45:21.707929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98c9380e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d9bb1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d9bd2850>]}


============================== 18:45:21.714326 | a54a3444-6b06-44ba-b585-9645b4ed63bc ==============================
[0m18:45:21.714326 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:45:21.715160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tim/tipico/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:45:22.233269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a54a3444-6b06-44ba-b585-9645b4ed63bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d9bb1ca0>]}
[0m18:45:22.352572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a54a3444-6b06-44ba-b585-9645b4ed63bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ca279730>]}
[0m18:45:22.354608 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m18:45:22.369429 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m18:45:22.433790 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m18:45:22.434437 [debug] [MainThread]: Partial parsing: deleted file: tipico://models/example/group.sql
[0m18:45:22.450634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a54a3444-6b06-44ba-b585-9645b4ed63bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ca391df0>]}
[0m18:45:22.464784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a54a3444-6b06-44ba-b585-9645b4ed63bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d9e708b0>]}
[0m18:45:22.465429 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m18:45:22.465900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a54a3444-6b06-44ba-b585-9645b4ed63bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d9e70940>]}
[0m18:45:22.468079 [info ] [MainThread]: 
[0m18:45:22.469103 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:45:22.470797 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_timothy_chan'
[0m18:45:22.495254 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:45:22.495725 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m18:45:22.496129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:22.500662 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:45:22.501142 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:45:23.005528 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:45:23.008091 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:45:23.009896 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m18:45:23.072635 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:23.081265 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m18:45:23.128924 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m18:45:23.158285 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:23.159115 [debug] [MainThread]: On master: BEGIN
[0m18:45:23.159739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:45:23.160631 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:45:23.161270 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:45:23.450915 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:23.453338 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:23.455353 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:45:23.548574 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:23.556724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a54a3444-6b06-44ba-b585-9645b4ed63bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d9f14f40>]}
[0m18:45:23.558311 [debug] [MainThread]: On master: ROLLBACK
[0m18:45:23.618542 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:23.620541 [debug] [MainThread]: On master: BEGIN
[0m18:45:23.642295 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:23.644137 [debug] [MainThread]: On master: COMMIT
[0m18:45:23.646010 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:23.647538 [debug] [MainThread]: On master: COMMIT
[0m18:45:23.684646 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:23.686512 [debug] [MainThread]: On master: Close
[0m18:45:23.691099 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:45:23.692423 [info ] [MainThread]: 
[0m18:45:23.699306 [debug] [Thread-1  ]: Began running node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:45:23.700458 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m18:45:23.702347 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now test.tipico.not_null_my_first_dbt_model_id.5fb22c2710)
[0m18:45:23.703322 [debug] [Thread-1  ]: Began compiling node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:45:23.729150 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:45:23.730731 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 18:45:23.703910 => 18:45:23.730314
[0m18:45:23.731313 [debug] [Thread-1  ]: Began executing node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:45:23.754012 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:45:23.756320 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:45:23.756827 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m18:45:23.757297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:23.757956 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:45:23.758449 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:45:24.043535 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:24.046209 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:45:24.048292 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."timothy_chan"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:45:24.089402 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:24.098272 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 18:45:23.731663 => 18:45:24.097478
[0m18:45:24.099366 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m18:45:24.143227 [debug] [Thread-1  ]: On test.tipico.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m18:45:24.149767 [info ] [Thread-1  ]: 1 of 4 PASS not_null_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.45s]
[0m18:45:24.152531 [debug] [Thread-1  ]: Finished running node test.tipico.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:45:24.153635 [debug] [Thread-1  ]: Began running node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m18:45:24.154804 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m18:45:24.156589 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.tipico.not_null_my_first_dbt_model_id.5fb22c2710, now test.tipico.not_null_my_second_dbt_model_id.151b76d778)
[0m18:45:24.157557 [debug] [Thread-1  ]: Began compiling node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m18:45:24.168110 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m18:45:24.170520 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_second_dbt_model_id.151b76d778 (compile): 18:45:24.158138 => 18:45:24.170052
[0m18:45:24.171256 [debug] [Thread-1  ]: Began executing node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m18:45:24.176582 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m18:45:24.179531 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m18:45:24.180187 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m18:45:24.180782 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:24.181607 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:45:24.182247 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:45:24.459014 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:24.461958 [debug] [Thread-1  ]: Using redshift connection "test.tipico.not_null_my_second_dbt_model_id.151b76d778"
[0m18:45:24.464182 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."timothy_chan"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:45:24.509878 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:24.525448 [debug] [Thread-1  ]: Timing info for test.tipico.not_null_my_second_dbt_model_id.151b76d778 (execute): 18:45:24.171691 => 18:45:24.524448
[0m18:45:24.526694 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m18:45:24.564604 [debug] [Thread-1  ]: On test.tipico.not_null_my_second_dbt_model_id.151b76d778: Close
[0m18:45:24.568857 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.41s]
[0m18:45:24.570847 [debug] [Thread-1  ]: Finished running node test.tipico.not_null_my_second_dbt_model_id.151b76d778
[0m18:45:24.572148 [debug] [Thread-1  ]: Began running node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m18:45:24.573243 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m18:45:24.574969 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.tipico.not_null_my_second_dbt_model_id.151b76d778, now test.tipico.unique_my_first_dbt_model_id.16e066b321)
[0m18:45:24.575894 [debug] [Thread-1  ]: Began compiling node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m18:45:24.591283 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m18:45:24.593957 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_first_dbt_model_id.16e066b321 (compile): 18:45:24.576447 => 18:45:24.593445
[0m18:45:24.594634 [debug] [Thread-1  ]: Began executing node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m18:45:24.599487 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m18:45:24.603079 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m18:45:24.603743 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m18:45:24.604456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:24.605173 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:45:24.605730 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:45:24.910518 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:24.913460 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_first_dbt_model_id.16e066b321"
[0m18:45:24.915646 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."timothy_chan"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:45:24.958191 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:24.967234 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_first_dbt_model_id.16e066b321 (execute): 18:45:24.595011 => 18:45:24.965566
[0m18:45:24.968386 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m18:45:25.011570 [debug] [Thread-1  ]: On test.tipico.unique_my_first_dbt_model_id.16e066b321: Close
[0m18:45:25.015315 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.44s]
[0m18:45:25.017209 [debug] [Thread-1  ]: Finished running node test.tipico.unique_my_first_dbt_model_id.16e066b321
[0m18:45:25.018151 [debug] [Thread-1  ]: Began running node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m18:45:25.018984 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m18:45:25.020402 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.tipico.unique_my_first_dbt_model_id.16e066b321, now test.tipico.unique_my_second_dbt_model_id.57a0f8c493)
[0m18:45:25.021094 [debug] [Thread-1  ]: Began compiling node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m18:45:25.028893 [debug] [Thread-1  ]: Writing injected SQL for node "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:45:25.030157 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_second_dbt_model_id.57a0f8c493 (compile): 18:45:25.021498 => 18:45:25.029815
[0m18:45:25.030674 [debug] [Thread-1  ]: Began executing node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m18:45:25.034493 [debug] [Thread-1  ]: Writing runtime sql for node "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:45:25.037291 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:45:25.037793 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m18:45:25.038248 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:25.039039 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:45:25.039520 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:45:25.327447 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:25.330466 [debug] [Thread-1  ]: Using redshift connection "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:45:25.332581 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "test.tipico.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."timothy_chan"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:45:25.373988 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:25.380948 [debug] [Thread-1  ]: Timing info for test.tipico.unique_my_second_dbt_model_id.57a0f8c493 (execute): 18:45:25.030973 => 18:45:25.380093
[0m18:45:25.382067 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m18:45:25.423130 [debug] [Thread-1  ]: On test.tipico.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m18:45:25.427072 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.41s]
[0m18:45:25.428988 [debug] [Thread-1  ]: Finished running node test.tipico.unique_my_second_dbt_model_id.57a0f8c493
[0m18:45:25.432429 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:25.433248 [debug] [MainThread]: On master: BEGIN
[0m18:45:25.433993 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:45:25.435008 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:45:25.435792 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:45:25.728918 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:25.731175 [debug] [MainThread]: On master: COMMIT
[0m18:45:25.732805 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:25.733908 [debug] [MainThread]: On master: COMMIT
[0m18:45:25.774723 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:25.777050 [debug] [MainThread]: On master: Close
[0m18:45:25.780949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:25.781789 [debug] [MainThread]: Connection 'test.tipico.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m18:45:25.783049 [info ] [MainThread]: 
[0m18:45:25.784299 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.31 seconds (3.31s).
[0m18:45:25.786996 [debug] [MainThread]: Command end result
[0m18:45:25.809791 [info ] [MainThread]: 
[0m18:45:25.810497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:45:25.811040 [info ] [MainThread]: 
[0m18:45:25.811635 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:45:25.816358 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.2423553, "process_user_time": 4.236519, "process_kernel_time": 0.413341, "process_mem_max_rss": "129896448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:45:25.817306 [debug] [MainThread]: Command `dbt test` succeeded at 18:45:25.817099 after 4.24 seconds
[0m18:45:25.817915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98c9380e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d9fe6e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d9fe6a90>]}
[0m18:45:25.818524 [debug] [MainThread]: Flushing usage events
[0m18:45:32.539979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c70f96730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c61eefa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c61ee28e0>]}


============================== 18:45:32.546089 | 4aeebee5-4250-42dc-872a-6c9643ed98e8 ==============================
[0m18:45:32.546089 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:45:32.546863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tim/tipico/logs', 'version_check': 'True', 'profiles_dir': '/Users/tim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:45:32.931736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4aeebee5-4250-42dc-872a-6c9643ed98e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c71d64880>]}
[0m18:45:33.050358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4aeebee5-4250-42dc-872a-6c9643ed98e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c71daba60>]}
[0m18:45:33.052435 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m18:45:33.066720 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m18:45:33.128179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:33.128734 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:33.137894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4aeebee5-4250-42dc-872a-6c9643ed98e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c71f3cd60>]}
[0m18:45:33.152042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4aeebee5-4250-42dc-872a-6c9643ed98e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c72087580>]}
[0m18:45:33.152694 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m18:45:33.153167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4aeebee5-4250-42dc-872a-6c9643ed98e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c72087610>]}
[0m18:45:33.155213 [info ] [MainThread]: 
[0m18:45:33.156221 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:45:33.157709 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:45:33.181340 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:45:33.181836 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m18:45:33.182264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:33.186661 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:45:33.187173 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:45:33.630088 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:33.634801 [debug] [ThreadPool]: On list_dev: Close
[0m18:45:33.639304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m18:45:33.663941 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:45:33.664800 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m18:45:33.665429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:33.666305 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:45:33.666853 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:45:33.957384 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:33.959868 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:45:33.961869 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m18:45:34.018452 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:34.024592 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m18:45:34.071828 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m18:45:34.103105 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:34.104219 [debug] [MainThread]: On master: BEGIN
[0m18:45:34.104978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:45:34.106022 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:45:34.106821 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:45:34.407007 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:34.408455 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:34.409447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:45:34.504009 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:34.508763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4aeebee5-4250-42dc-872a-6c9643ed98e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c71ed2790>]}
[0m18:45:34.510222 [debug] [MainThread]: On master: ROLLBACK
[0m18:45:34.571994 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:34.573159 [debug] [MainThread]: On master: BEGIN
[0m18:45:34.592626 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:34.593934 [debug] [MainThread]: On master: COMMIT
[0m18:45:34.595052 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:34.595864 [debug] [MainThread]: On master: COMMIT
[0m18:45:34.637584 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:34.638872 [debug] [MainThread]: On master: Close
[0m18:45:34.641278 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:45:34.642519 [info ] [MainThread]: 
[0m18:45:34.654622 [debug] [Thread-1  ]: Began running node model.tipico.my_first_dbt_model
[0m18:45:34.656433 [info ] [Thread-1  ]: 1 of 2 START sql table model timothy_chan.my_first_dbt_model ................... [RUN]
[0m18:45:34.658589 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.my_first_dbt_model)
[0m18:45:34.659802 [debug] [Thread-1  ]: Began compiling node model.tipico.my_first_dbt_model
[0m18:45:34.669005 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_first_dbt_model"
[0m18:45:34.671528 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (compile): 18:45:34.660414 => 18:45:34.670874
[0m18:45:34.672492 [debug] [Thread-1  ]: Began executing node model.tipico.my_first_dbt_model
[0m18:45:34.748159 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_first_dbt_model"
[0m18:45:34.751429 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:45:34.751934 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m18:45:34.752393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:34.753028 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:45:34.753513 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:45:35.052431 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:35.055416 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:45:35.057703 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */

  
    

  create  table
    "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 
    1 as id
    ,'Dougherty K' as participants 
),
group_data as (
    select 
    3686 as id
    ,'Argentina - Primera Nacional' as name
    ,207 as parent_group_country_id
    ,'Argentina' as parent_group_country_name
    ,11 as parent_group_sports_id
    ,'Soccer' as parent_group_sports_name
)
select *
from group_data;

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:45:35.081228 [debug] [Thread-1  ]: Redshift adapter: Redshift error: syntax error at or near ";"
[0m18:45:35.082420 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: ROLLBACK
[0m18:45:35.127609 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (execute): 18:45:34.673054 => 18:45:35.126733
[0m18:45:35.128838 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: Close
[0m18:45:35.136165 [debug] [Thread-1  ]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  syntax error at or near ";"
  compiled Code at target/run/tipico/models/example/my_first_dbt_model.sql
[0m18:45:35.137609 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aeebee5-4250-42dc-872a-6c9643ed98e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c62018670>]}
[0m18:45:35.139761 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model timothy_chan.my_first_dbt_model .......... [[31mERROR[0m in 0.48s]
[0m18:45:35.141449 [debug] [Thread-1  ]: Finished running node model.tipico.my_first_dbt_model
[0m18:45:35.143639 [debug] [Thread-1  ]: Began running node model.tipico.my_second_dbt_model
[0m18:45:35.144855 [info ] [Thread-1  ]: 2 of 2 SKIP relation timothy_chan.my_second_dbt_model .......................... [[33mSKIP[0m]
[0m18:45:35.145911 [debug] [Thread-1  ]: Finished running node model.tipico.my_second_dbt_model
[0m18:45:35.148990 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:35.150118 [debug] [MainThread]: On master: BEGIN
[0m18:45:35.150927 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:45:35.152017 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:45:35.152806 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:45:35.453571 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:35.455817 [debug] [MainThread]: On master: COMMIT
[0m18:45:35.457119 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:35.457909 [debug] [MainThread]: On master: COMMIT
[0m18:45:35.503468 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:45:35.504645 [debug] [MainThread]: On master: Close
[0m18:45:35.506938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:35.507824 [debug] [MainThread]: Connection 'model.tipico.my_first_dbt_model' was properly closed.
[0m18:45:35.508916 [info ] [MainThread]: 
[0m18:45:35.509859 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m18:45:35.511804 [debug] [MainThread]: Command end result
[0m18:45:35.537203 [info ] [MainThread]: 
[0m18:45:35.538054 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:45:35.538613 [info ] [MainThread]: 
[0m18:45:35.539184 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  syntax error at or near ";"
  compiled Code at target/run/tipico/models/example/my_first_dbt_model.sql
[0m18:45:35.539748 [info ] [MainThread]: 
[0m18:45:35.540368 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m18:45:35.544433 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.1389189, "process_user_time": 4.143359, "process_kernel_time": 0.350863, "process_mem_max_rss": "124858368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:45:35.545561 [debug] [MainThread]: Command `dbt run` failed at 18:45:35.545318 after 3.14 seconds
[0m18:45:35.546308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c70f96730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c71dd8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c20009e80>]}
[0m18:45:35.547152 [debug] [MainThread]: Flushing usage events
[0m18:46:06.360947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff149228e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1398d9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1398f06a0>]}


============================== 18:46:06.367067 | e879b21f-51d0-4657-81de-e586f4de13f3 ==============================
[0m18:46:06.367067 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:46:06.367838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tim/tipico/logs', 'debug': 'False', 'profiles_dir': '/Users/tim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:46:06.874984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e879b21f-51d0-4657-81de-e586f4de13f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1398f4280>]}
[0m18:46:06.995458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e879b21f-51d0-4657-81de-e586f4de13f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff139bbfdf0>]}
[0m18:46:06.997020 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m18:46:07.011311 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m18:46:07.067062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:46:07.067593 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:46:07.076682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e879b21f-51d0-4657-81de-e586f4de13f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14a1960d0>]}
[0m18:46:07.090753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e879b21f-51d0-4657-81de-e586f4de13f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14a0aa4f0>]}
[0m18:46:07.091398 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m18:46:07.091878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e879b21f-51d0-4657-81de-e586f4de13f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14a0aa580>]}
[0m18:46:07.093937 [info ] [MainThread]: 
[0m18:46:07.094980 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:46:07.096454 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:46:07.120272 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:46:07.120750 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m18:46:07.121166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:07.125567 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:46:07.126040 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:46:07.577729 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:07.586304 [debug] [ThreadPool]: On list_dev: Close
[0m18:46:07.589835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m18:46:07.605472 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:46:07.606078 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m18:46:07.606599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:46:07.607389 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:46:07.607954 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:46:07.916182 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:07.917872 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:46:07.919197 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m18:46:07.977326 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:07.984699 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m18:46:08.031428 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m18:46:08.060315 [debug] [MainThread]: Using redshift connection "master"
[0m18:46:08.061071 [debug] [MainThread]: On master: BEGIN
[0m18:46:08.061683 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:46:08.062583 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:46:08.063224 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:46:08.369687 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:08.372256 [debug] [MainThread]: Using redshift connection "master"
[0m18:46:08.374227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:46:08.467586 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:08.474457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e879b21f-51d0-4657-81de-e586f4de13f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff139b89a90>]}
[0m18:46:08.475583 [debug] [MainThread]: On master: ROLLBACK
[0m18:46:08.542215 [debug] [MainThread]: Using redshift connection "master"
[0m18:46:08.543980 [debug] [MainThread]: On master: BEGIN
[0m18:46:08.565663 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:08.567542 [debug] [MainThread]: On master: COMMIT
[0m18:46:08.568810 [debug] [MainThread]: Using redshift connection "master"
[0m18:46:08.569684 [debug] [MainThread]: On master: COMMIT
[0m18:46:08.614259 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:08.616274 [debug] [MainThread]: On master: Close
[0m18:46:08.620237 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:46:08.621400 [info ] [MainThread]: 
[0m18:46:08.631588 [debug] [Thread-1  ]: Began running node model.tipico.my_first_dbt_model
[0m18:46:08.632902 [info ] [Thread-1  ]: 1 of 2 START sql table model timothy_chan.my_first_dbt_model ................... [RUN]
[0m18:46:08.634641 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.my_first_dbt_model)
[0m18:46:08.635574 [debug] [Thread-1  ]: Began compiling node model.tipico.my_first_dbt_model
[0m18:46:08.642131 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_first_dbt_model"
[0m18:46:08.643556 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (compile): 18:46:08.636080 => 18:46:08.643055
[0m18:46:08.644297 [debug] [Thread-1  ]: Began executing node model.tipico.my_first_dbt_model
[0m18:46:08.717627 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_first_dbt_model"
[0m18:46:08.720785 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:46:08.721291 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m18:46:08.721754 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:46:08.722400 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:46:08.722886 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:46:09.056008 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:09.058656 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:46:09.060692 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */

  
    

  create  table
    "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 
    1 as id
    ,'Dougherty K' as participants 
),
group_data as (
    select 
    3686 as id
    ,'Argentina - Primera Nacional' as name
    ,207 as parent_group_country_id
    ,'Argentina' as parent_group_country_name
    ,11 as parent_group_sports_id
    ,'Soccer' as parent_group_sports_name
)
select *
from group_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:46:16.051201 [debug] [Thread-1  ]: SQL status: SUCCESS in 7.0 seconds
[0m18:46:16.071563 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:46:16.072425 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
alter table "dev"."timothy_chan"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:46:16.191073 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:16.205356 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:46:16.206308 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
alter table "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:46:16.265725 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:16.314817 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m18:46:16.315602 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:46:16.316143 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m18:46:16.818638 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:46:16.822354 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:46:16.823896 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m18:46:16.865741 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:16.888395 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_first_dbt_model__dbt_backup"
[0m18:46:16.898138 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:46:16.898819 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
drop table if exists "dev"."timothy_chan"."my_first_dbt_model__dbt_backup" cascade
[0m18:46:16.943935 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:16.946260 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m18:46:16.947285 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:46:16.948129 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m18:46:17.342856 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:17.345675 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:46:17.347594 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m18:46:17.369686 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:17.375087 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (execute): 18:46:08.644736 => 18:46:17.373907
[0m18:46:17.376482 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: ROLLBACK
[0m18:46:17.415517 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: Close
[0m18:46:17.420498 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e879b21f-51d0-4657-81de-e586f4de13f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1080090d0>]}
[0m18:46:17.424881 [info ] [Thread-1  ]: 1 of 2 OK created sql table model timothy_chan.my_first_dbt_model .............. [[32mSUCCESS[0m in 8.79s]
[0m18:46:17.427133 [debug] [Thread-1  ]: Finished running node model.tipico.my_first_dbt_model
[0m18:46:17.429713 [debug] [Thread-1  ]: Began running node model.tipico.my_second_dbt_model
[0m18:46:17.431023 [info ] [Thread-1  ]: 2 of 2 START sql view model timothy_chan.my_second_dbt_model ................... [RUN]
[0m18:46:17.432778 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.my_first_dbt_model, now model.tipico.my_second_dbt_model)
[0m18:46:17.433721 [debug] [Thread-1  ]: Began compiling node model.tipico.my_second_dbt_model
[0m18:46:17.441554 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_second_dbt_model"
[0m18:46:17.443750 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (compile): 18:46:17.434273 => 18:46:17.443267
[0m18:46:17.444495 [debug] [Thread-1  ]: Began executing node model.tipico.my_second_dbt_model
[0m18:46:17.478812 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_second_dbt_model"
[0m18:46:17.480558 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:46:17.481054 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m18:46:17.481508 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:46:17.482144 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:46:17.482628 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:46:17.780046 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:17.782673 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:46:17.784704 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */


  create view "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."timothy_chan"."my_first_dbt_model"
where id = 1
  ) ;
[0m18:46:17.890064 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:17.903459 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:46:17.904343 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
alter table "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:46:17.966978 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:17.973943 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m18:46:17.975546 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:46:17.976647 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m18:46:18.396468 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:18.400466 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:46:18.402420 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m18:46:18.447643 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:18.459981 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_second_dbt_model__dbt_backup"
[0m18:46:18.468166 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:46:18.469139 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
drop view if exists "dev"."timothy_chan"."my_second_dbt_model__dbt_backup" cascade
[0m18:46:18.511550 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:18.515140 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m18:46:18.516459 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:46:18.517533 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m18:46:18.543383 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:18.545523 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:46:18.546896 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m18:46:18.567922 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:18.572061 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (execute): 18:46:17.444932 => 18:46:18.571384
[0m18:46:18.573106 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: ROLLBACK
[0m18:46:18.613863 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: Close
[0m18:46:18.618441 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e879b21f-51d0-4657-81de-e586f4de13f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14a1c8130>]}
[0m18:46:18.620262 [info ] [Thread-1  ]: 2 of 2 OK created sql view model timothy_chan.my_second_dbt_model .............. [[32mSUCCESS[0m in 1.19s]
[0m18:46:18.622053 [debug] [Thread-1  ]: Finished running node model.tipico.my_second_dbt_model
[0m18:46:18.624953 [debug] [MainThread]: Using redshift connection "master"
[0m18:46:18.625758 [debug] [MainThread]: On master: BEGIN
[0m18:46:18.626475 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:46:18.627480 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:46:18.628259 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:46:18.923008 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:18.925481 [debug] [MainThread]: On master: COMMIT
[0m18:46:18.927787 [debug] [MainThread]: Using redshift connection "master"
[0m18:46:18.929389 [debug] [MainThread]: On master: COMMIT
[0m18:46:18.974651 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:46:18.976702 [debug] [MainThread]: On master: Close
[0m18:46:18.979790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:18.980822 [debug] [MainThread]: Connection 'model.tipico.my_second_dbt_model' was properly closed.
[0m18:46:18.982103 [info ] [MainThread]: 
[0m18:46:18.983221 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 11.89 seconds (11.89s).
[0m18:46:18.985778 [debug] [MainThread]: Command end result
[0m18:46:19.009907 [info ] [MainThread]: 
[0m18:46:19.010655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:46:19.011205 [info ] [MainThread]: 
[0m18:46:19.011807 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:46:19.016083 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.788404, "process_user_time": 4.406665, "process_kernel_time": 0.385424, "process_mem_max_rss": "126017536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:46:19.017251 [debug] [MainThread]: Command `dbt run` succeeded at 18:46:19.016994 after 12.79 seconds
[0m18:46:19.017922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff149228e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14a1f9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14a1f95e0>]}
[0m18:46:19.018509 [debug] [MainThread]: Flushing usage events
[0m18:51:14.588404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff13a1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff21ba610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff21a0100>]}


============================== 18:51:14.594616 | 22a438ae-2279-479d-9521-00712827dfbb ==============================
[0m18:51:14.594616 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:51:14.595383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/tim/tipico/logs', 'profiles_dir': '/Users/tim/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:51:15.107535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22a438ae-2279-479d-9521-00712827dfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff21ba610>]}
[0m18:51:15.227873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22a438ae-2279-479d-9521-00712827dfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff22eefa0>]}
[0m18:51:15.229884 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m18:51:15.244398 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m18:51:15.307926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:51:15.308466 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:51:15.317654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22a438ae-2279-479d-9521-00712827dfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff001e3e0d0>]}
[0m18:51:15.331344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22a438ae-2279-479d-9521-00712827dfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff001d5da00>]}
[0m18:51:15.331973 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m18:51:15.332444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22a438ae-2279-479d-9521-00712827dfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff001d5da30>]}
[0m18:51:15.334554 [info ] [MainThread]: 
[0m18:51:15.335573 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:51:15.337159 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:51:15.361244 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:51:15.361722 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m18:51:15.362154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:15.366535 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:51:15.367008 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:51:15.832676 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:15.839200 [debug] [ThreadPool]: On list_dev: Close
[0m18:51:15.843685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m18:51:15.861849 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:51:15.862516 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m18:51:15.863028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:15.863817 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:51:15.864362 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:51:16.160544 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:16.162861 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:51:16.164654 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m18:51:16.226035 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:16.233253 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m18:51:16.282273 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m18:51:16.311914 [debug] [MainThread]: Using redshift connection "master"
[0m18:51:16.312697 [debug] [MainThread]: On master: BEGIN
[0m18:51:16.313300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:51:16.314168 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:51:16.314799 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:51:16.635205 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:16.638175 [debug] [MainThread]: Using redshift connection "master"
[0m18:51:16.640447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:51:16.735714 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:16.741916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22a438ae-2279-479d-9521-00712827dfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff23a9d90>]}
[0m18:51:16.743269 [debug] [MainThread]: On master: ROLLBACK
[0m18:51:16.807673 [debug] [MainThread]: Using redshift connection "master"
[0m18:51:16.809740 [debug] [MainThread]: On master: BEGIN
[0m18:51:16.831765 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:16.833706 [debug] [MainThread]: On master: COMMIT
[0m18:51:16.835316 [debug] [MainThread]: Using redshift connection "master"
[0m18:51:16.836487 [debug] [MainThread]: On master: COMMIT
[0m18:51:16.875360 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:16.877672 [debug] [MainThread]: On master: Close
[0m18:51:16.882740 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:51:16.883820 [info ] [MainThread]: 
[0m18:51:16.890214 [debug] [Thread-1  ]: Began running node model.tipico.group
[0m18:51:16.892164 [info ] [Thread-1  ]: 1 of 3 START sql view model timothy_chan.group ................................. [RUN]
[0m18:51:16.893955 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.group)
[0m18:51:16.894925 [debug] [Thread-1  ]: Began compiling node model.tipico.group
[0m18:51:16.899788 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.group"
[0m18:51:16.901273 [debug] [Thread-1  ]: Timing info for model.tipico.group (compile): 18:51:16.895486 => 18:51:16.900788
[0m18:51:16.902026 [debug] [Thread-1  ]: Began executing node model.tipico.group
[0m18:51:16.961222 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.group"
[0m18:51:16.963974 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:51:16.964498 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:51:16.964974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:51:16.965660 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:51:16.966143 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:51:17.270056 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:17.272669 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:51:17.274774 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */


  create view "dev"."timothy_chan"."group__dbt_tmp" as (
    with group_data as (
    select 
    3686 as id
    ,'Argentina - Primera Nacional' as name
    ,207 as parent_group_country_id
    ,'Argentina' as parent_group_country_name
    ,11 as parent_group_sports_id
    ,'Soccer' as parent_group_sports_name
)
select *
from group_data
  ) ;
[0m18:51:17.385115 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:17.407283 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:51:17.408181 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group__dbt_tmp" rename to "group"
[0m18:51:17.474663 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:17.512324 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:51:17.513079 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:51:17.513622 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:51:18.011485 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:18.014417 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:51:18.015945 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:51:18.060199 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:18.080903 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."group__dbt_backup"
[0m18:51:18.092897 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:51:18.093600 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
drop view if exists "dev"."timothy_chan"."group__dbt_backup" cascade
[0m18:51:18.137495 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:18.139737 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:51:18.140768 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:51:18.141608 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:51:18.165963 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:18.167234 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:51:18.168197 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:51:18.189539 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:18.193334 [debug] [Thread-1  ]: Timing info for model.tipico.group (execute): 18:51:16.902485 => 18:51:18.192571
[0m18:51:18.194542 [debug] [Thread-1  ]: On model.tipico.group: ROLLBACK
[0m18:51:18.233970 [debug] [Thread-1  ]: On model.tipico.group: Close
[0m18:51:18.238916 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22a438ae-2279-479d-9521-00712827dfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff23a9d90>]}
[0m18:51:18.243267 [info ] [Thread-1  ]: 1 of 3 OK created sql view model timothy_chan.group ............................ [[32mSUCCESS[0m in 1.35s]
[0m18:51:18.244727 [debug] [Thread-1  ]: Finished running node model.tipico.group
[0m18:51:18.245626 [debug] [Thread-1  ]: Began running node model.tipico.my_first_dbt_model
[0m18:51:18.246716 [info ] [Thread-1  ]: 2 of 3 START sql table model timothy_chan.my_first_dbt_model ................... [RUN]
[0m18:51:18.248269 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.group, now model.tipico.my_first_dbt_model)
[0m18:51:18.249025 [debug] [Thread-1  ]: Began compiling node model.tipico.my_first_dbt_model
[0m18:51:18.255404 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_first_dbt_model"
[0m18:51:18.256622 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (compile): 18:51:18.249476 => 18:51:18.256214
[0m18:51:18.257268 [debug] [Thread-1  ]: Began executing node model.tipico.my_first_dbt_model
[0m18:51:18.304364 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_first_dbt_model"
[0m18:51:18.306571 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:51:18.307077 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m18:51:18.307545 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:51:18.308195 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:51:18.308679 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:51:18.595111 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:18.597664 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:51:18.599760 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */

  
    

  create  table
    "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 
    1 as id
    ,'Dougherty K' as participants 
)


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:51:18.621371 [debug] [Thread-1  ]: Redshift adapter: Redshift error: syntax error at or near ")"
[0m18:51:18.622692 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: ROLLBACK
[0m18:51:18.667223 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (execute): 18:51:18.257656 => 18:51:18.665532
[0m18:51:18.669010 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: Close
[0m18:51:18.677210 [debug] [Thread-1  ]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  syntax error at or near ")"
  compiled Code at target/run/tipico/models/example/my_first_dbt_model.sql
[0m18:51:18.678293 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22a438ae-2279-479d-9521-00712827dfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff23a9d90>]}
[0m18:51:18.679768 [error] [Thread-1  ]: 2 of 3 ERROR creating sql table model timothy_chan.my_first_dbt_model .......... [[31mERROR[0m in 0.43s]
[0m18:51:18.681228 [debug] [Thread-1  ]: Finished running node model.tipico.my_first_dbt_model
[0m18:51:18.683064 [debug] [Thread-1  ]: Began running node model.tipico.my_second_dbt_model
[0m18:51:18.684057 [info ] [Thread-1  ]: 3 of 3 SKIP relation timothy_chan.my_second_dbt_model .......................... [[33mSKIP[0m]
[0m18:51:18.685076 [debug] [Thread-1  ]: Finished running node model.tipico.my_second_dbt_model
[0m18:51:18.687428 [debug] [MainThread]: Using redshift connection "master"
[0m18:51:18.688075 [debug] [MainThread]: On master: BEGIN
[0m18:51:18.688655 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:51:18.689491 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:51:18.690117 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:51:18.973839 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:18.976476 [debug] [MainThread]: On master: COMMIT
[0m18:51:18.978443 [debug] [MainThread]: Using redshift connection "master"
[0m18:51:18.979418 [debug] [MainThread]: On master: COMMIT
[0m18:51:19.017822 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:51:19.020042 [debug] [MainThread]: On master: Close
[0m18:51:19.024302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:19.025774 [debug] [MainThread]: Connection 'model.tipico.my_first_dbt_model' was properly closed.
[0m18:51:19.027548 [info ] [MainThread]: 
[0m18:51:19.028783 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 3.69 seconds (3.69s).
[0m18:51:19.031378 [debug] [MainThread]: Command end result
[0m18:51:19.051225 [info ] [MainThread]: 
[0m18:51:19.052040 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:51:19.052606 [info ] [MainThread]: 
[0m18:51:19.053161 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  syntax error at or near ")"
  compiled Code at target/run/tipico/models/example/my_first_dbt_model.sql
[0m18:51:19.053694 [info ] [MainThread]: 
[0m18:51:19.054289 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m18:51:19.058794 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.6128097, "process_user_time": 4.311558, "process_kernel_time": 0.388764, "process_mem_max_rss": "129089536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:51:19.059858 [debug] [MainThread]: Command `dbt run` failed at 18:51:19.059623 after 4.61 seconds
[0m18:51:19.060590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff13a1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff2177610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff001f13370>]}
[0m18:51:19.061268 [debug] [MainThread]: Flushing usage events
[0m18:52:11.962084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe181888b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe182802190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe182827610>]}


============================== 18:52:11.968277 | d5b781b4-19e3-41df-9eed-38734e421a1c ==============================
[0m18:52:11.968277 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:52:11.969063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tim/tipico/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:52:12.419853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5b781b4-19e3-41df-9eed-38734e421a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe182ac4c40>]}
[0m18:52:12.540300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5b781b4-19e3-41df-9eed-38734e421a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe182afac10>]}
[0m18:52:12.542371 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m18:52:12.556556 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m18:52:12.619074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:52:12.619635 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:52:12.628919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5b781b4-19e3-41df-9eed-38734e421a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1915fe0d0>]}
[0m18:52:12.643081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5b781b4-19e3-41df-9eed-38734e421a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe191523a60>]}
[0m18:52:12.643719 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m18:52:12.644186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5b781b4-19e3-41df-9eed-38734e421a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe191523a90>]}
[0m18:52:12.646322 [info ] [MainThread]: 
[0m18:52:12.647346 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:52:12.649026 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:52:12.672961 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:52:12.673460 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m18:52:12.673887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:12.678311 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:52:12.678789 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:52:13.129270 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:13.135017 [debug] [ThreadPool]: On list_dev: Close
[0m18:52:13.139026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m18:52:13.153881 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:52:13.154551 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m18:52:13.155081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:13.155928 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:52:13.156508 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:52:13.473633 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:13.476096 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:52:13.477951 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m18:52:13.542826 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:13.550627 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m18:52:13.600014 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m18:52:13.631299 [debug] [MainThread]: Using redshift connection "master"
[0m18:52:13.632136 [debug] [MainThread]: On master: BEGIN
[0m18:52:13.632751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:52:13.633583 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:52:13.634163 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:52:13.939776 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:13.942192 [debug] [MainThread]: Using redshift connection "master"
[0m18:52:13.944244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:52:14.037063 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:14.045804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5b781b4-19e3-41df-9eed-38734e421a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe182b6b8b0>]}
[0m18:52:14.048311 [debug] [MainThread]: On master: ROLLBACK
[0m18:52:14.110769 [debug] [MainThread]: Using redshift connection "master"
[0m18:52:14.112017 [debug] [MainThread]: On master: BEGIN
[0m18:52:14.133432 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:14.135193 [debug] [MainThread]: On master: COMMIT
[0m18:52:14.136806 [debug] [MainThread]: Using redshift connection "master"
[0m18:52:14.137915 [debug] [MainThread]: On master: COMMIT
[0m18:52:14.183719 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:14.184869 [debug] [MainThread]: On master: Close
[0m18:52:14.187288 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:52:14.188224 [info ] [MainThread]: 
[0m18:52:14.191119 [debug] [Thread-1  ]: Began running node model.tipico.group
[0m18:52:14.191842 [info ] [Thread-1  ]: 1 of 3 START sql view model timothy_chan.group ................................. [RUN]
[0m18:52:14.192821 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.group)
[0m18:52:14.193349 [debug] [Thread-1  ]: Began compiling node model.tipico.group
[0m18:52:14.196103 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.group"
[0m18:52:14.197010 [debug] [Thread-1  ]: Timing info for model.tipico.group (compile): 18:52:14.193661 => 18:52:14.196691
[0m18:52:14.197488 [debug] [Thread-1  ]: Began executing node model.tipico.group
[0m18:52:14.252332 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.group"
[0m18:52:14.254894 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:52:14.255409 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:52:14.255893 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:14.256576 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:52:14.257088 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:52:14.541513 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:14.544403 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:52:14.546421 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */


  create view "dev"."timothy_chan"."group__dbt_tmp" as (
    with group_data as (
    select 
    3686 as id
    ,'Argentina - Primera Nacional' as name
    ,207 as parent_group_country_id
    ,'Argentina' as parent_group_country_name
    ,11 as parent_group_sports_id
    ,'Soccer' as parent_group_sports_name
)
select *
from group_data
  ) ;
[0m18:52:14.653165 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:14.675681 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:52:14.676630 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group" rename to "group__dbt_backup"
[0m18:52:14.736348 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:14.748318 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:52:14.749328 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group__dbt_tmp" rename to "group"
[0m18:52:14.808587 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:14.857376 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:52:14.858145 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:52:14.858683 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:52:15.559223 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:52:15.563227 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:52:15.564709 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:52:15.607086 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:15.631085 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."group__dbt_backup"
[0m18:52:15.640876 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:52:15.641561 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
drop view if exists "dev"."timothy_chan"."group__dbt_backup" cascade
[0m18:52:15.684253 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:15.686512 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:52:15.687559 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:52:15.688404 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:52:16.155589 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:16.158479 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:52:16.160422 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:52:16.180744 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:16.185251 [debug] [Thread-1  ]: Timing info for model.tipico.group (execute): 18:52:14.197777 => 18:52:16.184534
[0m18:52:16.186288 [debug] [Thread-1  ]: On model.tipico.group: ROLLBACK
[0m18:52:16.227103 [debug] [Thread-1  ]: On model.tipico.group: Close
[0m18:52:16.232641 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5b781b4-19e3-41df-9eed-38734e421a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe182ac4fd0>]}
[0m18:52:16.236027 [info ] [Thread-1  ]: 1 of 3 OK created sql view model timothy_chan.group ............................ [[32mSUCCESS[0m in 2.04s]
[0m18:52:16.237861 [debug] [Thread-1  ]: Finished running node model.tipico.group
[0m18:52:16.238865 [debug] [Thread-1  ]: Began running node model.tipico.my_first_dbt_model
[0m18:52:16.240117 [info ] [Thread-1  ]: 2 of 3 START sql table model timothy_chan.my_first_dbt_model ................... [RUN]
[0m18:52:16.241917 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.group, now model.tipico.my_first_dbt_model)
[0m18:52:16.242871 [debug] [Thread-1  ]: Began compiling node model.tipico.my_first_dbt_model
[0m18:52:16.250499 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_first_dbt_model"
[0m18:52:16.251951 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (compile): 18:52:16.243434 => 18:52:16.251473
[0m18:52:16.252695 [debug] [Thread-1  ]: Began executing node model.tipico.my_first_dbt_model
[0m18:52:16.303279 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_first_dbt_model"
[0m18:52:16.307418 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:52:16.307926 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m18:52:16.308396 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:16.309065 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:52:16.309560 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:52:16.600534 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:16.603136 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:52:16.605282 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */

  
    

  create  table
    "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 
    1 as id
    ,'Dougherty K' as participants 
)
select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:52:16.688441 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:16.703634 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:52:16.704659 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
alter table "dev"."timothy_chan"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:52:16.833342 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:16.847724 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:52:16.848732 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
alter table "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:52:16.917472 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:16.937630 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m18:52:16.938672 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:52:16.939397 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m18:52:17.439303 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:17.442997 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:52:17.444594 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m18:52:17.495993 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:17.511146 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_first_dbt_model__dbt_backup"
[0m18:52:17.518411 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:52:17.519241 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
drop table if exists "dev"."timothy_chan"."my_first_dbt_model__dbt_backup" cascade
[0m18:52:17.562069 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:17.565346 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m18:52:17.566466 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:52:17.567360 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m18:52:17.942679 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:17.945828 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:52:17.947910 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m18:52:17.971968 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:17.977940 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (execute): 18:52:16.253153 => 18:52:17.976676
[0m18:52:17.980018 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: ROLLBACK
[0m18:52:18.033958 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: Close
[0m18:52:18.038757 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5b781b4-19e3-41df-9eed-38734e421a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe182da7370>]}
[0m18:52:18.041287 [info ] [Thread-1  ]: 2 of 3 OK created sql table model timothy_chan.my_first_dbt_model .............. [[32mSUCCESS[0m in 1.80s]
[0m18:52:18.043547 [debug] [Thread-1  ]: Finished running node model.tipico.my_first_dbt_model
[0m18:52:18.046001 [debug] [Thread-1  ]: Began running node model.tipico.my_second_dbt_model
[0m18:52:18.047116 [info ] [Thread-1  ]: 3 of 3 START sql view model timothy_chan.my_second_dbt_model ................... [RUN]
[0m18:52:18.048805 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.my_first_dbt_model, now model.tipico.my_second_dbt_model)
[0m18:52:18.049706 [debug] [Thread-1  ]: Began compiling node model.tipico.my_second_dbt_model
[0m18:52:18.057072 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_second_dbt_model"
[0m18:52:18.058612 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (compile): 18:52:18.050249 => 18:52:18.058129
[0m18:52:18.059381 [debug] [Thread-1  ]: Began executing node model.tipico.my_second_dbt_model
[0m18:52:18.069432 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_second_dbt_model"
[0m18:52:18.071981 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:52:18.072616 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m18:52:18.073240 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:18.074098 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:52:18.074766 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:52:18.378454 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:18.381499 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:52:18.383069 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */


  create view "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."timothy_chan"."my_first_dbt_model"
where id = 1
  ) ;
[0m18:52:18.493253 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:18.506975 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:52:18.508067 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
alter table "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:52:18.574956 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:18.584910 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m18:52:18.586304 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:52:18.587267 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m18:52:19.027044 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:19.032320 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:52:19.033902 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m18:52:19.075686 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:19.088883 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_second_dbt_model__dbt_backup"
[0m18:52:19.092183 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:52:19.093133 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
drop view if exists "dev"."timothy_chan"."my_second_dbt_model__dbt_backup" cascade
[0m18:52:19.136910 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:19.140920 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m18:52:19.142363 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:52:19.143453 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m18:52:19.168643 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:19.170328 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:52:19.171423 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m18:52:19.192730 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:19.196941 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (execute): 18:52:18.059830 => 18:52:19.196002
[0m18:52:19.198447 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: ROLLBACK
[0m18:52:19.242991 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: Close
[0m18:52:19.247301 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5b781b4-19e3-41df-9eed-38734e421a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1917b42b0>]}
[0m18:52:19.249529 [info ] [Thread-1  ]: 3 of 3 OK created sql view model timothy_chan.my_second_dbt_model .............. [[32mSUCCESS[0m in 1.20s]
[0m18:52:19.251333 [debug] [Thread-1  ]: Finished running node model.tipico.my_second_dbt_model
[0m18:52:19.254632 [debug] [MainThread]: Using redshift connection "master"
[0m18:52:19.255530 [debug] [MainThread]: On master: BEGIN
[0m18:52:19.256293 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:52:19.257398 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:52:19.258212 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:52:19.552802 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:19.555471 [debug] [MainThread]: On master: COMMIT
[0m18:52:19.557738 [debug] [MainThread]: Using redshift connection "master"
[0m18:52:19.559111 [debug] [MainThread]: On master: COMMIT
[0m18:52:19.604076 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:19.605890 [debug] [MainThread]: On master: Close
[0m18:52:19.610345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:19.611533 [debug] [MainThread]: Connection 'model.tipico.my_second_dbt_model' was properly closed.
[0m18:52:19.613270 [info ] [MainThread]: 
[0m18:52:19.614989 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 6.97 seconds (6.97s).
[0m18:52:19.617543 [debug] [MainThread]: Command end result
[0m18:52:19.641359 [info ] [MainThread]: 
[0m18:52:19.642088 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:52:19.642635 [info ] [MainThread]: 
[0m18:52:19.643252 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:52:19.647932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.8196344, "process_user_time": 4.598864, "process_kernel_time": 0.410054, "process_mem_max_rss": "130183168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:52:19.648967 [debug] [MainThread]: Command `dbt run` succeeded at 18:52:19.648741 after 7.82 seconds
[0m18:52:19.649578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe181888b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1917b49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1917b4fd0>]}
[0m18:52:19.650170 [debug] [MainThread]: Flushing usage events
[0m18:53:03.977199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc29146730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a18fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a1828e0>]}


============================== 18:53:03.983400 | 5514623d-85d0-4339-bb45-73642f7fc4ac ==============================
[0m18:53:03.983400 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:53:03.984203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tim/tipico/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:53:04.494343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5514623d-85d0-4339-bb45-73642f7fc4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a3f4880>]}
[0m18:53:04.614447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5514623d-85d0-4339-bb45-73642f7fc4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a43ba60>]}
[0m18:53:04.616439 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m18:53:04.630612 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m18:53:04.685906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:53:04.686434 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:53:04.695730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5514623d-85d0-4339-bb45-73642f7fc4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a73d970>]}
[0m18:53:04.709990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5514623d-85d0-4339-bb45-73642f7fc4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a663c10>]}
[0m18:53:04.710633 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m18:53:04.711112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5514623d-85d0-4339-bb45-73642f7fc4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a663b80>]}
[0m18:53:04.713284 [info ] [MainThread]: 
[0m18:53:04.714294 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:53:04.715874 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:53:04.739602 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:53:04.740084 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m18:53:04.740510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:04.744861 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:53:04.745343 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:53:05.246540 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:53:05.254622 [debug] [ThreadPool]: On list_dev: Close
[0m18:53:05.259613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m18:53:05.277973 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:53:05.278697 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m18:53:05.279306 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:05.280093 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:53:05.280648 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:53:05.588333 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:05.590641 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:53:05.592433 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m18:53:05.653505 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:05.660711 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m18:53:05.705756 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m18:53:05.734609 [debug] [MainThread]: Using redshift connection "master"
[0m18:53:05.735409 [debug] [MainThread]: On master: BEGIN
[0m18:53:05.736012 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:53:05.736886 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:53:05.737556 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:53:06.064764 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:06.067206 [debug] [MainThread]: Using redshift connection "master"
[0m18:53:06.068516 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:53:06.166583 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:06.173881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5514623d-85d0-4339-bb45-73642f7fc4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc39892790>]}
[0m18:53:06.175329 [debug] [MainThread]: On master: ROLLBACK
[0m18:53:06.235556 [debug] [MainThread]: Using redshift connection "master"
[0m18:53:06.237605 [debug] [MainThread]: On master: BEGIN
[0m18:53:06.260105 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:06.261937 [debug] [MainThread]: On master: COMMIT
[0m18:53:06.263409 [debug] [MainThread]: Using redshift connection "master"
[0m18:53:06.264467 [debug] [MainThread]: On master: COMMIT
[0m18:53:06.310906 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:06.313083 [debug] [MainThread]: On master: Close
[0m18:53:06.317166 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:53:06.318131 [info ] [MainThread]: 
[0m18:53:06.323992 [debug] [Thread-1  ]: Began running node model.tipico.group
[0m18:53:06.325238 [info ] [Thread-1  ]: 1 of 3 START sql table model timothy_chan.group ................................ [RUN]
[0m18:53:06.326957 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.group)
[0m18:53:06.329257 [debug] [Thread-1  ]: Began compiling node model.tipico.group
[0m18:53:06.336282 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.group"
[0m18:53:06.337678 [debug] [Thread-1  ]: Timing info for model.tipico.group (compile): 18:53:06.329829 => 18:53:06.337173
[0m18:53:06.338416 [debug] [Thread-1  ]: Began executing node model.tipico.group
[0m18:53:06.410737 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.group"
[0m18:53:06.413340 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:53:06.413835 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:53:06.414297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:53:06.414974 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:53:06.415494 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:53:06.719104 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:06.721693 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:53:06.723879 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */

  
    

  create  table
    "dev"."timothy_chan"."group__dbt_tmp"
    
    
    
  as (
    

with group_data as (
    select 
    3686 as id
    ,'Argentina - Primera Nacional' as name
    ,207 as parent_group_country_id
    ,'Argentina' as parent_group_country_name
    ,11 as parent_group_sports_id
    ,'Soccer' as parent_group_sports_name
)
select *
from group_data
  );
[0m18:53:07.101342 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:07.121172 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:53:07.122078 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group" rename to "group__dbt_backup"
[0m18:53:07.236708 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:07.251099 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:53:07.252085 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group__dbt_tmp" rename to "group"
[0m18:53:07.315942 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:07.367731 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:53:07.368449 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:53:07.369008 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:53:07.834539 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:07.838396 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:53:07.840324 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:53:07.882430 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:07.906149 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."group__dbt_backup"
[0m18:53:07.916246 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:53:07.917045 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
drop view if exists "dev"."timothy_chan"."group__dbt_backup" cascade
[0m18:53:07.959000 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:07.961285 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:53:07.962322 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:53:07.963174 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:53:08.432198 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:08.435023 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:53:08.436874 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:53:08.460214 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:08.466021 [debug] [Thread-1  ]: Timing info for model.tipico.group (execute): 18:53:06.338864 => 18:53:08.464761
[0m18:53:08.467392 [debug] [Thread-1  ]: On model.tipico.group: ROLLBACK
[0m18:53:08.507970 [debug] [Thread-1  ]: On model.tipico.group: Close
[0m18:53:08.512766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5514623d-85d0-4339-bb45-73642f7fc4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc39997280>]}
[0m18:53:08.515783 [info ] [Thread-1  ]: 1 of 3 OK created sql table model timothy_chan.group ........................... [[32mSUCCESS[0m in 2.19s]
[0m18:53:08.517757 [debug] [Thread-1  ]: Finished running node model.tipico.group
[0m18:53:08.518784 [debug] [Thread-1  ]: Began running node model.tipico.my_first_dbt_model
[0m18:53:08.519854 [info ] [Thread-1  ]: 2 of 3 START sql table model timothy_chan.my_first_dbt_model ................... [RUN]
[0m18:53:08.521497 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.group, now model.tipico.my_first_dbt_model)
[0m18:53:08.522401 [debug] [Thread-1  ]: Began compiling node model.tipico.my_first_dbt_model
[0m18:53:08.529853 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_first_dbt_model"
[0m18:53:08.531287 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (compile): 18:53:08.522945 => 18:53:08.530799
[0m18:53:08.532049 [debug] [Thread-1  ]: Began executing node model.tipico.my_first_dbt_model
[0m18:53:08.542257 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_first_dbt_model"
[0m18:53:08.544973 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:53:08.545623 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m18:53:08.546233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:53:08.547090 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:53:08.547723 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:53:08.867196 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:08.870047 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:53:08.871933 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */

  
    

  create  table
    "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 
    1 as id
    ,'Dougherty K' as participants 
)
select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:53:08.951836 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:08.967924 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:53:08.968941 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
alter table "dev"."timothy_chan"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:53:09.089535 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:09.104061 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:53:09.105071 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
alter table "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:53:09.170606 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:09.179309 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m18:53:09.180527 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:53:09.181417 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m18:53:09.666834 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:09.670584 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:53:09.672353 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m18:53:09.715050 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:09.726369 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_first_dbt_model__dbt_backup"
[0m18:53:09.735601 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:53:09.736447 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
drop table if exists "dev"."timothy_chan"."my_first_dbt_model__dbt_backup" cascade
[0m18:53:09.781785 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:09.784107 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m18:53:09.785149 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:53:09.786003 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m18:53:10.307511 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:53:10.310965 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:53:10.312921 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m18:53:10.337920 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:10.343003 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (execute): 18:53:08.532496 => 18:53:10.341936
[0m18:53:10.344563 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: ROLLBACK
[0m18:53:10.388160 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: Close
[0m18:53:10.393346 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5514623d-85d0-4339-bb45-73642f7fc4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc39997280>]}
[0m18:53:10.395941 [info ] [Thread-1  ]: 2 of 3 OK created sql table model timothy_chan.my_first_dbt_model .............. [[32mSUCCESS[0m in 1.87s]
[0m18:53:10.398077 [debug] [Thread-1  ]: Finished running node model.tipico.my_first_dbt_model
[0m18:53:10.400069 [debug] [Thread-1  ]: Began running node model.tipico.my_second_dbt_model
[0m18:53:10.401415 [info ] [Thread-1  ]: 3 of 3 START sql view model timothy_chan.my_second_dbt_model ................... [RUN]
[0m18:53:10.403249 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.my_first_dbt_model, now model.tipico.my_second_dbt_model)
[0m18:53:10.404193 [debug] [Thread-1  ]: Began compiling node model.tipico.my_second_dbt_model
[0m18:53:10.411199 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_second_dbt_model"
[0m18:53:10.412587 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (compile): 18:53:10.404753 => 18:53:10.412119
[0m18:53:10.413335 [debug] [Thread-1  ]: Began executing node model.tipico.my_second_dbt_model
[0m18:53:10.447922 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_second_dbt_model"
[0m18:53:10.449649 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:53:10.450159 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m18:53:10.450626 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:53:10.451292 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:53:10.451805 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:53:10.748694 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:10.751424 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:53:10.753769 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */


  create view "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."timothy_chan"."my_first_dbt_model"
where id = 1
  ) ;
[0m18:53:10.861641 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:10.877316 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:53:10.878386 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
alter table "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:53:10.941640 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:10.949531 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m18:53:10.950983 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:53:10.951885 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m18:53:11.544145 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:53:11.548106 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:53:11.549956 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m18:53:11.594587 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:11.607790 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_second_dbt_model__dbt_backup"
[0m18:53:11.611046 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:53:11.611993 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
drop view if exists "dev"."timothy_chan"."my_second_dbt_model__dbt_backup" cascade
[0m18:53:11.657775 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:11.662106 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m18:53:11.663835 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:53:11.665138 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m18:53:11.690365 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:11.692251 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:53:11.693345 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m18:53:11.713931 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:11.717781 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (execute): 18:53:10.413776 => 18:53:11.717081
[0m18:53:11.718827 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: ROLLBACK
[0m18:53:11.767147 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: Close
[0m18:53:11.772354 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5514623d-85d0-4339-bb45-73642f7fc4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a7f1130>]}
[0m18:53:11.774895 [info ] [Thread-1  ]: 3 of 3 OK created sql view model timothy_chan.my_second_dbt_model .............. [[32mSUCCESS[0m in 1.37s]
[0m18:53:11.777086 [debug] [Thread-1  ]: Finished running node model.tipico.my_second_dbt_model
[0m18:53:11.780255 [debug] [MainThread]: Using redshift connection "master"
[0m18:53:11.781050 [debug] [MainThread]: On master: BEGIN
[0m18:53:11.781766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:53:11.782814 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:53:11.783603 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:53:12.081715 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:12.084226 [debug] [MainThread]: On master: COMMIT
[0m18:53:12.086473 [debug] [MainThread]: Using redshift connection "master"
[0m18:53:12.087892 [debug] [MainThread]: On master: COMMIT
[0m18:53:12.132313 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:53:12.134913 [debug] [MainThread]: On master: Close
[0m18:53:12.139814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:12.141402 [debug] [MainThread]: Connection 'model.tipico.my_second_dbt_model' was properly closed.
[0m18:53:12.142749 [info ] [MainThread]: 
[0m18:53:12.143688 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 7.43 seconds (7.43s).
[0m18:53:12.146165 [debug] [MainThread]: Command end result
[0m18:53:12.167814 [info ] [MainThread]: 
[0m18:53:12.168540 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:53:12.169035 [info ] [MainThread]: 
[0m18:53:12.169582 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:53:12.173963 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.330475, "process_user_time": 4.584643, "process_kernel_time": 0.392229, "process_mem_max_rss": "129703936", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:53:12.174898 [debug] [MainThread]: Command `dbt run` succeeded at 18:53:12.174698 after 8.33 seconds
[0m18:53:12.175521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc29146730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a82ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a82ee50>]}
[0m18:53:12.176134 [debug] [MainThread]: Flushing usage events
[0m18:55:32.514352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd78e0f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd89f55a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd89f4a8e0>]}


============================== 18:55:32.520525 | 1afb46a8-9638-4ae6-9ebc-2f1371cf6b76 ==============================
[0m18:55:32.520525 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:55:32.521306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tim/tipico/logs', 'version_check': 'True', 'profiles_dir': '/Users/tim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:55:33.028356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1afb46a8-9638-4ae6-9ebc-2f1371cf6b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd8a15c880>]}
[0m18:55:33.148305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1afb46a8-9638-4ae6-9ebc-2f1371cf6b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5803ba60>]}
[0m18:55:33.149790 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m18:55:33.164349 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m18:55:33.227604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:55:33.228155 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:55:33.237491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1afb46a8-9638-4ae6-9ebc-2f1371cf6b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd79de90d0>]}
[0m18:55:33.252463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1afb46a8-9638-4ae6-9ebc-2f1371cf6b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd8a2d1fd0>]}
[0m18:55:33.253106 [info ] [MainThread]: Found 4 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m18:55:33.253600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1afb46a8-9638-4ae6-9ebc-2f1371cf6b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd8a2d1e80>]}
[0m18:55:33.255816 [info ] [MainThread]: 
[0m18:55:33.256857 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:55:33.258636 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:55:33.282102 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:55:33.282593 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m18:55:33.283017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:33.287357 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:55:33.287835 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:55:33.783675 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:33.792328 [debug] [ThreadPool]: On list_dev: Close
[0m18:55:33.797357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m18:55:33.815850 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:55:33.816489 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m18:55:33.817014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:33.817832 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:55:33.818402 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:55:34.145321 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:34.147678 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:55:34.149562 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m18:55:34.214172 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:34.221872 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m18:55:34.272653 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m18:55:34.303628 [debug] [MainThread]: Using redshift connection "master"
[0m18:55:34.304414 [debug] [MainThread]: On master: BEGIN
[0m18:55:34.305022 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:34.305800 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:55:34.306364 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:55:34.606251 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:34.608673 [debug] [MainThread]: Using redshift connection "master"
[0m18:55:34.609874 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:55:34.704893 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:34.714038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1afb46a8-9638-4ae6-9ebc-2f1371cf6b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd79da8cd0>]}
[0m18:55:34.715440 [debug] [MainThread]: On master: ROLLBACK
[0m18:55:34.777877 [debug] [MainThread]: Using redshift connection "master"
[0m18:55:34.779941 [debug] [MainThread]: On master: BEGIN
[0m18:55:34.802149 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:34.803532 [debug] [MainThread]: On master: COMMIT
[0m18:55:34.804923 [debug] [MainThread]: Using redshift connection "master"
[0m18:55:34.805880 [debug] [MainThread]: On master: COMMIT
[0m18:55:34.846122 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:34.847989 [debug] [MainThread]: On master: Close
[0m18:55:34.851567 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:55:34.852493 [info ] [MainThread]: 
[0m18:55:34.858910 [debug] [Thread-1  ]: Began running node model.tipico.group
[0m18:55:34.860164 [info ] [Thread-1  ]: 1 of 4 START sql table model timothy_chan.group ................................ [RUN]
[0m18:55:34.861986 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.group)
[0m18:55:34.862954 [debug] [Thread-1  ]: Began compiling node model.tipico.group
[0m18:55:34.869733 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.group"
[0m18:55:34.871553 [debug] [Thread-1  ]: Timing info for model.tipico.group (compile): 18:55:34.863528 => 18:55:34.871019
[0m18:55:34.872292 [debug] [Thread-1  ]: Began executing node model.tipico.group
[0m18:55:34.944567 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.group"
[0m18:55:34.947124 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:55:34.947629 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:55:34.948086 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:34.948717 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:55:34.949211 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:55:35.227506 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:35.230200 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:55:35.232282 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */

  
    

  create  table
    "dev"."timothy_chan"."group__dbt_tmp"
    
    
    
  as (
    

with group_data as (
    select 
    3686 as id
    ,'Argentina - Primera Nacional' as name
    ,207 as parent_group_country_id
    ,'Argentina' as parent_group_country_name
    ,11 as parent_group_sports_id
    ,'Soccer' as parent_group_sports_name
)
select *
from group_data
  );
[0m18:55:35.315821 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:35.338293 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:55:35.339186 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group" rename to "group__dbt_backup"
[0m18:55:35.462162 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:35.478297 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:55:35.479334 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group__dbt_tmp" rename to "group"
[0m18:55:35.556355 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:35.604300 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:55:35.605000 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:55:35.605536 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:55:36.117621 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:55:36.121062 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:55:36.122500 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:55:36.167154 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:36.187884 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."group__dbt_backup"
[0m18:55:36.197924 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:55:36.198603 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
drop table if exists "dev"."timothy_chan"."group__dbt_backup" cascade
[0m18:55:36.240399 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:36.242662 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:55:36.243701 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:55:36.244555 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:55:36.717843 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:36.720757 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:55:36.722305 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:55:36.745027 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:36.749937 [debug] [Thread-1  ]: Timing info for model.tipico.group (execute): 18:55:34.872752 => 18:55:36.749282
[0m18:55:36.751087 [debug] [Thread-1  ]: On model.tipico.group: ROLLBACK
[0m18:55:36.794707 [debug] [Thread-1  ]: On model.tipico.group: Close
[0m18:55:36.799483 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afb46a8-9638-4ae6-9ebc-2f1371cf6b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd8a43b2b0>]}
[0m18:55:36.802862 [info ] [Thread-1  ]: 1 of 4 OK created sql table model timothy_chan.group ........................... [[32mSUCCESS[0m in 1.94s]
[0m18:55:36.804404 [debug] [Thread-1  ]: Finished running node model.tipico.group
[0m18:55:36.805417 [debug] [Thread-1  ]: Began running node model.tipico.my_first_dbt_model
[0m18:55:36.806665 [info ] [Thread-1  ]: 2 of 4 START sql table model timothy_chan.my_first_dbt_model ................... [RUN]
[0m18:55:36.808430 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.group, now model.tipico.my_first_dbt_model)
[0m18:55:36.809386 [debug] [Thread-1  ]: Began compiling node model.tipico.my_first_dbt_model
[0m18:55:36.816659 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_first_dbt_model"
[0m18:55:36.818059 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (compile): 18:55:36.809948 => 18:55:36.817584
[0m18:55:36.818806 [debug] [Thread-1  ]: Began executing node model.tipico.my_first_dbt_model
[0m18:55:36.828533 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_first_dbt_model"
[0m18:55:36.831222 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:55:36.831855 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m18:55:36.832442 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:36.833283 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:55:36.833932 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:55:37.140939 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:37.143700 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:55:37.145377 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */

  
    

  create  table
    "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 
    1 as id
    ,'Dougherty K' as participants 
)
select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:55:37.225323 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:37.241693 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:55:37.242743 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
alter table "dev"."timothy_chan"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:55:37.366125 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:37.383539 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:55:37.384421 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
alter table "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:55:37.445746 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:37.455200 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m18:55:37.456304 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:55:37.457174 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m18:55:37.876402 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:37.880124 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:55:37.882011 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m18:55:37.925529 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:37.939016 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_first_dbt_model__dbt_backup"
[0m18:55:37.944803 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:55:37.945763 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */
drop table if exists "dev"."timothy_chan"."my_first_dbt_model__dbt_backup" cascade
[0m18:55:37.990672 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:37.994166 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m18:55:37.995430 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:55:37.996371 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: COMMIT
[0m18:55:38.524276 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:55:38.526833 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:55:38.528200 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m18:55:38.547938 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:38.551853 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (execute): 18:55:36.819254 => 18:55:38.551095
[0m18:55:38.553000 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: ROLLBACK
[0m18:55:38.594457 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: Close
[0m18:55:38.599603 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afb46a8-9638-4ae6-9ebc-2f1371cf6b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd48013550>]}
[0m18:55:38.602445 [info ] [Thread-1  ]: 2 of 4 OK created sql table model timothy_chan.my_first_dbt_model .............. [[32mSUCCESS[0m in 1.79s]
[0m18:55:38.604448 [debug] [Thread-1  ]: Finished running node model.tipico.my_first_dbt_model
[0m18:55:38.605514 [debug] [Thread-1  ]: Began running node model.tipico.participant
[0m18:55:38.606759 [info ] [Thread-1  ]: 3 of 4 START sql table model timothy_chan.participant .......................... [RUN]
[0m18:55:38.608658 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.my_first_dbt_model, now model.tipico.participant)
[0m18:55:38.609613 [debug] [Thread-1  ]: Began compiling node model.tipico.participant
[0m18:55:38.616650 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.participant"
[0m18:55:38.617953 [debug] [Thread-1  ]: Timing info for model.tipico.participant (compile): 18:55:38.610174 => 18:55:38.617503
[0m18:55:38.618672 [debug] [Thread-1  ]: Began executing node model.tipico.participant
[0m18:55:38.628638 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.participant"
[0m18:55:38.631726 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:55:38.632352 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m18:55:38.632941 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:38.633770 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:55:38.634404 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:55:38.924052 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:38.926825 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:55:38.928654 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */

  
    

  create  table
    "dev"."timothy_chan"."participant__dbt_tmp"
    
    
    
  as (
    

with participant as (
    select 
    35458 as id
    ,'George Washington ' as name
    ,'HOME' as position
    ,'GEO' as abbreviation
)
select *
from participant
  );
[0m18:55:42.090842 [debug] [Thread-1  ]: SQL status: SUCCESS in 3.0 seconds
[0m18:55:42.104766 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:55:42.105850 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
alter table "dev"."timothy_chan"."participant__dbt_tmp" rename to "participant"
[0m18:55:42.234257 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:42.244747 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m18:55:42.245856 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:55:42.246733 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m18:55:42.675666 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:42.679316 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:55:42.680749 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m18:55:42.721491 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:42.734702 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."participant__dbt_backup"
[0m18:55:42.738142 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:55:42.739119 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
drop table if exists "dev"."timothy_chan"."participant__dbt_backup" cascade
[0m18:55:42.782894 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:42.786698 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m18:55:42.788003 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:55:42.788871 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m18:55:42.815812 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:42.817463 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:55:42.818529 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m18:55:42.842938 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:42.848015 [debug] [Thread-1  ]: Timing info for model.tipico.participant (execute): 18:55:38.619105 => 18:55:42.847060
[0m18:55:42.849541 [debug] [Thread-1  ]: On model.tipico.participant: ROLLBACK
[0m18:55:42.893574 [debug] [Thread-1  ]: On model.tipico.participant: Close
[0m18:55:42.898650 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afb46a8-9638-4ae6-9ebc-2f1371cf6b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd8a4b5940>]}
[0m18:55:42.901255 [info ] [Thread-1  ]: 3 of 4 OK created sql table model timothy_chan.participant ..................... [[32mSUCCESS[0m in 4.29s]
[0m18:55:42.903635 [debug] [Thread-1  ]: Finished running node model.tipico.participant
[0m18:55:42.904792 [debug] [Thread-1  ]: Began running node model.tipico.my_second_dbt_model
[0m18:55:42.906018 [info ] [Thread-1  ]: 4 of 4 START sql view model timothy_chan.my_second_dbt_model ................... [RUN]
[0m18:55:42.907835 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.participant, now model.tipico.my_second_dbt_model)
[0m18:55:42.908769 [debug] [Thread-1  ]: Began compiling node model.tipico.my_second_dbt_model
[0m18:55:42.916016 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_second_dbt_model"
[0m18:55:42.917460 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (compile): 18:55:42.909330 => 18:55:42.916981
[0m18:55:42.918240 [debug] [Thread-1  ]: Began executing node model.tipico.my_second_dbt_model
[0m18:55:42.954687 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_second_dbt_model"
[0m18:55:42.956398 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:55:42.956895 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m18:55:42.957355 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:42.957982 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:55:42.958469 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:55:43.256774 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:43.259401 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:55:43.261505 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */


  create view "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."timothy_chan"."my_first_dbt_model"
where id = 1
  ) ;
[0m18:55:43.370720 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:43.384981 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:55:43.385993 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
alter table "dev"."timothy_chan"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:55:43.449645 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:43.457608 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m18:55:43.458790 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:55:43.459655 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m18:55:43.948218 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:43.952095 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:55:43.953548 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m18:55:43.997346 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:44.011125 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."my_second_dbt_model__dbt_backup"
[0m18:55:44.019813 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:55:44.020818 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_second_dbt_model"} */
drop view if exists "dev"."timothy_chan"."my_second_dbt_model__dbt_backup" cascade
[0m18:55:44.064082 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:44.067408 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m18:55:44.068793 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:55:44.069798 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: COMMIT
[0m18:55:44.094491 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:44.096241 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_second_dbt_model"
[0m18:55:44.097193 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: BEGIN
[0m18:55:44.115458 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:44.118520 [debug] [Thread-1  ]: Timing info for model.tipico.my_second_dbt_model (execute): 18:55:42.918675 => 18:55:44.117870
[0m18:55:44.119566 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: ROLLBACK
[0m18:55:44.162414 [debug] [Thread-1  ]: On model.tipico.my_second_dbt_model: Close
[0m18:55:44.165655 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afb46a8-9638-4ae6-9ebc-2f1371cf6b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd7a011eb0>]}
[0m18:55:44.167585 [info ] [Thread-1  ]: 4 of 4 OK created sql view model timothy_chan.my_second_dbt_model .............. [[32mSUCCESS[0m in 1.26s]
[0m18:55:44.169522 [debug] [Thread-1  ]: Finished running node model.tipico.my_second_dbt_model
[0m18:55:44.173864 [debug] [MainThread]: Using redshift connection "master"
[0m18:55:44.174664 [debug] [MainThread]: On master: BEGIN
[0m18:55:44.175366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:55:44.176355 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:55:44.177132 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:55:44.474836 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:44.477596 [debug] [MainThread]: On master: COMMIT
[0m18:55:44.479973 [debug] [MainThread]: Using redshift connection "master"
[0m18:55:44.480944 [debug] [MainThread]: On master: COMMIT
[0m18:55:44.525521 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:55:44.527445 [debug] [MainThread]: On master: Close
[0m18:55:44.531927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:44.533112 [debug] [MainThread]: Connection 'model.tipico.my_second_dbt_model' was properly closed.
[0m18:55:44.534932 [info ] [MainThread]: 
[0m18:55:44.536459 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 11.28 seconds (11.28s).
[0m18:55:44.539284 [debug] [MainThread]: Command end result
[0m18:55:44.560643 [info ] [MainThread]: 
[0m18:55:44.561367 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:44.561935 [info ] [MainThread]: 
[0m18:55:44.562546 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:55:44.567269 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.18909, "process_user_time": 4.71872, "process_kernel_time": 0.393954, "process_mem_max_rss": "130441216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:55:44.568381 [debug] [MainThread]: Command `dbt run` succeeded at 18:55:44.568130 after 12.19 seconds
[0m18:55:44.569007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd78e0f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd8a2b20a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd79e0fe20>]}
[0m18:55:44.569601 [debug] [MainThread]: Flushing usage events
[0m18:57:54.340975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1216b0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1224ca6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1224e1850>]}


============================== 18:57:54.347197 | f97ca9a6-22fb-459b-8246-0d0eb5d0ef65 ==============================
[0m18:57:54.347197 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:57:54.347977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tim/tipico/logs', 'profiles_dir': '/Users/tim/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:57:54.854442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f97ca9a6-22fb-459b-8246-0d0eb5d0ef65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1224ca6d0>]}
[0m18:57:54.974931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f97ca9a6-22fb-459b-8246-0d0eb5d0ef65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1318f3be0>]}
[0m18:57:54.977007 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m18:57:54.991283 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m18:57:55.047144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:57:55.047691 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:57:55.057020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f97ca9a6-22fb-459b-8246-0d0eb5d0ef65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc131bd70d0>]}
[0m18:57:55.070842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f97ca9a6-22fb-459b-8246-0d0eb5d0ef65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc131ae88b0>]}
[0m18:57:55.071472 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m18:57:55.071940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f97ca9a6-22fb-459b-8246-0d0eb5d0ef65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc131ae8940>]}
[0m18:57:55.074137 [info ] [MainThread]: 
[0m18:57:55.075157 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:57:55.077023 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:57:55.101062 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:57:55.101555 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m18:57:55.101983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:55.106336 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:57:55.106821 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:57:55.555968 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:55.564107 [debug] [ThreadPool]: On list_dev: Close
[0m18:57:55.568515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m18:57:55.585976 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:57:55.586692 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m18:57:55.587210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:55.587973 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:57:55.588518 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:57:55.886737 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:55.888821 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:57:55.889809 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m18:57:55.946358 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:55.952047 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m18:57:55.995805 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m18:57:56.022895 [debug] [MainThread]: Using redshift connection "master"
[0m18:57:56.023611 [debug] [MainThread]: On master: BEGIN
[0m18:57:56.024200 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:56.025050 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:57:56.025683 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:57:56.328098 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:56.330515 [debug] [MainThread]: Using redshift connection "master"
[0m18:57:56.332370 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:57:56.424709 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:56.431191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f97ca9a6-22fb-459b-8246-0d0eb5d0ef65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12265ea30>]}
[0m18:57:56.432783 [debug] [MainThread]: On master: ROLLBACK
[0m18:57:56.490585 [debug] [MainThread]: Using redshift connection "master"
[0m18:57:56.492725 [debug] [MainThread]: On master: BEGIN
[0m18:57:56.513897 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:56.515711 [debug] [MainThread]: On master: COMMIT
[0m18:57:56.517640 [debug] [MainThread]: Using redshift connection "master"
[0m18:57:56.519167 [debug] [MainThread]: On master: COMMIT
[0m18:57:56.562127 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:56.564353 [debug] [MainThread]: On master: Close
[0m18:57:56.568364 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:57:56.569555 [info ] [MainThread]: 
[0m18:57:56.579117 [debug] [Thread-1  ]: Began running node model.tipico.group
[0m18:57:56.580383 [info ] [Thread-1  ]: 1 of 4 START sql table model timothy_chan.group ................................ [RUN]
[0m18:57:56.582146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.group)
[0m18:57:56.583065 [debug] [Thread-1  ]: Began compiling node model.tipico.group
[0m18:57:56.589332 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.group"
[0m18:57:56.590937 [debug] [Thread-1  ]: Timing info for model.tipico.group (compile): 18:57:56.583611 => 18:57:56.590442
[0m18:57:56.591685 [debug] [Thread-1  ]: Began executing node model.tipico.group
[0m18:57:56.663392 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.group"
[0m18:57:56.665985 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:57:56.666480 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:57:56.666932 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:57:56.667568 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:57:56.668055 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:57:56.967140 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:56.969677 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:57:56.972004 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */

  
    

  create  table
    "dev"."timothy_chan"."group__dbt_tmp"
    
    
    
  as (
    

with group_data as (
    select 
    3686 as id
    ,'Argentina - Primera Nacional' as name
    ,207 as parent_group_country_id
    ,'Argentina' as parent_group_country_name
    ,11 as parent_group_sports_id
    ,'Soccer' as parent_group_sports_name
)
select *
from group_data
  );
[0m18:57:57.052843 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:57.075825 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:57:57.076716 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group__dbt_tmp" rename to "group"
[0m18:57:57.196831 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:57.244645 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:57:57.245382 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:57:57.245918 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:57:57.748877 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:57:57.752560 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:57:57.754442 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:57:57.796141 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:57.815191 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."group__dbt_backup"
[0m18:57:57.824465 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:57:57.825165 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
drop table if exists "dev"."timothy_chan"."group__dbt_backup" cascade
[0m18:57:57.864507 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:57.866647 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:57:57.867491 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:57:57.868188 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:57:57.893921 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:57.894935 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:57:57.895761 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:57:57.916367 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:57.919820 [debug] [Thread-1  ]: Timing info for model.tipico.group (execute): 18:57:56.592138 => 18:57:57.919165
[0m18:57:57.920804 [debug] [Thread-1  ]: On model.tipico.group: ROLLBACK
[0m18:57:57.962685 [debug] [Thread-1  ]: On model.tipico.group: Close
[0m18:57:57.966369 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f97ca9a6-22fb-459b-8246-0d0eb5d0ef65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1000080d0>]}
[0m18:57:57.969286 [info ] [Thread-1  ]: 1 of 4 OK created sql table model timothy_chan.group ........................... [[32mSUCCESS[0m in 1.38s]
[0m18:57:57.971417 [debug] [Thread-1  ]: Finished running node model.tipico.group
[0m18:57:57.972545 [debug] [Thread-1  ]: Began running node model.tipico.my_first_dbt_model
[0m18:57:57.973858 [info ] [Thread-1  ]: 2 of 4 START sql table model timothy_chan.my_first_dbt_model ................... [RUN]
[0m18:57:57.975743 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.group, now model.tipico.my_first_dbt_model)
[0m18:57:57.976699 [debug] [Thread-1  ]: Began compiling node model.tipico.my_first_dbt_model
[0m18:57:57.987210 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.my_first_dbt_model"
[0m18:57:57.988629 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (compile): 18:57:57.977264 => 18:57:57.988143
[0m18:57:57.989364 [debug] [Thread-1  ]: Began executing node model.tipico.my_first_dbt_model
[0m18:57:57.999031 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.my_first_dbt_model"
[0m18:57:58.001144 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:57:58.001806 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: BEGIN
[0m18:57:58.002411 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:57:58.003280 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:57:58.003851 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:57:58.297380 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:58.300261 [debug] [Thread-1  ]: Using redshift connection "model.tipico.my_first_dbt_model"
[0m18:57:58.302378 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.my_first_dbt_model"} */

  
    

  create  table
    "dev"."timothy_chan"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/

-- 

-- with source_data as (

--     select 
--     1 as id
--     ,'Dougherty K' as participants 
-- )
-- select *
-- from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:57:58.326979 [debug] [Thread-1  ]: Redshift adapter: Redshift error: syntax error at or near ")"
[0m18:57:58.329232 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: ROLLBACK
[0m18:57:58.369722 [debug] [Thread-1  ]: Timing info for model.tipico.my_first_dbt_model (execute): 18:57:57.989805 => 18:57:58.367983
[0m18:57:58.372210 [debug] [Thread-1  ]: On model.tipico.my_first_dbt_model: Close
[0m18:57:58.381452 [debug] [Thread-1  ]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  syntax error at or near ")"
  compiled Code at target/run/tipico/models/example/my_first_dbt_model.sql
[0m18:57:58.382603 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f97ca9a6-22fb-459b-8246-0d0eb5d0ef65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc131ae80a0>]}
[0m18:57:58.384055 [error] [Thread-1  ]: 2 of 4 ERROR creating sql table model timothy_chan.my_first_dbt_model .......... [[31mERROR[0m in 0.41s]
[0m18:57:58.385525 [debug] [Thread-1  ]: Finished running node model.tipico.my_first_dbt_model
[0m18:57:58.386536 [debug] [Thread-1  ]: Began running node model.tipico.participant
[0m18:57:58.387806 [info ] [Thread-1  ]: 3 of 4 START sql table model timothy_chan.participant .......................... [RUN]
[0m18:57:58.389607 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.my_first_dbt_model, now model.tipico.participant)
[0m18:57:58.390474 [debug] [Thread-1  ]: Began compiling node model.tipico.participant
[0m18:57:58.398020 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.participant"
[0m18:57:58.399359 [debug] [Thread-1  ]: Timing info for model.tipico.participant (compile): 18:57:58.390914 => 18:57:58.398896
[0m18:57:58.400082 [debug] [Thread-1  ]: Began executing node model.tipico.participant
[0m18:57:58.409108 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.participant"
[0m18:57:58.411709 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:57:58.412246 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m18:57:58.412747 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:57:58.413467 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:57:58.414011 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:57:58.716314 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:58.719184 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:57:58.721246 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */

  
    

  create  table
    "dev"."timothy_chan"."participant__dbt_tmp"
    
    
    
  as (
    

with participant as (
    select 
    35458 as id
    ,'George Washington ' as name
    ,'HOME' as position
    ,'GEO' as abbreviation
)
select *
from participant
  );
[0m18:57:58.884157 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:58.898777 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:57:58.899834 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
alter table "dev"."timothy_chan"."participant__dbt_tmp" rename to "participant"
[0m18:57:59.028155 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:59.037144 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m18:57:59.038261 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:57:59.039116 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m18:57:59.588606 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m18:57:59.592949 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:57:59.594629 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m18:57:59.636741 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:59.650891 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."participant__dbt_backup"
[0m18:57:59.654206 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:57:59.655155 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
drop table if exists "dev"."timothy_chan"."participant__dbt_backup" cascade
[0m18:57:59.701415 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:59.705916 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m18:57:59.707645 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:57:59.709078 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m18:57:59.732727 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:59.734102 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:57:59.735192 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m18:57:59.760884 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:57:59.765169 [debug] [Thread-1  ]: Timing info for model.tipico.participant (execute): 18:57:58.400490 => 18:57:59.764422
[0m18:57:59.766233 [debug] [Thread-1  ]: On model.tipico.participant: ROLLBACK
[0m18:57:59.805400 [debug] [Thread-1  ]: On model.tipico.participant: Close
[0m18:57:59.810092 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f97ca9a6-22fb-459b-8246-0d0eb5d0ef65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc131ae8400>]}
[0m18:57:59.812344 [info ] [Thread-1  ]: 3 of 4 OK created sql table model timothy_chan.participant ..................... [[32mSUCCESS[0m in 1.42s]
[0m18:57:59.814474 [debug] [Thread-1  ]: Finished running node model.tipico.participant
[0m18:57:59.815809 [debug] [Thread-1  ]: Began running node model.tipico.my_second_dbt_model
[0m18:57:59.817161 [info ] [Thread-1  ]: 4 of 4 SKIP relation timothy_chan.my_second_dbt_model .......................... [[33mSKIP[0m]
[0m18:57:59.818330 [debug] [Thread-1  ]: Finished running node model.tipico.my_second_dbt_model
[0m18:57:59.821419 [debug] [MainThread]: Using redshift connection "master"
[0m18:57:59.822200 [debug] [MainThread]: On master: BEGIN
[0m18:57:59.822919 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:57:59.823990 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:57:59.824779 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:58:00.112423 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:00.115245 [debug] [MainThread]: On master: COMMIT
[0m18:58:00.117978 [debug] [MainThread]: Using redshift connection "master"
[0m18:58:00.119366 [debug] [MainThread]: On master: COMMIT
[0m18:58:00.164354 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:00.167090 [debug] [MainThread]: On master: Close
[0m18:58:00.171427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:00.172497 [debug] [MainThread]: Connection 'model.tipico.participant' was properly closed.
[0m18:58:00.173800 [info ] [MainThread]: 
[0m18:58:00.175506 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 5.10 seconds (5.10s).
[0m18:58:00.178235 [debug] [MainThread]: Command end result
[0m18:58:00.203536 [info ] [MainThread]: 
[0m18:58:00.204299 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:58:00.204842 [info ] [MainThread]: 
[0m18:58:00.205402 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  syntax error at or near ")"
  compiled Code at target/run/tipico/models/example/my_first_dbt_model.sql
[0m18:58:00.205951 [info ] [MainThread]: 
[0m18:58:00.206538 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m18:58:00.210714 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.005523, "process_user_time": 4.456262, "process_kernel_time": 0.383718, "process_mem_max_rss": "125030400", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:58:00.211646 [debug] [MainThread]: Command `dbt run` failed at 18:58:00.211443 after 6.01 seconds
[0m18:58:00.212286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1216b0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc131c49220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc131c49160>]}
[0m18:58:00.212879 [debug] [MainThread]: Flushing usage events
[0m18:58:30.457817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a1310e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59194ad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5919482e0>]}


============================== 18:58:30.464170 | 9171ee24-4b9f-47fe-a58f-462df014bba8 ==============================
[0m18:58:30.464170 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:58:30.464963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tim/tipico/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:58:30.870326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9171ee24-4b9f-47fe-a58f-462df014bba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb591934af0>]}
[0m18:58:30.989713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9171ee24-4b9f-47fe-a58f-462df014bba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59191a700>]}
[0m18:58:30.991693 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m18:58:31.006072 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m18:58:31.061182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:58:31.061747 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:58:31.070883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9171ee24-4b9f-47fe-a58f-462df014bba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5802350d0>]}
[0m18:58:31.084710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9171ee24-4b9f-47fe-a58f-462df014bba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58015fd60>]}
[0m18:58:31.085360 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m18:58:31.085842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9171ee24-4b9f-47fe-a58f-462df014bba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58015fc70>]}
[0m18:58:31.087871 [info ] [MainThread]: 
[0m18:58:31.088903 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:58:31.090422 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:58:31.114561 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:58:31.115050 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m18:58:31.115484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:31.119828 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:58:31.120306 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:58:31.562096 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:31.570111 [debug] [ThreadPool]: On list_dev: Close
[0m18:58:31.574387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m18:58:31.592338 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:58:31.593062 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m18:58:31.593633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:31.594423 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:58:31.594965 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:58:31.892488 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:31.894800 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m18:58:31.896619 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m18:58:31.956489 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:31.963060 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m18:58:32.012043 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m18:58:32.039607 [debug] [MainThread]: Using redshift connection "master"
[0m18:58:32.040374 [debug] [MainThread]: On master: BEGIN
[0m18:58:32.040980 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:32.041829 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:58:32.042468 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:58:32.339981 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:32.342430 [debug] [MainThread]: Using redshift connection "master"
[0m18:58:32.344417 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:58:32.433373 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:32.440452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9171ee24-4b9f-47fe-a58f-462df014bba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a25396d0>]}
[0m18:58:32.442230 [debug] [MainThread]: On master: ROLLBACK
[0m18:58:32.501783 [debug] [MainThread]: Using redshift connection "master"
[0m18:58:32.503698 [debug] [MainThread]: On master: BEGIN
[0m18:58:32.527406 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:32.528754 [debug] [MainThread]: On master: COMMIT
[0m18:58:32.530189 [debug] [MainThread]: Using redshift connection "master"
[0m18:58:32.531291 [debug] [MainThread]: On master: COMMIT
[0m18:58:32.573357 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:32.575129 [debug] [MainThread]: On master: Close
[0m18:58:32.578553 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:58:32.579914 [info ] [MainThread]: 
[0m18:58:32.590077 [debug] [Thread-1  ]: Began running node model.tipico.group
[0m18:58:32.591409 [info ] [Thread-1  ]: 1 of 2 START sql table model timothy_chan.group ................................ [RUN]
[0m18:58:32.593148 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.group)
[0m18:58:32.593932 [debug] [Thread-1  ]: Began compiling node model.tipico.group
[0m18:58:32.600274 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.group"
[0m18:58:32.601764 [debug] [Thread-1  ]: Timing info for model.tipico.group (compile): 18:58:32.594411 => 18:58:32.601266
[0m18:58:32.602522 [debug] [Thread-1  ]: Began executing node model.tipico.group
[0m18:58:32.674520 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.group"
[0m18:58:32.677175 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:58:32.677669 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:58:32.678139 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:58:32.678806 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:58:32.679300 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:58:32.976029 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:32.978678 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:58:32.980718 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */

  
    

  create  table
    "dev"."timothy_chan"."group__dbt_tmp"
    
    
    
  as (
    

with group_data as (
    select 
    3686 as id
    ,'Argentina - Primera Nacional' as name
    ,207 as parent_group_country_id
    ,'Argentina' as parent_group_country_name
    ,11 as parent_group_sports_id
    ,'Soccer' as parent_group_sports_name
)
select *
from group_data
  );
[0m18:58:33.061890 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:33.085482 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:58:33.086413 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group" rename to "group__dbt_backup"
[0m18:58:33.207902 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:33.221586 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:58:33.222568 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group__dbt_tmp" rename to "group"
[0m18:58:33.287932 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:33.334836 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:58:33.335512 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:58:33.335982 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:58:33.815854 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:33.820466 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:58:33.821652 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:58:33.863927 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:33.889321 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."group__dbt_backup"
[0m18:58:33.899762 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:58:33.900458 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
drop table if exists "dev"."timothy_chan"."group__dbt_backup" cascade
[0m18:58:33.942337 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:33.944625 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:58:33.945671 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:58:33.946517 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m18:58:34.370312 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:34.373083 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m18:58:34.374952 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m18:58:34.396330 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:34.399208 [debug] [Thread-1  ]: Timing info for model.tipico.group (execute): 18:58:32.602914 => 18:58:34.398520
[0m18:58:34.400351 [debug] [Thread-1  ]: On model.tipico.group: ROLLBACK
[0m18:58:34.442451 [debug] [Thread-1  ]: On model.tipico.group: Close
[0m18:58:34.447227 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9171ee24-4b9f-47fe-a58f-462df014bba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb570023370>]}
[0m18:58:34.450501 [info ] [Thread-1  ]: 1 of 2 OK created sql table model timothy_chan.group ........................... [[32mSUCCESS[0m in 1.85s]
[0m18:58:34.452087 [debug] [Thread-1  ]: Finished running node model.tipico.group
[0m18:58:34.453137 [debug] [Thread-1  ]: Began running node model.tipico.participant
[0m18:58:34.454395 [info ] [Thread-1  ]: 2 of 2 START sql table model timothy_chan.participant .......................... [RUN]
[0m18:58:34.456339 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.group, now model.tipico.participant)
[0m18:58:34.457305 [debug] [Thread-1  ]: Began compiling node model.tipico.participant
[0m18:58:34.464384 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.participant"
[0m18:58:34.465817 [debug] [Thread-1  ]: Timing info for model.tipico.participant (compile): 18:58:34.457914 => 18:58:34.465366
[0m18:58:34.466564 [debug] [Thread-1  ]: Began executing node model.tipico.participant
[0m18:58:34.476429 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.participant"
[0m18:58:34.479244 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:58:34.479872 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m18:58:34.480460 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:58:34.481329 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:58:34.481894 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:58:34.784628 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:34.787490 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:58:34.789528 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */

  
    

  create  table
    "dev"."timothy_chan"."participant__dbt_tmp"
    
    
    
  as (
    

with participant as (
    select 
    35458 as id
    ,'George Washington ' as name
    ,'HOME' as position
    ,'GEO' as abbreviation
)
select *
from participant
  );
[0m18:58:34.874558 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:34.889021 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:58:34.890103 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
alter table "dev"."timothy_chan"."participant" rename to "participant__dbt_backup"
[0m18:58:35.017083 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:35.032368 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:58:35.033398 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
alter table "dev"."timothy_chan"."participant__dbt_tmp" rename to "participant"
[0m18:58:35.096426 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:35.106949 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m18:58:35.108081 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:58:35.108938 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m18:58:35.584370 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:35.588108 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:58:35.589299 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m18:58:35.636636 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:35.649872 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."participant__dbt_backup"
[0m18:58:35.653037 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:58:35.653929 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
drop table if exists "dev"."timothy_chan"."participant__dbt_backup" cascade
[0m18:58:35.702726 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:35.707489 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m18:58:35.708904 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:58:35.709976 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m18:58:36.112721 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:36.115585 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m18:58:36.116859 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m18:58:36.138809 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:36.142708 [debug] [Thread-1  ]: Timing info for model.tipico.participant (execute): 18:58:34.467004 => 18:58:36.142051
[0m18:58:36.143746 [debug] [Thread-1  ]: On model.tipico.participant: ROLLBACK
[0m18:58:36.187133 [debug] [Thread-1  ]: On model.tipico.participant: Close
[0m18:58:36.191868 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9171ee24-4b9f-47fe-a58f-462df014bba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a26b1940>]}
[0m18:58:36.194099 [info ] [Thread-1  ]: 2 of 2 OK created sql table model timothy_chan.participant ..................... [[32mSUCCESS[0m in 1.74s]
[0m18:58:36.195882 [debug] [Thread-1  ]: Finished running node model.tipico.participant
[0m18:58:36.199024 [debug] [MainThread]: Using redshift connection "master"
[0m18:58:36.199779 [debug] [MainThread]: On master: BEGIN
[0m18:58:36.200498 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:36.201534 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:58:36.202311 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:58:36.488054 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:36.490494 [debug] [MainThread]: On master: COMMIT
[0m18:58:36.492759 [debug] [MainThread]: Using redshift connection "master"
[0m18:58:36.494021 [debug] [MainThread]: On master: COMMIT
[0m18:58:36.539662 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:58:36.541880 [debug] [MainThread]: On master: Close
[0m18:58:36.545349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:36.546214 [debug] [MainThread]: Connection 'model.tipico.participant' was properly closed.
[0m18:58:36.547575 [info ] [MainThread]: 
[0m18:58:36.548694 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m18:58:36.550656 [debug] [MainThread]: Command end result
[0m18:58:36.572226 [info ] [MainThread]: 
[0m18:58:36.572939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:58:36.573481 [info ] [MainThread]: 
[0m18:58:36.574069 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:58:36.578558 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.2532983, "process_user_time": 4.402426, "process_kernel_time": 0.381807, "process_mem_max_rss": "130891776", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:58:36.579676 [debug] [MainThread]: Command `dbt run` succeeded at 18:58:36.579430 after 6.26 seconds
[0m18:58:36.580378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a1310e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a26b1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a26b1940>]}
[0m18:58:36.580962 [debug] [MainThread]: Flushing usage events
[0m19:03:01.396239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb46125e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb461b5fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb471ffa8e0>]}


============================== 19:03:01.402715 | ce99fe63-ba14-41f7-92f0-3e4ec0c3dcff ==============================
[0m19:03:01.402715 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:03:01.403527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tim/tipico/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:03:01.915363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce99fe63-ba14-41f7-92f0-3e4ec0c3dcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb450134880>]}
[0m19:03:02.034325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce99fe63-ba14-41f7-92f0-3e4ec0c3dcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb461c8ba60>]}
[0m19:03:02.036276 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m19:03:02.050873 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m19:03:02.114605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:03:02.115148 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:03:02.124111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce99fe63-ba14-41f7-92f0-3e4ec0c3dcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb461dc9dc0>]}
[0m19:03:02.138168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce99fe63-ba14-41f7-92f0-3e4ec0c3dcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb472334610>]}
[0m19:03:02.138805 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m19:03:02.139275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce99fe63-ba14-41f7-92f0-3e4ec0c3dcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb472334580>]}
[0m19:03:02.141270 [info ] [MainThread]: 
[0m19:03:02.142316 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m19:03:02.143797 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m19:03:02.167533 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m19:03:02.168023 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m19:03:02.168456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:02.172875 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:03:02.173357 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:03:02.668425 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:02.675981 [debug] [ThreadPool]: On list_dev: Close
[0m19:03:02.680445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m19:03:02.698541 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m19:03:02.699214 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m19:03:02.699735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:03:02.700533 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:03:02.701084 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:03:02.994075 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:02.997911 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m19:03:02.999175 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m19:03:03.060964 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:03.067353 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m19:03:03.110588 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m19:03:03.137325 [debug] [MainThread]: Using redshift connection "master"
[0m19:03:03.138145 [debug] [MainThread]: On master: BEGIN
[0m19:03:03.138768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:03:03.139634 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:03:03.140274 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:03:03.446039 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:03.447423 [debug] [MainThread]: Using redshift connection "master"
[0m19:03:03.448682 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m19:03:03.542111 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:03.545915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce99fe63-ba14-41f7-92f0-3e4ec0c3dcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb461cb8100>]}
[0m19:03:03.547251 [debug] [MainThread]: On master: ROLLBACK
[0m19:03:03.607539 [debug] [MainThread]: Using redshift connection "master"
[0m19:03:03.610174 [debug] [MainThread]: On master: BEGIN
[0m19:03:03.631581 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:03.633634 [debug] [MainThread]: On master: COMMIT
[0m19:03:03.635617 [debug] [MainThread]: Using redshift connection "master"
[0m19:03:03.637252 [debug] [MainThread]: On master: COMMIT
[0m19:03:03.680185 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:03.682239 [debug] [MainThread]: On master: Close
[0m19:03:03.686137 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:03:03.687272 [info ] [MainThread]: 
[0m19:03:03.692282 [debug] [Thread-1  ]: Began running node model.tipico.group
[0m19:03:03.694084 [info ] [Thread-1  ]: 1 of 2 START sql table model timothy_chan.group ................................ [RUN]
[0m19:03:03.695838 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.group)
[0m19:03:03.696765 [debug] [Thread-1  ]: Began compiling node model.tipico.group
[0m19:03:03.707958 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.group"
[0m19:03:03.709999 [debug] [Thread-1  ]: Timing info for model.tipico.group (compile): 19:03:03.697329 => 19:03:03.709412
[0m19:03:03.710799 [debug] [Thread-1  ]: Began executing node model.tipico.group
[0m19:03:03.783111 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.group"
[0m19:03:03.785801 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:03:03.786300 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m19:03:03.786763 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:03:03.787427 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:03:03.787925 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:03:04.069583 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:04.072091 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:03:04.073608 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */

  
    

  create  table
    "dev"."timothy_chan"."group__dbt_tmp"
    
    
    
  as (
    

with group_data as (
    select 
    3686 as id
    ,'Argentina - Primera Nacional' as name
    ,207 as parent_group_country_id
    ,'Argentina' as parent_group_country_name
    ,11 as parent_group_sports_id
    ,'Soccer' as parent_group_sports_name
)
select *
from group_data
  );
[0m19:03:04.157797 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:04.178512 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:03:04.179393 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group__dbt_tmp" rename to "group"
[0m19:03:04.299739 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:04.348857 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m19:03:04.349578 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:03:04.350112 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m19:03:04.971762 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m19:03:04.976067 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:03:04.977789 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m19:03:05.020645 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:05.041512 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."group__dbt_backup"
[0m19:03:05.051569 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:03:05.052250 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
drop table if exists "dev"."timothy_chan"."group__dbt_backup" cascade
[0m19:03:05.091149 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:05.093464 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m19:03:05.094512 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:03:05.095363 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m19:03:05.119023 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:05.120102 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:03:05.120942 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m19:03:05.140796 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:05.144579 [debug] [Thread-1  ]: Timing info for model.tipico.group (execute): 19:03:03.711280 => 19:03:05.143903
[0m19:03:05.145594 [debug] [Thread-1  ]: On model.tipico.group: ROLLBACK
[0m19:03:05.186026 [debug] [Thread-1  ]: On model.tipico.group: Close
[0m19:03:05.189997 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce99fe63-ba14-41f7-92f0-3e4ec0c3dcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb461cb8100>]}
[0m19:03:05.192731 [info ] [Thread-1  ]: 1 of 2 OK created sql table model timothy_chan.group ........................... [[32mSUCCESS[0m in 1.49s]
[0m19:03:05.194247 [debug] [Thread-1  ]: Finished running node model.tipico.group
[0m19:03:05.195267 [debug] [Thread-1  ]: Began running node model.tipico.participant
[0m19:03:05.196502 [info ] [Thread-1  ]: 2 of 2 START sql table model timothy_chan.participant .......................... [RUN]
[0m19:03:05.198270 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.group, now model.tipico.participant)
[0m19:03:05.199203 [debug] [Thread-1  ]: Began compiling node model.tipico.participant
[0m19:03:05.209345 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.participant"
[0m19:03:05.211749 [debug] [Thread-1  ]: Timing info for model.tipico.participant (compile): 19:03:05.199772 => 19:03:05.211278
[0m19:03:05.212498 [debug] [Thread-1  ]: Began executing node model.tipico.participant
[0m19:03:05.221586 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.participant"
[0m19:03:05.224213 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:03:05.224757 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m19:03:05.225274 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:03:05.226012 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:03:05.226556 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:03:05.511840 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:05.514375 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:03:05.515930 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */

  
    

  create  table
    "dev"."timothy_chan"."participant__dbt_tmp"
    
    
    
  as (
    

with participant as (
    select 
    35458 as id
    ,'George Washington ' as name
    ,'HOME' as position
    ,'GEO' as abbreviation
)
select *
from participant
  );
[0m19:03:05.597048 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:05.610632 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:03:05.611725 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
alter table "dev"."timothy_chan"."participant__dbt_tmp" rename to "participant"
[0m19:03:05.741048 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:05.749452 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m19:03:05.750552 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:03:05.751421 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m19:03:06.225224 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:06.228434 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:03:06.229746 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m19:03:06.269105 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:06.280220 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."participant__dbt_backup"
[0m19:03:06.283205 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:03:06.284117 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
drop table if exists "dev"."timothy_chan"."participant__dbt_backup" cascade
[0m19:03:06.324258 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:06.327647 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m19:03:06.328970 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:03:06.329850 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m19:03:06.361639 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:06.363627 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:03:06.364863 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m19:03:06.387900 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:06.392068 [debug] [Thread-1  ]: Timing info for model.tipico.participant (execute): 19:03:05.212930 => 19:03:06.391294
[0m19:03:06.393369 [debug] [Thread-1  ]: On model.tipico.participant: ROLLBACK
[0m19:03:06.431236 [debug] [Thread-1  ]: On model.tipico.participant: Close
[0m19:03:06.435940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce99fe63-ba14-41f7-92f0-3e4ec0c3dcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4721e2070>]}
[0m19:03:06.437915 [info ] [Thread-1  ]: 2 of 2 OK created sql table model timothy_chan.participant ..................... [[32mSUCCESS[0m in 1.24s]
[0m19:03:06.439511 [debug] [Thread-1  ]: Finished running node model.tipico.participant
[0m19:03:06.442589 [debug] [MainThread]: Using redshift connection "master"
[0m19:03:06.443392 [debug] [MainThread]: On master: BEGIN
[0m19:03:06.444099 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:03:06.445120 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:03:06.445910 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:03:06.735072 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:06.737696 [debug] [MainThread]: On master: COMMIT
[0m19:03:06.739736 [debug] [MainThread]: Using redshift connection "master"
[0m19:03:06.740947 [debug] [MainThread]: On master: COMMIT
[0m19:03:06.781957 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:03:06.784111 [debug] [MainThread]: On master: Close
[0m19:03:06.788707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:06.790008 [debug] [MainThread]: Connection 'model.tipico.participant' was properly closed.
[0m19:03:06.791465 [info ] [MainThread]: 
[0m19:03:06.793030 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.65 seconds (4.65s).
[0m19:03:06.795802 [debug] [MainThread]: Command end result
[0m19:03:06.814828 [info ] [MainThread]: 
[0m19:03:06.815629 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:03:06.816174 [info ] [MainThread]: 
[0m19:03:06.816782 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:03:06.821490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.564705, "process_user_time": 4.350909, "process_kernel_time": 0.38797, "process_mem_max_rss": "122896384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:03:06.822586 [debug] [MainThread]: Command `dbt run` succeeded at 19:03:06.822340 after 5.57 seconds
[0m19:03:06.823275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb46125e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb461dd17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb461e8c820>]}
[0m19:03:06.823965 [debug] [MainThread]: Flushing usage events
[0m19:31:10.059054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe671456730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe661b90a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe661b838e0>]}


============================== 19:31:10.065239 | 6eb70160-ec98-493c-99fa-46f7850453d5 ==============================
[0m19:31:10.065239 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:31:10.066033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tim/tipico/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:31:10.573696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6eb70160-ec98-493c-99fa-46f7850453d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe661d34880>]}
[0m19:31:10.692809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6eb70160-ec98-493c-99fa-46f7850453d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6721e3a60>]}
[0m19:31:10.694186 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m19:31:10.708574 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m19:31:10.774281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:31:10.774805 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:31:10.783959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6eb70160-ec98-493c-99fa-46f7850453d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6724a50d0>]}
[0m19:31:10.799850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6eb70160-ec98-493c-99fa-46f7850453d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6723c7f70>]}
[0m19:31:10.800494 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m19:31:10.800972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6eb70160-ec98-493c-99fa-46f7850453d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6723c7e80>]}
[0m19:31:10.803003 [info ] [MainThread]: 
[0m19:31:10.804019 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m19:31:10.805550 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m19:31:10.829091 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m19:31:10.829575 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m19:31:10.830008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:31:10.834355 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:31:10.835061 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:31:11.329457 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:11.336184 [debug] [ThreadPool]: On list_dev: Close
[0m19:31:11.340822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m19:31:11.358547 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m19:31:11.359157 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m19:31:11.359680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:31:11.360440 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:31:11.360985 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:31:11.651121 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:11.653400 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m19:31:11.655218 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m19:31:11.714187 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:11.720968 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m19:31:11.767168 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m19:31:11.794790 [debug] [MainThread]: Using redshift connection "master"
[0m19:31:11.795572 [debug] [MainThread]: On master: BEGIN
[0m19:31:11.796166 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:31:11.796972 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:31:11.797601 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:31:12.097925 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:12.100245 [debug] [MainThread]: Using redshift connection "master"
[0m19:31:12.102423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m19:31:12.193327 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:12.200570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6eb70160-ec98-493c-99fa-46f7850453d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe67219e9a0>]}
[0m19:31:12.201868 [debug] [MainThread]: On master: ROLLBACK
[0m19:31:12.270989 [debug] [MainThread]: Using redshift connection "master"
[0m19:31:12.272549 [debug] [MainThread]: On master: BEGIN
[0m19:31:12.293034 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:12.294840 [debug] [MainThread]: On master: COMMIT
[0m19:31:12.296678 [debug] [MainThread]: Using redshift connection "master"
[0m19:31:12.298399 [debug] [MainThread]: On master: COMMIT
[0m19:31:12.338733 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:12.340576 [debug] [MainThread]: On master: Close
[0m19:31:12.345709 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:31:12.347324 [info ] [MainThread]: 
[0m19:31:12.357494 [debug] [Thread-1  ]: Began running node model.tipico.group
[0m19:31:12.358782 [info ] [Thread-1  ]: 1 of 3 START sql table model timothy_chan.group ................................ [RUN]
[0m19:31:12.360495 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.group)
[0m19:31:12.361255 [debug] [Thread-1  ]: Began compiling node model.tipico.group
[0m19:31:12.367687 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.group"
[0m19:31:12.369173 [debug] [Thread-1  ]: Timing info for model.tipico.group (compile): 19:31:12.361725 => 19:31:12.368681
[0m19:31:12.369945 [debug] [Thread-1  ]: Began executing node model.tipico.group
[0m19:31:12.441155 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.group"
[0m19:31:12.443800 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:31:12.444286 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m19:31:12.444756 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:31:12.445412 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:31:12.445904 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:31:12.744452 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:12.747102 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:31:12.749117 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */

  
    

  create  table
    "dev"."timothy_chan"."group__dbt_tmp"
    
    
    
  as (
    

with group_data as (
    select 
    3686 as id
    ,'Argentina - Primera Nacional' as name
    ,207 as parent_group_country_id
    ,'Argentina' as parent_group_country_name
    ,11 as parent_group_sports_id
    ,'Soccer' as parent_group_sports_name
)
select *
from group_data
  );
[0m19:31:12.829654 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:12.852066 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:31:12.852953 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group" rename to "group__dbt_backup"
[0m19:31:12.969851 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:12.984584 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:31:12.985597 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group__dbt_tmp" rename to "group"
[0m19:31:13.045735 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:13.095713 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m19:31:13.096456 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:31:13.096989 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m19:31:13.715219 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m19:31:13.718949 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:31:13.720844 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m19:31:13.762061 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:13.783762 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."group__dbt_backup"
[0m19:31:13.793800 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:31:13.794493 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
drop table if exists "dev"."timothy_chan"."group__dbt_backup" cascade
[0m19:31:13.839181 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:13.841403 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m19:31:13.842413 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:31:13.843292 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m19:31:14.351844 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m19:31:14.354647 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:31:14.356532 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m19:31:14.380256 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:14.385812 [debug] [Thread-1  ]: Timing info for model.tipico.group (execute): 19:31:12.370394 => 19:31:14.384569
[0m19:31:14.387794 [debug] [Thread-1  ]: On model.tipico.group: ROLLBACK
[0m19:31:14.428099 [debug] [Thread-1  ]: On model.tipico.group: Close
[0m19:31:14.432829 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eb70160-ec98-493c-99fa-46f7850453d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe67255f9d0>]}
[0m19:31:14.436578 [info ] [Thread-1  ]: 1 of 3 OK created sql table model timothy_chan.group ........................... [[32mSUCCESS[0m in 2.07s]
[0m19:31:14.438555 [debug] [Thread-1  ]: Finished running node model.tipico.group
[0m19:31:14.439633 [debug] [Thread-1  ]: Began running node model.tipico.outcome
[0m19:31:14.440937 [info ] [Thread-1  ]: 2 of 3 START sql table model timothy_chan.outcome .............................. [RUN]
[0m19:31:14.442877 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.group, now model.tipico.outcome)
[0m19:31:14.443824 [debug] [Thread-1  ]: Began compiling node model.tipico.outcome
[0m19:31:14.450553 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.outcome"
[0m19:31:14.452018 [debug] [Thread-1  ]: Timing info for model.tipico.outcome (compile): 19:31:14.444381 => 19:31:14.451540
[0m19:31:14.452762 [debug] [Thread-1  ]: Began executing node model.tipico.outcome
[0m19:31:14.462259 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.outcome"
[0m19:31:14.465459 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m19:31:14.466015 [debug] [Thread-1  ]: On model.tipico.outcome: BEGIN
[0m19:31:14.466527 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:31:14.467252 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:31:14.467827 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:31:14.774501 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:14.777398 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m19:31:14.779429 [debug] [Thread-1  ]: On model.tipico.outcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.outcome"} */

  
    

  create  table
    "dev"."timothy_chan"."outcome__dbt_tmp"
    
    
    
  as (
    

with outcome as (
    select 
    '7057b856-a383-3831-8a87-5ea76f9fa317' as id
    ,'Over 23.5' as name
    ,true as isTraded
    ,1.95 as formatDecimal
    ,1.80 as formatAmerican
    ,'ONGOING' as status
    ,1.80 as trueOdds
)
select *
from outcome
  );
[0m19:31:20.742979 [debug] [Thread-1  ]: SQL status: SUCCESS in 6.0 seconds
[0m19:31:20.759964 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m19:31:20.761148 [debug] [Thread-1  ]: On model.tipico.outcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.outcome"} */
alter table "dev"."timothy_chan"."outcome__dbt_tmp" rename to "outcome"
[0m19:31:20.876855 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:20.886614 [debug] [Thread-1  ]: On model.tipico.outcome: COMMIT
[0m19:31:20.888229 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m19:31:20.889270 [debug] [Thread-1  ]: On model.tipico.outcome: COMMIT
[0m19:31:21.530221 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m19:31:21.533945 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m19:31:21.535316 [debug] [Thread-1  ]: On model.tipico.outcome: BEGIN
[0m19:31:21.579195 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:21.592155 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."outcome__dbt_backup"
[0m19:31:21.595155 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m19:31:21.596076 [debug] [Thread-1  ]: On model.tipico.outcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.outcome"} */
drop table if exists "dev"."timothy_chan"."outcome__dbt_backup" cascade
[0m19:31:21.635600 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:21.639708 [debug] [Thread-1  ]: On model.tipico.outcome: COMMIT
[0m19:31:21.640933 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m19:31:21.642134 [debug] [Thread-1  ]: On model.tipico.outcome: COMMIT
[0m19:31:21.665479 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:21.667142 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m19:31:21.668216 [debug] [Thread-1  ]: On model.tipico.outcome: BEGIN
[0m19:31:21.688293 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:21.691957 [debug] [Thread-1  ]: Timing info for model.tipico.outcome (execute): 19:31:14.453204 => 19:31:21.691132
[0m19:31:21.693119 [debug] [Thread-1  ]: On model.tipico.outcome: ROLLBACK
[0m19:31:21.737825 [debug] [Thread-1  ]: On model.tipico.outcome: Close
[0m19:31:21.742882 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eb70160-ec98-493c-99fa-46f7850453d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe67255fac0>]}
[0m19:31:21.745054 [info ] [Thread-1  ]: 2 of 3 OK created sql table model timothy_chan.outcome ......................... [[32mSUCCESS[0m in 7.30s]
[0m19:31:21.746906 [debug] [Thread-1  ]: Finished running node model.tipico.outcome
[0m19:31:21.748001 [debug] [Thread-1  ]: Began running node model.tipico.participant
[0m19:31:21.749210 [info ] [Thread-1  ]: 3 of 3 START sql table model timothy_chan.participant .......................... [RUN]
[0m19:31:21.750940 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.outcome, now model.tipico.participant)
[0m19:31:21.751854 [debug] [Thread-1  ]: Began compiling node model.tipico.participant
[0m19:31:21.759530 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.participant"
[0m19:31:21.762090 [debug] [Thread-1  ]: Timing info for model.tipico.participant (compile): 19:31:21.752398 => 19:31:21.761633
[0m19:31:21.762801 [debug] [Thread-1  ]: Began executing node model.tipico.participant
[0m19:31:21.776073 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.participant"
[0m19:31:21.778890 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:31:21.779524 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m19:31:21.780119 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:31:21.780955 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:31:21.781498 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:31:22.072793 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:22.075642 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:31:22.077672 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */

  
    

  create  table
    "dev"."timothy_chan"."participant__dbt_tmp"
    
    
    
  as (
    

with participant as (
    select 
    35458 as id
    ,'George Washington ' as name
    ,'HOME' as position
    ,'GEO' as abbreviation
)
select *
from participant
  );
[0m19:31:22.159567 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:22.177665 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:31:22.178715 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
alter table "dev"."timothy_chan"."participant" rename to "participant__dbt_backup"
[0m19:31:22.301221 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:22.313165 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:31:22.314200 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
alter table "dev"."timothy_chan"."participant__dbt_tmp" rename to "participant"
[0m19:31:22.379066 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:22.392571 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m19:31:22.393736 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:31:22.394611 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m19:31:22.915068 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m19:31:22.919039 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:31:22.920910 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m19:31:22.963712 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:22.976036 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."participant__dbt_backup"
[0m19:31:22.978960 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:31:22.979897 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
drop table if exists "dev"."timothy_chan"."participant__dbt_backup" cascade
[0m19:31:23.032960 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:23.037393 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m19:31:23.038954 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:31:23.040089 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m19:31:23.450255 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:23.453031 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:31:23.454880 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m19:31:23.475405 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:23.481010 [debug] [Thread-1  ]: Timing info for model.tipico.participant (execute): 19:31:21.763244 => 19:31:23.479759
[0m19:31:23.483046 [debug] [Thread-1  ]: On model.tipico.participant: ROLLBACK
[0m19:31:23.525660 [debug] [Thread-1  ]: On model.tipico.participant: Close
[0m19:31:23.530707 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eb70160-ec98-493c-99fa-46f7850453d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe661e200d0>]}
[0m19:31:23.533105 [info ] [Thread-1  ]: 3 of 3 OK created sql table model timothy_chan.participant ..................... [[32mSUCCESS[0m in 1.78s]
[0m19:31:23.534729 [debug] [Thread-1  ]: Finished running node model.tipico.participant
[0m19:31:23.538602 [debug] [MainThread]: Using redshift connection "master"
[0m19:31:23.539445 [debug] [MainThread]: On master: BEGIN
[0m19:31:23.540179 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:31:23.541246 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:31:23.542049 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:31:23.831941 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:23.834481 [debug] [MainThread]: On master: COMMIT
[0m19:31:23.836638 [debug] [MainThread]: Using redshift connection "master"
[0m19:31:23.838223 [debug] [MainThread]: On master: COMMIT
[0m19:31:23.881258 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:31:23.883188 [debug] [MainThread]: On master: Close
[0m19:31:23.887965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:31:23.889095 [debug] [MainThread]: Connection 'model.tipico.participant' was properly closed.
[0m19:31:23.890708 [info ] [MainThread]: 
[0m19:31:23.892130 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 13.09 seconds (13.09s).
[0m19:31:23.894585 [debug] [MainThread]: Command end result
[0m19:31:23.915238 [info ] [MainThread]: 
[0m19:31:23.915981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:31:23.916532 [info ] [MainThread]: 
[0m19:31:23.917143 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:31:23.921899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.005206, "process_user_time": 4.565095, "process_kernel_time": 0.816832, "process_mem_max_rss": "124846080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:31:23.922958 [debug] [MainThread]: Command `dbt run` succeeded at 19:31:23.922717 after 14.01 seconds
[0m19:31:23.923634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe671456730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6723c7a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6723c77f0>]}
[0m19:31:23.924270 [debug] [MainThread]: Flushing usage events
[0m19:39:56.237385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb8f90b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febca3b2190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb98de610>]}


============================== 19:39:56.243569 | ead43852-5cc9-4527-a566-d00b8053fbce ==============================
[0m19:39:56.243569 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:39:56.244352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/tim/tipico/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:39:56.784425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ead43852-5cc9-4527-a566-d00b8053fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febca5b4c40>]}
[0m19:39:56.904330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ead43852-5cc9-4527-a566-d00b8053fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febca62bc10>]}
[0m19:39:56.905783 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m19:39:56.920225 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m19:39:56.976367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:39:56.976918 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:39:56.986186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ead43852-5cc9-4527-a566-d00b8053fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb9baf0d0>]}
[0m19:39:57.001701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ead43852-5cc9-4527-a566-d00b8053fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb9ac43a0>]}
[0m19:39:57.002359 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m19:39:57.002842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ead43852-5cc9-4527-a566-d00b8053fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febca752490>]}
[0m19:39:57.005008 [info ] [MainThread]: 
[0m19:39:57.006058 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m19:39:57.007662 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m19:39:57.031442 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m19:39:57.031945 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m19:39:57.032384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:57.036772 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:39:57.037608 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:39:57.545320 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m19:39:57.553182 [debug] [ThreadPool]: On list_dev: Close
[0m19:39:57.559115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m19:39:57.577747 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m19:39:57.578494 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m19:39:57.579133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:57.579926 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:39:57.580502 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:39:57.890135 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:39:57.892522 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m19:39:57.894401 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m19:39:57.957743 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:39:57.965384 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m19:39:58.013042 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m19:39:58.042833 [debug] [MainThread]: Using redshift connection "master"
[0m19:39:58.043607 [debug] [MainThread]: On master: BEGIN
[0m19:39:58.044267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:58.045129 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:39:58.045790 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:39:58.350183 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:39:58.352859 [debug] [MainThread]: Using redshift connection "master"
[0m19:39:58.354916 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m19:39:58.445154 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:39:58.451745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ead43852-5cc9-4527-a566-d00b8053fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febca6e9160>]}
[0m19:39:58.453265 [debug] [MainThread]: On master: ROLLBACK
[0m19:39:58.515031 [debug] [MainThread]: Using redshift connection "master"
[0m19:39:58.517172 [debug] [MainThread]: On master: BEGIN
[0m19:39:58.541724 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:39:58.543909 [debug] [MainThread]: On master: COMMIT
[0m19:39:58.546027 [debug] [MainThread]: Using redshift connection "master"
[0m19:39:58.547073 [debug] [MainThread]: On master: COMMIT
[0m19:39:58.587467 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:39:58.589420 [debug] [MainThread]: On master: Close
[0m19:39:58.593332 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:39:58.594500 [info ] [MainThread]: 
[0m19:39:58.604053 [debug] [Thread-1  ]: Began running node model.tipico.group
[0m19:39:58.605329 [info ] [Thread-1  ]: 1 of 4 START sql table model timothy_chan.group ................................ [RUN]
[0m19:39:58.607104 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.group)
[0m19:39:58.608048 [debug] [Thread-1  ]: Began compiling node model.tipico.group
[0m19:39:58.614408 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.group"
[0m19:39:58.616522 [debug] [Thread-1  ]: Timing info for model.tipico.group (compile): 19:39:58.608623 => 19:39:58.616020
[0m19:39:58.617276 [debug] [Thread-1  ]: Began executing node model.tipico.group
[0m19:39:58.688936 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.group"
[0m19:39:58.691547 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:39:58.692043 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m19:39:58.692512 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:39:58.693159 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:39:58.693671 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:39:59.008933 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:39:59.011611 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:39:59.013712 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */

  
    

  create  table
    "dev"."timothy_chan"."group__dbt_tmp"
    
    
    
  as (
    

with group_data as (
    select 
    3686 as id
    ,'Argentina - Primera Nacional' as name
    ,207 as parent_group_country_id
    ,'Argentina' as parent_group_country_name
    ,11 as parent_group_sports_id
    ,'Soccer' as parent_group_sports_name
)
select *
from group_data
  );
[0m19:39:59.099815 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:39:59.121611 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:39:59.122533 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group" rename to "group__dbt_backup"
[0m19:39:59.245984 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:39:59.259404 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:39:59.260182 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group__dbt_tmp" rename to "group"
[0m19:39:59.323444 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:39:59.367188 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m19:39:59.367811 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:39:59.368289 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m19:39:59.912163 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m19:39:59.915034 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:39:59.916428 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m19:39:59.957918 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:39:59.982673 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."group__dbt_backup"
[0m19:39:59.992747 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:39:59.993479 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
drop table if exists "dev"."timothy_chan"."group__dbt_backup" cascade
[0m19:40:00.035082 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:00.036632 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m19:40:00.037273 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:40:00.037750 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m19:40:00.455405 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:00.459164 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m19:40:00.461089 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m19:40:00.484390 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:00.489200 [debug] [Thread-1  ]: Timing info for model.tipico.group (execute): 19:39:58.617723 => 19:40:00.488263
[0m19:40:00.490684 [debug] [Thread-1  ]: On model.tipico.group: ROLLBACK
[0m19:40:00.540050 [debug] [Thread-1  ]: On model.tipico.group: Close
[0m19:40:00.545099 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ead43852-5cc9-4527-a566-d00b8053fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb9da7bb0>]}
[0m19:40:00.549822 [info ] [Thread-1  ]: 1 of 4 OK created sql table model timothy_chan.group ........................... [[32mSUCCESS[0m in 1.94s]
[0m19:40:00.551552 [debug] [Thread-1  ]: Finished running node model.tipico.group
[0m19:40:00.552472 [debug] [Thread-1  ]: Began running node model.tipico.outcome
[0m19:40:00.553515 [info ] [Thread-1  ]: 2 of 4 START sql table model timothy_chan.outcome .............................. [RUN]
[0m19:40:00.554973 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.group, now model.tipico.outcome)
[0m19:40:00.555654 [debug] [Thread-1  ]: Began compiling node model.tipico.outcome
[0m19:40:00.561836 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.outcome"
[0m19:40:00.563200 [debug] [Thread-1  ]: Timing info for model.tipico.outcome (compile): 19:40:00.556081 => 19:40:00.562812
[0m19:40:00.563763 [debug] [Thread-1  ]: Began executing node model.tipico.outcome
[0m19:40:00.571933 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.outcome"
[0m19:40:00.574682 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m19:40:00.575176 [debug] [Thread-1  ]: On model.tipico.outcome: BEGIN
[0m19:40:00.575628 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:40:00.576316 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:40:00.576818 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:40:00.864620 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:00.867650 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m19:40:00.869877 [debug] [Thread-1  ]: On model.tipico.outcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.outcome"} */

  
    

  create  table
    "dev"."timothy_chan"."outcome__dbt_tmp"
    
    
    
  as (
    

with outcome as (
    select 
    '7057b856-a383-3831-8a87-5ea76f9fa317' as id
    ,'Over 23.5' as name
    ,true as isTraded
    ,1.95 as formatDecimal
    ,1.80 as formatAmerican
    ,'ONGOING' as status
    ,1.80 as trueOdds
)
select *
from outcome
  );
[0m19:40:01.255166 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:01.268562 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m19:40:01.269666 [debug] [Thread-1  ]: On model.tipico.outcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.outcome"} */
alter table "dev"."timothy_chan"."outcome" rename to "outcome__dbt_backup"
[0m19:40:01.395302 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:01.408470 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m19:40:01.409426 [debug] [Thread-1  ]: On model.tipico.outcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.outcome"} */
alter table "dev"."timothy_chan"."outcome__dbt_tmp" rename to "outcome"
[0m19:40:01.476086 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:01.485021 [debug] [Thread-1  ]: On model.tipico.outcome: COMMIT
[0m19:40:01.486080 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m19:40:01.486931 [debug] [Thread-1  ]: On model.tipico.outcome: COMMIT
[0m19:40:01.981235 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:01.985035 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m19:40:01.986867 [debug] [Thread-1  ]: On model.tipico.outcome: BEGIN
[0m19:40:02.028666 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:02.040661 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."outcome__dbt_backup"
[0m19:40:02.043788 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m19:40:02.044712 [debug] [Thread-1  ]: On model.tipico.outcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.outcome"} */
drop table if exists "dev"."timothy_chan"."outcome__dbt_backup" cascade
[0m19:40:02.091702 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:02.095697 [debug] [Thread-1  ]: On model.tipico.outcome: COMMIT
[0m19:40:02.096914 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m19:40:02.097792 [debug] [Thread-1  ]: On model.tipico.outcome: COMMIT
[0m19:40:02.478407 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:02.481360 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m19:40:02.482266 [debug] [Thread-1  ]: On model.tipico.outcome: BEGIN
[0m19:40:02.503568 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:02.507853 [debug] [Thread-1  ]: Timing info for model.tipico.outcome (execute): 19:40:00.564098 => 19:40:02.506874
[0m19:40:02.509379 [debug] [Thread-1  ]: On model.tipico.outcome: ROLLBACK
[0m19:40:02.548283 [debug] [Thread-1  ]: On model.tipico.outcome: Close
[0m19:40:02.553913 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ead43852-5cc9-4527-a566-d00b8053fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febca7f1160>]}
[0m19:40:02.557330 [info ] [Thread-1  ]: 2 of 4 OK created sql table model timothy_chan.outcome ......................... [[32mSUCCESS[0m in 2.00s]
[0m19:40:02.558804 [debug] [Thread-1  ]: Finished running node model.tipico.outcome
[0m19:40:02.559738 [debug] [Thread-1  ]: Began running node model.tipico.participant
[0m19:40:02.560862 [info ] [Thread-1  ]: 3 of 4 START sql table model timothy_chan.participant .......................... [RUN]
[0m19:40:02.562368 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.outcome, now model.tipico.participant)
[0m19:40:02.563151 [debug] [Thread-1  ]: Began compiling node model.tipico.participant
[0m19:40:02.572298 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.participant"
[0m19:40:02.574689 [debug] [Thread-1  ]: Timing info for model.tipico.participant (compile): 19:40:02.563638 => 19:40:02.574289
[0m19:40:02.575324 [debug] [Thread-1  ]: Began executing node model.tipico.participant
[0m19:40:02.583767 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.participant"
[0m19:40:02.586542 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:40:02.587094 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m19:40:02.587614 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:40:02.588350 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:40:02.588886 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:40:02.888417 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:02.891296 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:40:02.893368 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */

  
    

  create  table
    "dev"."timothy_chan"."participant__dbt_tmp"
    
    
    
  as (
    

with participant as (
    select 
    35458 as id
    ,'George Washington ' as name
    ,'HOME' as position
    ,'GEO' as abbreviation
)
select *
from participant
  );
[0m19:40:02.979393 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:02.995328 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:40:02.996310 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
alter table "dev"."timothy_chan"."participant" rename to "participant__dbt_backup"
[0m19:40:03.113061 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:03.128687 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:40:03.129764 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
alter table "dev"."timothy_chan"."participant__dbt_tmp" rename to "participant"
[0m19:40:03.193385 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:03.207832 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m19:40:03.210205 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:40:03.210992 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m19:40:03.725491 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m19:40:03.729608 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:40:03.731066 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m19:40:03.769591 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:03.780605 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."participant__dbt_backup"
[0m19:40:03.783776 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:40:03.784737 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
drop table if exists "dev"."timothy_chan"."participant__dbt_backup" cascade
[0m19:40:03.828556 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:03.832318 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m19:40:03.833785 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:40:03.834933 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m19:40:04.292926 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:04.295499 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m19:40:04.296911 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m19:40:04.318378 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:04.324643 [debug] [Thread-1  ]: Timing info for model.tipico.participant (execute): 19:40:02.575711 => 19:40:04.323704
[0m19:40:04.326185 [debug] [Thread-1  ]: On model.tipico.participant: ROLLBACK
[0m19:40:04.370979 [debug] [Thread-1  ]: On model.tipico.participant: Close
[0m19:40:04.375387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ead43852-5cc9-4527-a566-d00b8053fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febca7eaf70>]}
[0m19:40:04.378090 [info ] [Thread-1  ]: 3 of 4 OK created sql table model timothy_chan.participant ..................... [[32mSUCCESS[0m in 1.81s]
[0m19:40:04.380125 [debug] [Thread-1  ]: Finished running node model.tipico.participant
[0m19:40:04.381440 [debug] [Thread-1  ]: Began running node model.tipico.specifier
[0m19:40:04.382900 [info ] [Thread-1  ]: 4 of 4 START sql table model timothy_chan.specifier ............................ [RUN]
[0m19:40:04.384725 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.participant, now model.tipico.specifier)
[0m19:40:04.385669 [debug] [Thread-1  ]: Began compiling node model.tipico.specifier
[0m19:40:04.393173 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.specifier"
[0m19:40:04.394777 [debug] [Thread-1  ]: Timing info for model.tipico.specifier (compile): 19:40:04.386237 => 19:40:04.394313
[0m19:40:04.395502 [debug] [Thread-1  ]: Began executing node model.tipico.specifier
[0m19:40:04.408499 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.specifier"
[0m19:40:04.411180 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m19:40:04.411814 [debug] [Thread-1  ]: On model.tipico.specifier: BEGIN
[0m19:40:04.412402 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:40:04.413207 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:40:04.413848 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:40:04.704763 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:04.707631 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m19:40:04.709551 [debug] [Thread-1  ]: On model.tipico.specifier: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.specifier"} */

  
    

  create  table
    "dev"."timothy_chan"."specifier__dbt_tmp"
    
    
    
  as (
    

with specifier as (
    select 
    'OVER_UNDER' as key
    ,'5.5' as value
    ,'DOUBLE' as type
)
select *
from specifier
  );
[0m19:40:07.809103 [debug] [Thread-1  ]: SQL status: SUCCESS in 3.0 seconds
[0m19:40:07.822874 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m19:40:07.823966 [debug] [Thread-1  ]: On model.tipico.specifier: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.specifier"} */
alter table "dev"."timothy_chan"."specifier__dbt_tmp" rename to "specifier"
[0m19:40:07.957423 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:07.968183 [debug] [Thread-1  ]: On model.tipico.specifier: COMMIT
[0m19:40:07.969907 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m19:40:07.970903 [debug] [Thread-1  ]: On model.tipico.specifier: COMMIT
[0m19:40:08.406931 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:08.410597 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m19:40:08.412231 [debug] [Thread-1  ]: On model.tipico.specifier: BEGIN
[0m19:40:08.456761 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:08.469108 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."specifier__dbt_backup"
[0m19:40:08.472286 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m19:40:08.473238 [debug] [Thread-1  ]: On model.tipico.specifier: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.specifier"} */
drop table if exists "dev"."timothy_chan"."specifier__dbt_backup" cascade
[0m19:40:08.511258 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:08.514558 [debug] [Thread-1  ]: On model.tipico.specifier: COMMIT
[0m19:40:08.515971 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m19:40:08.516946 [debug] [Thread-1  ]: On model.tipico.specifier: COMMIT
[0m19:40:08.541682 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:08.543523 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m19:40:08.544766 [debug] [Thread-1  ]: On model.tipico.specifier: BEGIN
[0m19:40:08.567379 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:08.571398 [debug] [Thread-1  ]: Timing info for model.tipico.specifier (execute): 19:40:04.395940 => 19:40:08.570707
[0m19:40:08.572548 [debug] [Thread-1  ]: On model.tipico.specifier: ROLLBACK
[0m19:40:08.611958 [debug] [Thread-1  ]: On model.tipico.specifier: Close
[0m19:40:08.615928 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ead43852-5cc9-4527-a566-d00b8053fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febca603f70>]}
[0m19:40:08.618005 [info ] [Thread-1  ]: 4 of 4 OK created sql table model timothy_chan.specifier ....................... [[32mSUCCESS[0m in 4.23s]
[0m19:40:08.619555 [debug] [Thread-1  ]: Finished running node model.tipico.specifier
[0m19:40:08.622646 [debug] [MainThread]: Using redshift connection "master"
[0m19:40:08.623422 [debug] [MainThread]: On master: BEGIN
[0m19:40:08.624132 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:08.625141 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:40:08.625911 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:40:08.920345 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:08.923191 [debug] [MainThread]: On master: COMMIT
[0m19:40:08.925657 [debug] [MainThread]: Using redshift connection "master"
[0m19:40:08.926675 [debug] [MainThread]: On master: COMMIT
[0m19:40:08.965821 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:40:08.967954 [debug] [MainThread]: On master: Close
[0m19:40:08.971827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:08.972901 [debug] [MainThread]: Connection 'model.tipico.specifier' was properly closed.
[0m19:40:08.974687 [info ] [MainThread]: 
[0m19:40:08.975895 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.97 seconds (11.97s).
[0m19:40:08.978704 [debug] [MainThread]: Command end result
[0m19:40:08.999343 [info ] [MainThread]: 
[0m19:40:09.000107 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:09.000669 [info ] [MainThread]: 
[0m19:40:09.001318 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:40:09.006217 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.913041, "process_user_time": 4.729053, "process_kernel_time": 0.839062, "process_mem_max_rss": "124329984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:40:09.007293 [debug] [MainThread]: Command `dbt run` succeeded at 19:40:09.007077 after 12.91 seconds
[0m19:40:09.007903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb8f90b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febca76d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febca80f550>]}
[0m19:40:09.008499 [debug] [MainThread]: Flushing usage events
[0m20:43:22.553222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b1318e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b2052b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b20686a0>]}


============================== 20:43:22.559355 | eb95e292-d045-4199-b062-8666d714a4f8 ==============================
[0m20:43:22.559355 [info ] [MainThread]: Running with dbt=1.7.0
[0m20:43:22.560152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tim/tipico_git/logs', 'profiles_dir': '/Users/tim/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:43:22.951037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb95e292-d045-4199-b062-8666d714a4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b206c280>]}
[0m20:43:23.069535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb95e292-d045-4199-b062-8666d714a4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a1aaedf0>]}
[0m20:43:23.071515 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m20:43:23.085902 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m20:43:23.150676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:43:23.151231 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:43:23.160408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb95e292-d045-4199-b062-8666d714a4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b25b90d0>]}
[0m20:43:23.177383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb95e292-d045-4199-b062-8666d714a4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b24d44f0>]}
[0m20:43:23.178010 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m20:43:23.178484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb95e292-d045-4199-b062-8666d714a4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a1ab4610>]}
[0m20:43:23.180682 [info ] [MainThread]: 
[0m20:43:23.181749 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:43:23.183411 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:43:23.207544 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:43:23.208030 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:43:23.208454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:43:23.212829 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:43:23.213589 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:43:23.729049 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:43:23.738386 [debug] [ThreadPool]: On list_dev: Close
[0m20:43:23.744554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m20:43:23.763363 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m20:43:23.764110 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m20:43:23.764719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:23.765575 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:43:23.766142 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:43:41.831799 [debug] [ThreadPool]: SQL status: SUCCESS in 18.0 seconds
[0m20:43:41.836649 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m20:43:41.837798 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m20:43:41.909475 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:41.921415 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m20:43:41.974603 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m20:43:42.010996 [debug] [MainThread]: Using redshift connection "master"
[0m20:43:42.011633 [debug] [MainThread]: On master: BEGIN
[0m20:43:42.012101 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:43:42.013619 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:43:42.014079 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:43:42.336871 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:42.338634 [debug] [MainThread]: Using redshift connection "master"
[0m20:43:42.339847 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:43:42.454461 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:42.460987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb95e292-d045-4199-b062-8666d714a4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b233cbe0>]}
[0m20:43:42.463423 [debug] [MainThread]: On master: ROLLBACK
[0m20:43:42.527224 [debug] [MainThread]: Using redshift connection "master"
[0m20:43:42.528872 [debug] [MainThread]: On master: BEGIN
[0m20:43:42.551801 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:42.553337 [debug] [MainThread]: On master: COMMIT
[0m20:43:42.554840 [debug] [MainThread]: Using redshift connection "master"
[0m20:43:42.555989 [debug] [MainThread]: On master: COMMIT
[0m20:43:42.600746 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:42.602968 [debug] [MainThread]: On master: Close
[0m20:43:42.607421 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:43:42.609993 [info ] [MainThread]: 
[0m20:43:42.631059 [debug] [Thread-1  ]: Began running node model.tipico.group
[0m20:43:42.633228 [info ] [Thread-1  ]: 1 of 4 START sql table model timothy_chan.group ................................ [RUN]
[0m20:43:42.635588 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.group)
[0m20:43:42.636604 [debug] [Thread-1  ]: Began compiling node model.tipico.group
[0m20:43:42.644797 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.group"
[0m20:43:42.646917 [debug] [Thread-1  ]: Timing info for model.tipico.group (compile): 20:43:42.637219 => 20:43:42.646217
[0m20:43:42.647781 [debug] [Thread-1  ]: Began executing node model.tipico.group
[0m20:43:42.720718 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.group"
[0m20:43:42.723453 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m20:43:42.723962 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m20:43:42.724435 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:43:42.725105 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:43:42.725601 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:43:43.016803 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:43.018884 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m20:43:43.020435 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */

  
    

  create  table
    "dev"."timothy_chan"."group__dbt_tmp"
    
    
    
  as (
    

with group_data as (
    select 
    3686 as id
    ,'Argentina - Primera Nacional' as name
    ,207 as parent_group_country_id
    ,'Argentina' as parent_group_country_name
    ,11 as parent_group_sports_id
    ,'Soccer' as parent_group_sports_name
)
select *
from group_data
  );
[0m20:43:43.440676 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:43.463311 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m20:43:43.464841 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group" rename to "group__dbt_backup"
[0m20:43:43.586078 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:43.604468 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m20:43:43.606105 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group__dbt_tmp" rename to "group"
[0m20:43:43.674399 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:43.732351 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m20:43:43.733215 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m20:43:43.733774 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m20:43:44.866566 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m20:43:44.870353 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m20:43:44.872257 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m20:43:44.917808 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:44.942912 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."group__dbt_backup"
[0m20:43:44.950709 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m20:43:44.951309 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
drop table if exists "dev"."timothy_chan"."group__dbt_backup" cascade
[0m20:43:44.996323 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:45.000274 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m20:43:45.002097 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m20:43:45.003219 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m20:43:45.902104 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m20:43:45.905665 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m20:43:45.907589 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m20:43:45.934123 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:45.941140 [debug] [Thread-1  ]: Timing info for model.tipico.group (execute): 20:43:42.648277 => 20:43:45.939749
[0m20:43:45.943385 [debug] [Thread-1  ]: On model.tipico.group: ROLLBACK
[0m20:43:45.992709 [debug] [Thread-1  ]: On model.tipico.group: Close
[0m20:43:45.999163 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb95e292-d045-4199-b062-8666d714a4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a1d27250>]}
[0m20:43:46.004001 [info ] [Thread-1  ]: 1 of 4 OK created sql table model timothy_chan.group ........................... [[32mSUCCESS[0m in 3.36s]
[0m20:43:46.006894 [debug] [Thread-1  ]: Finished running node model.tipico.group
[0m20:43:46.008675 [debug] [Thread-1  ]: Began running node model.tipico.outcome
[0m20:43:46.010835 [info ] [Thread-1  ]: 2 of 4 START sql table model timothy_chan.outcome .............................. [RUN]
[0m20:43:46.013869 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.group, now model.tipico.outcome)
[0m20:43:46.015134 [debug] [Thread-1  ]: Began compiling node model.tipico.outcome
[0m20:43:46.025597 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.outcome"
[0m20:43:46.027583 [debug] [Thread-1  ]: Timing info for model.tipico.outcome (compile): 20:43:46.015808 => 20:43:46.026993
[0m20:43:46.028496 [debug] [Thread-1  ]: Began executing node model.tipico.outcome
[0m20:43:46.039736 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.outcome"
[0m20:43:46.043285 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m20:43:46.043999 [debug] [Thread-1  ]: On model.tipico.outcome: BEGIN
[0m20:43:46.044608 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:43:46.045483 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:43:46.046136 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:43:46.328805 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:46.331659 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m20:43:46.333696 [debug] [Thread-1  ]: On model.tipico.outcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.outcome"} */

  
    

  create  table
    "dev"."timothy_chan"."outcome__dbt_tmp"
    
    
    
  as (
    

with outcome as (
    select 
    '7057b856-a383-3831-8a87-5ea76f9fa317' as id
    ,'Over 23.5' as name
    ,true as isTraded
    ,1.95 as formatDecimal
    ,1.80 as formatAmerican
    ,'ONGOING' as status
    ,1.80 as trueOdds
)
select *
from outcome
  );
[0m20:43:46.463985 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:46.480882 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m20:43:46.482749 [debug] [Thread-1  ]: On model.tipico.outcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.outcome"} */
alter table "dev"."timothy_chan"."outcome" rename to "outcome__dbt_backup"
[0m20:43:46.605736 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:46.627018 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m20:43:46.628625 [debug] [Thread-1  ]: On model.tipico.outcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.outcome"} */
alter table "dev"."timothy_chan"."outcome__dbt_tmp" rename to "outcome"
[0m20:43:46.692200 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:46.704387 [debug] [Thread-1  ]: On model.tipico.outcome: COMMIT
[0m20:43:46.706391 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m20:43:46.707744 [debug] [Thread-1  ]: On model.tipico.outcome: COMMIT
[0m20:43:47.593633 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m20:43:47.598563 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m20:43:47.600549 [debug] [Thread-1  ]: On model.tipico.outcome: BEGIN
[0m20:43:47.637266 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:47.648983 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."outcome__dbt_backup"
[0m20:43:47.652678 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m20:43:47.653769 [debug] [Thread-1  ]: On model.tipico.outcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.outcome"} */
drop table if exists "dev"."timothy_chan"."outcome__dbt_backup" cascade
[0m20:43:47.701611 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:47.708178 [debug] [Thread-1  ]: On model.tipico.outcome: COMMIT
[0m20:43:47.710718 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m20:43:47.712697 [debug] [Thread-1  ]: On model.tipico.outcome: COMMIT
[0m20:43:48.577076 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m20:43:48.581297 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m20:43:48.583393 [debug] [Thread-1  ]: On model.tipico.outcome: BEGIN
[0m20:43:48.612410 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:48.618177 [debug] [Thread-1  ]: Timing info for model.tipico.outcome (execute): 20:43:46.029053 => 20:43:48.616918
[0m20:43:48.620301 [debug] [Thread-1  ]: On model.tipico.outcome: ROLLBACK
[0m20:43:48.662815 [debug] [Thread-1  ]: On model.tipico.outcome: Close
[0m20:43:48.667869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb95e292-d045-4199-b062-8666d714a4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a1d32dc0>]}
[0m20:43:48.671242 [info ] [Thread-1  ]: 2 of 4 OK created sql table model timothy_chan.outcome ......................... [[32mSUCCESS[0m in 2.65s]
[0m20:43:48.674510 [debug] [Thread-1  ]: Finished running node model.tipico.outcome
[0m20:43:48.676780 [debug] [Thread-1  ]: Began running node model.tipico.participant
[0m20:43:48.679049 [info ] [Thread-1  ]: 3 of 4 START sql table model timothy_chan.participant .......................... [RUN]
[0m20:43:48.682332 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.outcome, now model.tipico.participant)
[0m20:43:48.683966 [debug] [Thread-1  ]: Began compiling node model.tipico.participant
[0m20:43:48.700029 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.participant"
[0m20:43:48.702024 [debug] [Thread-1  ]: Timing info for model.tipico.participant (compile): 20:43:48.684866 => 20:43:48.701435
[0m20:43:48.702951 [debug] [Thread-1  ]: Began executing node model.tipico.participant
[0m20:43:48.714371 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.participant"
[0m20:43:48.717847 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m20:43:48.718499 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m20:43:48.719001 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:43:48.719676 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:43:48.720188 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:43:49.010468 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:49.013518 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m20:43:49.015622 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */

  
    

  create  table
    "dev"."timothy_chan"."participant__dbt_tmp"
    
    
    
  as (
    

with participant as (
    select 
    35458 as id
    ,'George Washington ' as name
    ,'HOME' as position
    ,'GEO' as abbreviation
)
select *
from participant
  );
[0m20:43:49.102273 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:49.125427 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m20:43:49.127106 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
alter table "dev"."timothy_chan"."participant" rename to "participant__dbt_backup"
[0m20:43:49.245446 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:49.264806 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m20:43:49.266084 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
alter table "dev"."timothy_chan"."participant__dbt_tmp" rename to "participant"
[0m20:43:49.337353 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:49.351788 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m20:43:49.353818 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m20:43:49.355219 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m20:43:49.857105 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:49.860382 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m20:43:49.861747 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m20:43:49.905996 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:49.921638 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."participant__dbt_backup"
[0m20:43:49.926145 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m20:43:49.927421 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
drop table if exists "dev"."timothy_chan"."participant__dbt_backup" cascade
[0m20:43:49.974812 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:49.981676 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m20:43:49.984122 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m20:43:49.985577 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m20:43:50.513404 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m20:43:50.515660 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m20:43:50.516854 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m20:43:50.537946 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:50.542097 [debug] [Thread-1  ]: Timing info for model.tipico.participant (execute): 20:43:48.703508 => 20:43:50.541188
[0m20:43:50.543694 [debug] [Thread-1  ]: On model.tipico.participant: ROLLBACK
[0m20:43:50.586599 [debug] [Thread-1  ]: On model.tipico.participant: Close
[0m20:43:50.592675 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb95e292-d045-4199-b062-8666d714a4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a1b39fa0>]}
[0m20:43:50.595717 [info ] [Thread-1  ]: 3 of 4 OK created sql table model timothy_chan.participant ..................... [[32mSUCCESS[0m in 1.91s]
[0m20:43:50.598259 [debug] [Thread-1  ]: Finished running node model.tipico.participant
[0m20:43:50.600031 [debug] [Thread-1  ]: Began running node model.tipico.specifier
[0m20:43:50.601968 [info ] [Thread-1  ]: 4 of 4 START sql table model timothy_chan.specifier ............................ [RUN]
[0m20:43:50.604372 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.participant, now model.tipico.specifier)
[0m20:43:50.605616 [debug] [Thread-1  ]: Began compiling node model.tipico.specifier
[0m20:43:50.613849 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.specifier"
[0m20:43:50.615101 [debug] [Thread-1  ]: Timing info for model.tipico.specifier (compile): 20:43:50.606359 => 20:43:50.614757
[0m20:43:50.615619 [debug] [Thread-1  ]: Began executing node model.tipico.specifier
[0m20:43:50.625494 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.specifier"
[0m20:43:50.627806 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m20:43:50.628298 [debug] [Thread-1  ]: On model.tipico.specifier: BEGIN
[0m20:43:50.628754 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:43:50.629400 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:43:50.629879 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:43:50.916969 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:50.919972 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m20:43:50.922015 [debug] [Thread-1  ]: On model.tipico.specifier: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.specifier"} */

  
    

  create  table
    "dev"."timothy_chan"."specifier__dbt_tmp"
    
    
    
  as (
    

with specifier as (
    select 
    'OVER_UNDER' as key
    ,'5.5' as value
    ,'DOUBLE' as type
)
select *
from specifier
  );
[0m20:43:51.158840 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:51.180796 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m20:43:51.182467 [debug] [Thread-1  ]: On model.tipico.specifier: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.specifier"} */
alter table "dev"."timothy_chan"."specifier" rename to "specifier__dbt_backup"
[0m20:43:51.292538 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:51.311882 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m20:43:51.313287 [debug] [Thread-1  ]: On model.tipico.specifier: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.specifier"} */
alter table "dev"."timothy_chan"."specifier__dbt_tmp" rename to "specifier"
[0m20:43:51.377007 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:51.390825 [debug] [Thread-1  ]: On model.tipico.specifier: COMMIT
[0m20:43:51.392830 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m20:43:51.394196 [debug] [Thread-1  ]: On model.tipico.specifier: COMMIT
[0m20:43:52.076602 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m20:43:52.082309 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m20:43:52.084392 [debug] [Thread-1  ]: On model.tipico.specifier: BEGIN
[0m20:43:52.127913 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:52.144191 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."specifier__dbt_backup"
[0m20:43:52.149300 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m20:43:52.150495 [debug] [Thread-1  ]: On model.tipico.specifier: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.specifier"} */
drop table if exists "dev"."timothy_chan"."specifier__dbt_backup" cascade
[0m20:43:52.194467 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:52.201952 [debug] [Thread-1  ]: On model.tipico.specifier: COMMIT
[0m20:43:52.204577 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m20:43:52.206074 [debug] [Thread-1  ]: On model.tipico.specifier: COMMIT
[0m20:43:52.700395 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:52.701940 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m20:43:52.703066 [debug] [Thread-1  ]: On model.tipico.specifier: BEGIN
[0m20:43:52.720528 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:52.726008 [debug] [Thread-1  ]: Timing info for model.tipico.specifier (execute): 20:43:50.615922 => 20:43:52.724735
[0m20:43:52.728045 [debug] [Thread-1  ]: On model.tipico.specifier: ROLLBACK
[0m20:43:52.769854 [debug] [Thread-1  ]: On model.tipico.specifier: Close
[0m20:43:52.775130 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb95e292-d045-4199-b062-8666d714a4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a1d20f70>]}
[0m20:43:52.778386 [info ] [Thread-1  ]: 4 of 4 OK created sql table model timothy_chan.specifier ....................... [[32mSUCCESS[0m in 2.17s]
[0m20:43:52.781574 [debug] [Thread-1  ]: Finished running node model.tipico.specifier
[0m20:43:52.787570 [debug] [MainThread]: Using redshift connection "master"
[0m20:43:52.788883 [debug] [MainThread]: On master: BEGIN
[0m20:43:52.790049 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:43:52.792739 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:43:52.794207 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:43:53.081956 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:53.084720 [debug] [MainThread]: On master: COMMIT
[0m20:43:53.087115 [debug] [MainThread]: Using redshift connection "master"
[0m20:43:53.088773 [debug] [MainThread]: On master: COMMIT
[0m20:43:53.130133 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:43:53.132131 [debug] [MainThread]: On master: Close
[0m20:43:53.136255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:43:53.137116 [debug] [MainThread]: Connection 'model.tipico.specifier' was properly closed.
[0m20:43:53.139189 [info ] [MainThread]: 
[0m20:43:53.140757 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 29.96 seconds (29.96s).
[0m20:43:53.143729 [debug] [MainThread]: Command end result
[0m20:43:53.168131 [info ] [MainThread]: 
[0m20:43:53.168919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:43:53.169497 [info ] [MainThread]: 
[0m20:43:53.170175 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:43:53.176090 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 30.76541, "process_user_time": 4.885686, "process_kernel_time": 0.455071, "process_mem_max_rss": "122241024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:43:53.177279 [debug] [MainThread]: Command `dbt run` succeeded at 20:43:53.177042 after 30.77 seconds
[0m20:43:53.177962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b1318e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a1d10100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b24d4520>]}
[0m20:43:53.178589 [debug] [MainThread]: Flushing usage events
[0m21:13:53.172974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e87c0b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1fa1e1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1fa1c88b0>]}


============================== 21:13:53.179508 | fc9a48d3-3365-48ec-883a-1dbbf0ff8a37 ==============================
[0m21:13:53.179508 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:13:53.180302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tim/tipico_git/logs', 'profiles_dir': '/Users/tim/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:13:53.719252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc9a48d3-3365-48ec-883a-1dbbf0ff8a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1fa1e2610>]}
[0m21:13:53.842304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc9a48d3-3365-48ec-883a-1dbbf0ff8a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e9afcf10>]}
[0m21:13:53.844457 [info ] [MainThread]: Registered adapter: redshift=1.7.7
[0m21:13:53.860034 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:13:53.930494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:13:53.931047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:13:53.940733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc9a48d3-3365-48ec-883a-1dbbf0ff8a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d81a90d0>]}
[0m21:13:53.957313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc9a48d3-3365-48ec-883a-1dbbf0ff8a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e9c994c0>]}
[0m21:13:53.957966 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m21:13:53.958458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc9a48d3-3365-48ec-883a-1dbbf0ff8a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e9c99400>]}
[0m21:13:53.960592 [info ] [MainThread]: 
[0m21:13:53.961631 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:13:53.963239 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m21:13:53.986897 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m21:13:53.987391 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m21:13:53.987824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:53.992163 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:13:53.992899 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:13:54.517727 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:13:54.522737 [debug] [ThreadPool]: On list_dev: Close
[0m21:13:54.527994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_timothy_chan)
[0m21:13:54.548625 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m21:13:54.549443 [debug] [ThreadPool]: On list_dev_timothy_chan: BEGIN
[0m21:13:54.549952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:54.550710 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:13:54.551181 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:13:54.839859 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:54.842176 [debug] [ThreadPool]: Using redshift connection "list_dev_timothy_chan"
[0m21:13:54.844159 [debug] [ThreadPool]: On list_dev_timothy_chan: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "list_dev_timothy_chan"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'timothy_chan'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'timothy_chan'
[0m21:13:54.904507 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:54.909905 [debug] [ThreadPool]: On list_dev_timothy_chan: ROLLBACK
[0m21:13:54.956777 [debug] [ThreadPool]: On list_dev_timothy_chan: Close
[0m21:13:54.983532 [debug] [MainThread]: Using redshift connection "master"
[0m21:13:54.984197 [debug] [MainThread]: On master: BEGIN
[0m21:13:54.984612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:13:54.985198 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:13:54.985642 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:13:55.288283 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:55.290993 [debug] [MainThread]: Using redshift connection "master"
[0m21:13:55.293133 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:13:55.383855 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:55.391263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc9a48d3-3365-48ec-883a-1dbbf0ff8a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e9b31c70>]}
[0m21:13:55.393362 [debug] [MainThread]: On master: ROLLBACK
[0m21:13:55.454856 [debug] [MainThread]: Using redshift connection "master"
[0m21:13:55.457479 [debug] [MainThread]: On master: BEGIN
[0m21:13:55.483135 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:55.485717 [debug] [MainThread]: On master: COMMIT
[0m21:13:55.488033 [debug] [MainThread]: Using redshift connection "master"
[0m21:13:55.489736 [debug] [MainThread]: On master: COMMIT
[0m21:13:55.532436 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:55.534615 [debug] [MainThread]: On master: Close
[0m21:13:55.537379 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:13:55.538553 [info ] [MainThread]: 
[0m21:13:55.552038 [debug] [Thread-1  ]: Began running node model.tipico.group
[0m21:13:55.554418 [info ] [Thread-1  ]: 1 of 4 START sql table model timothy_chan.group ................................ [RUN]
[0m21:13:55.557393 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_timothy_chan, now model.tipico.group)
[0m21:13:55.559217 [debug] [Thread-1  ]: Began compiling node model.tipico.group
[0m21:13:55.568225 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.group"
[0m21:13:55.570079 [debug] [Thread-1  ]: Timing info for model.tipico.group (compile): 21:13:55.560319 => 21:13:55.569462
[0m21:13:55.570849 [debug] [Thread-1  ]: Began executing node model.tipico.group
[0m21:13:55.644612 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.group"
[0m21:13:55.647316 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m21:13:55.647836 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m21:13:55.648298 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:13:55.648945 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:13:55.649442 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:13:55.936842 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:55.939830 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m21:13:55.941967 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */

  
    

  create  table
    "dev"."timothy_chan"."group__dbt_tmp"
    
    
    
  as (
    

with group_data as (
    select 
    3686 as id
    ,'Argentina - Primera Nacional' as name
    ,207 as parent_group_country_id
    ,'Argentina' as parent_group_country_name
    ,11 as parent_group_sports_id
    ,'Soccer' as parent_group_sports_name
)
select *
from group_data
  );
[0m21:13:56.030372 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:56.064387 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m21:13:56.065668 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group" rename to "group__dbt_backup"
[0m21:13:56.190173 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:56.203974 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m21:13:56.205217 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
alter table "dev"."timothy_chan"."group__dbt_tmp" rename to "group"
[0m21:13:56.270706 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:56.325134 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m21:13:56.325868 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m21:13:56.326361 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m21:13:56.896263 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m21:13:56.898895 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m21:13:56.900040 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m21:13:56.945797 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:56.969256 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."group__dbt_backup"
[0m21:13:56.979463 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m21:13:56.980409 [debug] [Thread-1  ]: On model.tipico.group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.group"} */
drop table if exists "dev"."timothy_chan"."group__dbt_backup" cascade
[0m21:13:57.024668 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:57.028650 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m21:13:57.029866 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m21:13:57.030935 [debug] [Thread-1  ]: On model.tipico.group: COMMIT
[0m21:13:57.475426 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:57.478205 [debug] [Thread-1  ]: Using redshift connection "model.tipico.group"
[0m21:13:57.480162 [debug] [Thread-1  ]: On model.tipico.group: BEGIN
[0m21:13:57.505261 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:57.509382 [debug] [Thread-1  ]: Timing info for model.tipico.group (execute): 21:13:55.571314 => 21:13:57.508806
[0m21:13:57.510367 [debug] [Thread-1  ]: On model.tipico.group: ROLLBACK
[0m21:13:57.556691 [debug] [Thread-1  ]: On model.tipico.group: Close
[0m21:13:57.560005 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc9a48d3-3365-48ec-883a-1dbbf0ff8a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1fa492250>]}
[0m21:13:57.562512 [info ] [Thread-1  ]: 1 of 4 OK created sql table model timothy_chan.group ........................... [[32mSUCCESS[0m in 2.00s]
[0m21:13:57.564153 [debug] [Thread-1  ]: Finished running node model.tipico.group
[0m21:13:57.565317 [debug] [Thread-1  ]: Began running node model.tipico.outcome
[0m21:13:57.566662 [info ] [Thread-1  ]: 2 of 4 START sql table model timothy_chan.outcome .............................. [RUN]
[0m21:13:57.568513 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.group, now model.tipico.outcome)
[0m21:13:57.569429 [debug] [Thread-1  ]: Began compiling node model.tipico.outcome
[0m21:13:57.579190 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.outcome"
[0m21:13:57.582123 [debug] [Thread-1  ]: Timing info for model.tipico.outcome (compile): 21:13:57.569991 => 21:13:57.580793
[0m21:13:57.583441 [debug] [Thread-1  ]: Began executing node model.tipico.outcome
[0m21:13:57.595640 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.outcome"
[0m21:13:57.601107 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m21:13:57.602320 [debug] [Thread-1  ]: On model.tipico.outcome: BEGIN
[0m21:13:57.603105 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:13:57.604043 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:13:57.604718 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:13:57.892005 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:57.893225 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m21:13:57.894186 [debug] [Thread-1  ]: On model.tipico.outcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.outcome"} */

  
    

  create  table
    "dev"."timothy_chan"."outcome__dbt_tmp"
    
    
    
  as (
    

with outcome as (
    select 
    '7057b856-a383-3831-8a87-5ea76f9fa317' as id
    ,'Over 23.5' as name
    ,true as isTraded
    ,1.95 as formatDecimal
    ,1.80 as formatAmerican
    ,'ONGOING' as status
    ,1.80 as trueOdds
)
select *
from outcome
  );
[0m21:13:57.975561 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:57.987288 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m21:13:57.988529 [debug] [Thread-1  ]: On model.tipico.outcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.outcome"} */
alter table "dev"."timothy_chan"."outcome" rename to "outcome__dbt_backup"
[0m21:13:58.106481 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:58.117620 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m21:13:58.119351 [debug] [Thread-1  ]: On model.tipico.outcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.outcome"} */
alter table "dev"."timothy_chan"."outcome__dbt_tmp" rename to "outcome"
[0m21:13:58.177310 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:58.189220 [debug] [Thread-1  ]: On model.tipico.outcome: COMMIT
[0m21:13:58.190455 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m21:13:58.191345 [debug] [Thread-1  ]: On model.tipico.outcome: COMMIT
[0m21:13:58.740777 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m21:13:58.743248 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m21:13:58.745148 [debug] [Thread-1  ]: On model.tipico.outcome: BEGIN
[0m21:13:58.787574 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:58.796640 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."outcome__dbt_backup"
[0m21:13:58.800170 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m21:13:58.801134 [debug] [Thread-1  ]: On model.tipico.outcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.outcome"} */
drop table if exists "dev"."timothy_chan"."outcome__dbt_backup" cascade
[0m21:13:58.847519 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:58.850237 [debug] [Thread-1  ]: On model.tipico.outcome: COMMIT
[0m21:13:58.851754 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m21:13:58.852716 [debug] [Thread-1  ]: On model.tipico.outcome: COMMIT
[0m21:13:59.298331 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:59.302636 [debug] [Thread-1  ]: Using redshift connection "model.tipico.outcome"
[0m21:13:59.304718 [debug] [Thread-1  ]: On model.tipico.outcome: BEGIN
[0m21:13:59.327160 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:59.332929 [debug] [Thread-1  ]: Timing info for model.tipico.outcome (execute): 21:13:57.584413 => 21:13:59.331681
[0m21:13:59.334999 [debug] [Thread-1  ]: On model.tipico.outcome: ROLLBACK
[0m21:13:59.373129 [debug] [Thread-1  ]: On model.tipico.outcome: Close
[0m21:13:59.379770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc9a48d3-3365-48ec-883a-1dbbf0ff8a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e9b31c70>]}
[0m21:13:59.382762 [info ] [Thread-1  ]: 2 of 4 OK created sql table model timothy_chan.outcome ......................... [[32mSUCCESS[0m in 1.81s]
[0m21:13:59.385220 [debug] [Thread-1  ]: Finished running node model.tipico.outcome
[0m21:13:59.387388 [debug] [Thread-1  ]: Began running node model.tipico.participant
[0m21:13:59.389643 [info ] [Thread-1  ]: 3 of 4 START sql table model timothy_chan.participant .......................... [RUN]
[0m21:13:59.392570 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.outcome, now model.tipico.participant)
[0m21:13:59.393967 [debug] [Thread-1  ]: Began compiling node model.tipico.participant
[0m21:13:59.409093 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.participant"
[0m21:13:59.411096 [debug] [Thread-1  ]: Timing info for model.tipico.participant (compile): 21:13:59.394983 => 21:13:59.410528
[0m21:13:59.411696 [debug] [Thread-1  ]: Began executing node model.tipico.participant
[0m21:13:59.421438 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.participant"
[0m21:13:59.425079 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m21:13:59.425744 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m21:13:59.426344 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:13:59.427001 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:13:59.427507 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:13:59.722022 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:59.725023 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m21:13:59.727157 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */

  
    

  create  table
    "dev"."timothy_chan"."participant__dbt_tmp"
    
    
    
  as (
    

with participant as (
    select 
    35458 as id
    ,'George Washington ' as name
    ,'HOME' as position
    ,'GEO' as abbreviation
)
select *
from participant
  );
[0m21:13:59.812891 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:59.834264 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m21:13:59.835931 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
alter table "dev"."timothy_chan"."participant" rename to "participant__dbt_backup"
[0m21:13:59.964733 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:13:59.977940 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m21:13:59.979356 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
alter table "dev"."timothy_chan"."participant__dbt_tmp" rename to "participant"
[0m21:14:00.051708 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:14:00.061408 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m21:14:00.062927 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m21:14:00.063851 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m21:14:00.585880 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m21:14:00.591208 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m21:14:00.593123 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m21:14:00.640510 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:14:00.655803 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."participant__dbt_backup"
[0m21:14:00.661795 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m21:14:00.663278 [debug] [Thread-1  ]: On model.tipico.participant: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.participant"} */
drop table if exists "dev"."timothy_chan"."participant__dbt_backup" cascade
[0m21:14:00.710981 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:14:00.717034 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m21:14:00.719695 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m21:14:00.721685 [debug] [Thread-1  ]: On model.tipico.participant: COMMIT
[0m21:14:01.136831 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:14:01.140197 [debug] [Thread-1  ]: Using redshift connection "model.tipico.participant"
[0m21:14:01.142226 [debug] [Thread-1  ]: On model.tipico.participant: BEGIN
[0m21:14:01.166569 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:14:01.170820 [debug] [Thread-1  ]: Timing info for model.tipico.participant (execute): 21:13:59.412023 => 21:14:01.169896
[0m21:14:01.172378 [debug] [Thread-1  ]: On model.tipico.participant: ROLLBACK
[0m21:14:01.212355 [debug] [Thread-1  ]: On model.tipico.participant: Close
[0m21:14:01.217945 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc9a48d3-3365-48ec-883a-1dbbf0ff8a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c8063a30>]}
[0m21:14:01.220149 [info ] [Thread-1  ]: 3 of 4 OK created sql table model timothy_chan.participant ..................... [[32mSUCCESS[0m in 1.83s]
[0m21:14:01.221861 [debug] [Thread-1  ]: Finished running node model.tipico.participant
[0m21:14:01.222963 [debug] [Thread-1  ]: Began running node model.tipico.specifier
[0m21:14:01.224185 [info ] [Thread-1  ]: 4 of 4 START sql table model timothy_chan.specifier ............................ [RUN]
[0m21:14:01.226345 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.tipico.participant, now model.tipico.specifier)
[0m21:14:01.227491 [debug] [Thread-1  ]: Began compiling node model.tipico.specifier
[0m21:14:01.237872 [debug] [Thread-1  ]: Writing injected SQL for node "model.tipico.specifier"
[0m21:14:01.239186 [debug] [Thread-1  ]: Timing info for model.tipico.specifier (compile): 21:14:01.228079 => 21:14:01.238848
[0m21:14:01.239697 [debug] [Thread-1  ]: Began executing node model.tipico.specifier
[0m21:14:01.252693 [debug] [Thread-1  ]: Writing runtime sql for node "model.tipico.specifier"
[0m21:14:01.255903 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m21:14:01.256634 [debug] [Thread-1  ]: On model.tipico.specifier: BEGIN
[0m21:14:01.257243 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:14:01.258078 [debug] [Thread-1  ]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:14:01.258724 [debug] [Thread-1  ]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:14:01.568299 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:14:01.571390 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m21:14:01.573626 [debug] [Thread-1  ]: On model.tipico.specifier: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.specifier"} */

  
    

  create  table
    "dev"."timothy_chan"."specifier__dbt_tmp"
    
    
    
  as (
    

with specifier as (
    select 
    'OVER_UNDER' as key
    ,'5.5' as value
    ,'DOUBLE' as type
)
select *
from specifier
  );
[0m21:14:01.660399 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:14:01.683921 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m21:14:01.685224 [debug] [Thread-1  ]: On model.tipico.specifier: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.specifier"} */
alter table "dev"."timothy_chan"."specifier" rename to "specifier__dbt_backup"
[0m21:14:01.823542 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:14:01.846396 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m21:14:01.847762 [debug] [Thread-1  ]: On model.tipico.specifier: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.specifier"} */
alter table "dev"."timothy_chan"."specifier__dbt_tmp" rename to "specifier"
[0m21:14:01.915514 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:14:01.929955 [debug] [Thread-1  ]: On model.tipico.specifier: COMMIT
[0m21:14:01.931921 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m21:14:01.933342 [debug] [Thread-1  ]: On model.tipico.specifier: COMMIT
[0m21:14:02.431478 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:14:02.435308 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m21:14:02.437330 [debug] [Thread-1  ]: On model.tipico.specifier: BEGIN
[0m21:14:02.479107 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:14:02.497247 [debug] [Thread-1  ]: Applying DROP to: "dev"."timothy_chan"."specifier__dbt_backup"
[0m21:14:02.501910 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m21:14:02.502893 [debug] [Thread-1  ]: On model.tipico.specifier: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "tipico", "target_name": "dev", "node_id": "model.tipico.specifier"} */
drop table if exists "dev"."timothy_chan"."specifier__dbt_backup" cascade
[0m21:14:02.549766 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:14:02.555126 [debug] [Thread-1  ]: On model.tipico.specifier: COMMIT
[0m21:14:02.557223 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m21:14:02.558673 [debug] [Thread-1  ]: On model.tipico.specifier: COMMIT
[0m21:14:03.044814 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:14:03.046606 [debug] [Thread-1  ]: Using redshift connection "model.tipico.specifier"
[0m21:14:03.047860 [debug] [Thread-1  ]: On model.tipico.specifier: BEGIN
[0m21:14:03.070088 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.0 seconds
[0m21:14:03.073114 [debug] [Thread-1  ]: Timing info for model.tipico.specifier (execute): 21:14:01.239998 => 21:14:03.072509
[0m21:14:03.074209 [debug] [Thread-1  ]: On model.tipico.specifier: ROLLBACK
[0m21:14:03.116983 [debug] [Thread-1  ]: On model.tipico.specifier: Close
[0m21:14:03.119778 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc9a48d3-3365-48ec-883a-1dbbf0ff8a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b8083fd0>]}
[0m21:14:03.122515 [info ] [Thread-1  ]: 4 of 4 OK created sql table model timothy_chan.specifier ....................... [[32mSUCCESS[0m in 1.89s]
[0m21:14:03.124086 [debug] [Thread-1  ]: Finished running node model.tipico.specifier
[0m21:14:03.127838 [debug] [MainThread]: Using redshift connection "master"
[0m21:14:03.129173 [debug] [MainThread]: On master: BEGIN
[0m21:14:03.129967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:14:03.131127 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:14:03.132113 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:14:03.431117 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:14:03.432594 [debug] [MainThread]: On master: COMMIT
[0m21:14:03.434871 [debug] [MainThread]: Using redshift connection "master"
[0m21:14:03.435979 [debug] [MainThread]: On master: COMMIT
[0m21:14:03.483992 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:14:03.485311 [debug] [MainThread]: On master: Close
[0m21:14:03.487399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:03.488168 [debug] [MainThread]: Connection 'model.tipico.specifier' was properly closed.
[0m21:14:03.489395 [info ] [MainThread]: 
[0m21:14:03.490268 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.53 seconds (9.53s).
[0m21:14:03.493546 [debug] [MainThread]: Command end result
[0m21:14:03.517303 [info ] [MainThread]: 
[0m21:14:03.517979 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:14:03.518435 [info ] [MainThread]: 
[0m21:14:03.518976 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:14:03.522899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.492482, "process_user_time": 4.830111, "process_kernel_time": 0.867818, "process_mem_max_rss": "125976576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:14:03.524018 [debug] [MainThread]: Command `dbt run` succeeded at 21:14:03.523785 after 10.49 seconds
[0m21:14:03.524631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e87c0b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d8179dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e9eccf40>]}
[0m21:14:03.525177 [debug] [MainThread]: Flushing usage events
